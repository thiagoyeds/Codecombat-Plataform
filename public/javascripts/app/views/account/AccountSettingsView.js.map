{"version":3,"sources":["app/templates/account/account-settings-view.jade","app/views/account/AccountSettingsView.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArDA;AAAA;;ACAA;EAAA;;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,yCAAR;;AACX,QAAQ,QAAQ,YAAR;;AACR,OAAO,QAAQ,aAAR;;AACP,eAAe,QAAQ,yBAAR;;AACf,MAAmB,QAAQ,WAAR,CAAnB,EAAC,2BAAD,EAAa;;AAEb,MAAM,CAAC,OAAP,GAAuB;;;;;;;;gCACrB,KAAI;;gCACJ,WAAU;;gCACV,YAAW;;gCAEX,SACE;IAAA,uBAAuB,oBAAvB;IACA,sBAAsB,mBADtB;IAEA,yBAAyB,wBAFzB;IAGA,mCAAmC,8BAHnC;IAIA,6BAA6B,4BAJ7B;IAKA,6BAA6B,4BAL7B;IAMA,oCAAoC,gCANpC;;;gCAQF,aAAY;IACV,KAA6C,MAAM,CAAC,WAAW,CAAC,SAAhE;MAAA,QAAQ,0BAAR;;IACA,IAAC,eAAD,GAAkB,aAAW,EAAE,CAAC;IAChC,IAAC,KAAD,GAAY,SAAK;MAAC,KAAK,EAAE,CAAC,EAAT;KAAL;WACZ,IAAC,WAAU,CAAC,YAAZ,CAAyB,IAAC,KAAI,CAAC,KAAN,EAAzB;EAJU;;gCAMZ,mBAAkB;AAChB;IAAA,OAAO;AACP;AAAA;;MAAA,IAAK,KAAL,GAAY;AAAZ;AACA,WAAO;EAHS;;gCAMlB,qBAAoB,SAAC,CAAD;AAClB;IAAA,YAAU,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,OAAZ,CAAoB,OAApB,CAA4B,CAAC,IAA7B,CAAkC,IAAlC,OAA4C,qBAA5C,aAAmE,qBAA7E;AAAA;;IACA,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,QAAZ,CAAqB,SAArB;WACA,IAAC,QAAD,CAAS,eAAT;EAHkB;;gCAKpB,yBAAwB;AACtB;IAAA,OAAO,IAAC,iBAAD;IACP,EAAE,qCAAF,EAAyC,IAAC,IAA1C,CAA8C,CAAC,IAA/C,CAAoD,SAApD,EAA+D,CAAI,CAAC,CAAC,GAAF,CAAM,CAAC,CAAC,MAAF,CAAS,IAAT,CAAN,CAAnE,CAAyF,CAAC,QAA1F,CAAmG,SAAnG;WACA,IAAC,QAAD,CAAS,eAAT;EAHsB;;gCAKxB,oBAAmB;AACjB;IAAA,OAAO,EAAE,aAAF,EAAiB,IAAC,IAAlB,CAAsB,CAAC,GAAvB;IACP,IAAU,SAAQ,IAAC,KAAI,CAAC,GAAN,CAAU,MAAV,CAAlB;AAAA;;WACA,IAAI,CAAC,mBAAL,CAAyB,IAAzB,EAA+B;aAAA,SAAC,OAAD;QAC7B,KAAK,CAAC,eAAN,CAAsB,KAAC,IAAvB;QACA,IAAG,SAAQ,OAAX;iBACE,KAAC,cAAD,GAAiB,OADnB;SAAA;UAGE,KAAC,cAAD,GAAiB;iBACjB,KAAK,CAAC,kBAAN,CAAyB,KAAC,IAA1B,EAA+B,MAA/B,EAAuC,mCAAiC,OAAjC,GAAyC,GAAhF,EAAoF,IAApF,EAJF;;MAF6B;IAAA,QAA/B;EAHiB;;gCAWnB,mBAAkB,SAAC,CAAD;IAChB,IAAC,QAAD,CAAS,cAAT,EAAyB,CAAzB;WACA,IAAC,IAAG,CAAC,IAAL,CAAU,oBAAV,CAA+B,CAAC,MAAhC,CAAuC,CAAI,IAAC,KAAI,CAAC,GAAN,CAAU,UAAV,CAA3C;EAFgB;;gCAIlB,6BAA4B,SAAC,CAAD;WAC1B,IAAC,kCAAD,CAAmC,IAAC,IAAG,CAAC,IAAL,CAAU,sBAAV,CAAnC,EAAsE;aAAA;AACpE;QAAA,aACE;UAAA,OAAO,sBAAP;UACA,MAAM,gGADN;UAEA,SAAS,QAFT;UAGA,SAAS,qBAHT;;QAIF,eAAmB,iBAAa,UAAb;QACnB,YAAY,CAAC,EAAb,CAAgB,SAAhB,EAA2B,KAAC,cAA5B,EAA2C,KAA3C;eACA,KAAC,cAAD,CAAe,YAAf;MARoE;IAAA,QAAtE;EAD0B;;gCAW5B,6BAA4B;WAC1B,IAAC,kCAAD,CAAmC,IAAC,IAAG,CAAC,IAAL,CAAU,sBAAV,CAAnC,EAAsE;aAAA;AACpE;QAAA,aACE;UAAA,OAAO,sBAAP;UACA,MAAM,0JADN;UAEA,SAAS,QAFT;UAGA,SAAS,oBAHT;;QAIF,eAAmB,iBAAa,UAAb;QACnB,YAAY,CAAC,EAAb,CAAgB,SAAhB,EAA2B,KAAC,cAA5B,EAA2C,KAA3C;eACA,KAAC,cAAD,CAAe,YAAf;MARoE;IAAA,QAAtE;EAD0B;;gCAW5B,iCAAgC,SAAC,CAAD;WAC9B,CAAC,CAAC,IAAF,CAAO,IAAC,KAAI,CAAC,8BAAN,EAAP,EAA+C;AAC7C;MAAA,OAAO,EAAE,CAAC,CAAC,aAAJ;MACP,IAAI,CAAC,IAAL,CAAU,cAAV,CAAyB,CAAC,QAA1B,CAAmC,MAAnC;aACA,IAAI,CAAC,IAAL,CAAU,YAAV,CAAuB,CAAC,WAAxB,CAAoC,MAApC;IAH6C,CAA/C;EAD8B;;gCAMhC,oCAAmC,SAAC,KAAD,EAAQ,SAAR;AACjC;IAAA,KAAK,CAAC,eAAN,CAAsB,KAAtB;IACA,yBAAyB,KAAK,CAAC,IAAN,CAAW,+BAAX,CAA2C,CAAC,GAA5C;IACzB,kBAAkB,KAAK,CAAC,IAAN,CAAW,wBAAX,CAAoC,CAAC,GAArC;IAClB,IAAG,0BAA2B,4BAA2B,IAAC,KAAI,CAAC,GAAN,CAAU,OAAV,CAA3B,+BAA+C,IAAC,KAAI,CAAC,GAAN,CAAU,MAAV,CAA/C,CAA9B;MACE,oBAAoB;MACpB,cAAc;MACd,CAAC,CAAC,IAAF,CACE;QAAA,KAAK,aAAL;QACA,MAAM,MADN;QAEA,MACE;UAAA,UAAU,sBAAV;UACA,UAAU,eADV;SAHF;QAKA,OAAO,IALP;QAMA,OAAO,SAAC,KAAD;UACL,cAAc;iBACd,uDAAuD;QAFlD,CANP;QASA,SAAS,SAAC,QAAD,EAAW,UAAX,EAAuB,KAAvB;UACP,cAAc;UACd,IAAc,KAAK,CAAC,MAAN,KAAgB,GAA9B;AAAA;;iBACA,oBAAoB;QAHb,CATT;OADF;MAcA,WAAW;eAAA;AACT;UAAA,IAAG,WAAH;mBACE,WAAW,QAAX,EAAqB,GAArB,EADF;WAAA;YAGE,IAAG,iBAAH;qBACE,YADF;aAAA;cAGE,UAAU,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,iCAAT,EAA4C;gBAAA,cAAc,iBAAd;eAA5C;cACV,MAAM;gBAAC;kBAAA,SAAS,OAAT;kBAAkB,UAAU,UAA5B;kBAAwC,WAAW,IAAnD;iBAAD;;cACN,KAAK,CAAC,iBAAN,CAAwB,KAAxB,EAA+B,GAA/B;qBACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;gBAAC,UAAU,KAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;eAAxB,EANF;aAHF;;QADS;MAAA;aAWX,WAAW,QAAX,EAAqB,GAArB,EA5BF;KAAA;MA8BE,UAAU,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,8BAAT,EAAyC;QAAA,cAAc,cAAd;OAAzC;MACV,MAAM;QAAC;UAAA,SAAS,OAAT;UAAkB,UAAU,OAA5B;UAAqC,WAAW,IAAhD;SAAD;;MACN,KAAK,CAAC,iBAAN,CAAwB,KAAxB,EAA+B,GAA/B;aACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;QAAC,UAAU,IAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;OAAxB,EAjCF;;EAJiC;;gCAuCnC,gBAAe;WACb,CAAC,CAAC,IAAF,CACE;MAAA,MAAM,QAAN;MACA,SAAS;QACP,KACE;UAAA,SAAS,IAAT;UACA,MAAM,uBADN;UAEA,MAAM,SAFN;UAGA,QAAQ,WAHR;SADF;eAKA,CAAC,CAAC,KAAF,CAAQ;AACN;UAAA,IAA+E,MAAM,CAAC,WAAW,CAAC,SAAlG;;;;;wBAA6C,CAAE,WAA/C,CAA2D;sBAAA,MAAM,SAAN;qBAA3D;;;;aAAA;;UACA,QAAQ,CAAC,QAAQ,CAAC,OAAlB,CAA0B,kBAA1B,EAA8C,EAA9C;UACA,IAA6D,IAAC,GAAD,KAAO,WAApE;;kBAAc,CAAE,UAAhB,CAA2B,SAA3B,EAAsC;gBAAA,UAAS,UAAT;eAAtC;aAAA;;iBACA,WAAW,EAAE,cAAF,CAAiB,CAAC,GAAlB,EAAX;QAJM,CAAR,EAKE,GALF;MANO,CADT;MAaA,OAAO,SAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB;QACL,OAAO,CAAC,KAAR,CAAc,KAAd;eACA,KACE;UAAA,SAAS,IAAT;UACA,MAAM,6CAA2C,KAAK,CAAC,MADvD;UAEA,MAAM,OAFN;UAGA,QAAQ,WAHR;SADF;MAFK,CAbP;MAoBA,KAAK,cAAY,IAAC,KAAI,CAAC,EApBvB;KADF;EADa;;gCAwBf,gBAAe;WACb,CAAC,CAAC,IAAF,CACE;MAAA,MAAM,MAAN;MACA,SAAS;eAAA;UACP,KACE;YAAA,SAAS,IAAT;YACA,MAAM,wBADN;YAEA,MAAM,SAFN;YAGA,QAAQ,WAHR;WADF;UAKA,YAAY,CAAC,KAAb;UACA,KAAC,KAAI,CAAC,KAAN,CAAY;YAAA,OAAO,KAAP;WAAZ;iBACA,CAAC,CAAC,KAAF,CAAQ,CAAC;mBAAG,MAAM,CAAC,QAAQ,CAAC,MAAhB;UAAH,CAAD,CAAR,EAAuC,IAAvC;QARO;MAAA,QADT;MAUA,OAAO,SAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB;QACL,OAAO,CAAC,KAAR,CAAc,KAAd;eACA,KACE;UAAA,SAAS,IAAT;UACA,MAAM,+CAA6C,KAAK,CAAC,MADzD;UAEA,MAAM,OAFN;UAGA,QAAQ,WAHR;SADF;MAFK,CAVP;MAiBA,KAAK,cAAY,IAAC,KAAI,CAAC,EAAlB,GAAqB,iBAjB1B;KADF;EADa;;gCAqBf,+BAA8B,SAAC,CAAD;AAC5B;IAAA,IAAU,MAAM,CAAC,WAAW,CAAC,SAA7B;AAAA;;IACA,iBAAiB,IAAC,IAAG,CAAC,IAAL,CAAU,gBAAV;IACjB,WAAW;aAAA;eACT,cAAc,CAAC,QAAf,CAAwB,QAAxB;MADS;IAAA;IAEX,UAAU;aAAA,SAAC,aAAD;QACR,KAAC,IAAG,CAAC,IAAL,CAAU,WAAV,CAAsB,CAAC,GAAvB,CAA2B,aAA3B;QACA,KAAC,IAAG,CAAC,IAAL,CAAU,WAAV,CAAsB,CAAC,OAAvB,CAA+B,QAA/B;QACA,KAAC,KAAI,CAAC,GAAN,CAAU,UAAV,EAAsB,aAAtB;eACA,cAAc,CAAC,WAAf,CAA2B,QAA3B,CAAoC,CAAC,IAArC,CAA0C,KAA1C,EAAiD,KAAC,KAAI,CAAC,WAAN,CAAkB,cAAc,CAAC,KAAf,EAAlB,CAAjD;MAJQ;IAAA;WAKV,UAAU,CAAC,IAAX,CAAgB;MAAC,WAAW,SAAZ;KAAhB,EAAwC,IAAC,cAAD,CAAe,QAAf,EAAyB,OAAzB,CAAxC;EAV4B;;gCAY9B,sBAAqB,SAAC,OAAD;WACnB;MAAA,KAAK,OAAO,CAAC,GAAb;MAAkB,UAAU,OAAO,CAAC,QAApC;MAA8C,UAAU,OAAO,CAAC,QAAhE;MAA0E,MAAM,IAAC,eAAjF;MAAiG,OAAO,IAAxG;;EADmB;;gCAGrB,gBAAe,SAAC,QAAD,EAAW,OAAX;WACb;aAAA,SAAC,OAAD;AACE;QAAA;QACA,gBAAgB,CAAC,KAAC,eAAF,EAAkB,OAAO,CAAC,QAA1B,CAAmC,CAAC,IAApC,CAAyC,GAAzC;QAChB,OAAO,KAAC,oBAAD,CAAqB,OAArB;QACP,UAAU,KAAC,gBAAD,CAAiB,OAAjB,EAA0B,aAA1B;eACV,CAAC,CAAC,IAAF,CAAO,OAAP,EAAgB;UAAA,MAAM,MAAN;UAAc,MAAM,IAApB;UAA0B,SAAS,OAAnC;SAAhB;MALF;IAAA;EADa;;gCAQf,kBAAiB,SAAC,OAAD,EAAU,aAAV;WACf;aAAA,SAAC,CAAD;eACE,QAAQ,aAAR;MADF;IAAA;EADe;;gCAOjB,mBAAkB;AAChB;IAAA;;AAAU;AAAA;WAAA;;qBAAA,EAAE,CAAF;AAAA;;;IACV;;AAAc;WAAA;;qBAAA,CAAC,CAAC,IAAF,CAAO,MAAP,CAAc,CAAC,OAAf,CAAuB,QAAvB,EAAiC,EAAjC;AAAA;;;IACd;;AAAY;WAAA;;qBAAA,CAAC,CAAC,IAAF,CAAO,SAAP;AAAA;;;WACZ,CAAC,CAAC,SAAF,CAAY,UAAZ,EAAwB,QAAxB;EAJgB;;gCASlB,OAAM;AACJ;IAAA,EAAE,sBAAF,CAAyB,CAAC,WAA1B,CAAsC,SAAtC;IACA,KAAK,CAAC,eAAN,CAAsB,IAAC,IAAvB;IACA,IAAC,SAAD;IACA,MAAM,IAAC,KAAI,CAAC,QAAN;IACN,IAAG,WAAH;MACE,OAAO,CAAC,KAAR,CAAc,8CAAd,EAA8D,GAA9D;MACA,KAAK,CAAC,iBAAN,CAAwB,IAAC,IAAzB,EAA8B,GAA9B;MACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;QAAC,UAAU,IAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;OAAxB;AACA,aAJF;;IAMA,KAAc,IAAC,KAAI,CAAC,eAAN,EAAd;AAAA;;IAEA,MAAM,IAAC,KAAI,CAAC,KAAN;IACN,KAAc,GAAd;AAAA;;IAEA,GAAG,CAAC,KAAJ,CAAU;aAAA;AACR;QAAA,4CAAmB,CAAE,iBAArB;UACE,SAAS,GAAG,CAAC;UACb,KAAK,CAAC,iBAAN,CAAwB,KAAC,IAAzB,EAA8B,MAA9B;UACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;YAAC,UAAU,KAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;WAAxB,EAHF;SAAA;UAKE,KACE;YAAA,+CAAsB,CAAE,iBAAlB,IAA6B,GAAG,CAAC,YAAvC;YACA,MAAM,OADN;YAEA,QAAQ,WAFR;YAGA,SAAS,IAHT;WADF,EALF;;eAUA,KAAC,QAAD,CAAS,iBAAT;MAXQ;IAAA,QAAV;IAYA,GAAG,CAAC,OAAJ,CAAY;aAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;QACV,EAAE,CAAC,GAAH,CAAO,KAAP;eACA,KAAC,QAAD,CAAS,mBAAT;MAFU;IAAA,QAAZ;WAIA,IAAC,QAAD,CAAS,iBAAT;EAhCI;;gCAkCN,WAAU;IACR,IAAC,iBAAD;WACA,IAAC,cAAD;EAFQ;;gCAIV,mBAAkB;AAChB;IAAA,YAAY,EAAE,WAAF,EAAe,IAAC,IAAhB,CAAoB,CAAC,GAArB;IACZ,YAAY,EAAE,YAAF,EAAgB,IAAC,IAAjB,CAAqB,CAAC,GAAtB;IACZ,YAAY,QAAQ,SAAR,KAAuB,QAAQ,SAAR;IACnC,IAAG,aAAc,cAAe,SAAhC;MACE,UAAU,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,oCAAT,EAA+C;QAAA,cAAc,0BAAd;OAA/C;MACV,MAAM;QAAC;UAAA,SAAS,OAAT;UAAkB,UAAU,WAA5B;UAAyC,WAAW,IAApD;SAAD;;MACN,KAAK,CAAC,iBAAN,CAAwB,IAAC,IAAzB,EAA8B,GAA9B;MACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;QAAC,UAAU,IAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;OAAxB;AACA,aALF;;IAMA,IAAG,SAAH;aACE,IAAC,KAAI,CAAC,GAAN,CAAU,UAAV,EAAsB,SAAtB,EADF;KAAA,MAEK,IAAG,SAAH;MACH,UAAU,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,kCAAT,EAA6C;QAAA,cAAc,8BAAd;OAA7C;MACV,MAAM;QAAC;UAAA,SAAS,OAAT;UAAkB,UAAU,WAA5B;UAAyC,WAAW,IAApD;SAAD;;MACN,KAAK,CAAC,iBAAN,CAAwB,IAAC,IAAzB,EAA8B,GAA9B;aACA,EAAE,OAAF,CAAU,CAAC,YAAX,CAAwB;QAAC,UAAU,IAAC,IAAG,CAAC,IAAL,CAAU,YAAV,CAAX;OAAxB,EAJG;;EAZW;;gCAkBlB,gBAAe;AACb;IAAA,IAA+C,IAAC,cAAhD;MAAA,IAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,GAAzB,CAA6B,IAAC,cAA9B;;IACA,IAAC,KAAI,CAAC,GAAN,CAAU,MAAV,EAAkB,IAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,GAAzB,EAAlB;IACA,IAAC,KAAI,CAAC,GAAN,CAAU,WAAV,EAAuB,IAAC,IAAG,CAAC,IAAL,CAAU,mBAAV,CAA8B,CAAC,GAA/B,EAAvB;IACA,IAAC,KAAI,CAAC,GAAN,CAAU,UAAV,EAAsB,IAAC,IAAG,CAAC,IAAL,CAAU,kBAAV,CAA6B,CAAC,GAA9B,EAAtB;IACA,IAAC,KAAI,CAAC,GAAN,CAAU,OAAV,EAAmB,IAAC,IAAG,CAAC,IAAL,CAAU,QAAV,CAAmB,CAAC,GAApB,EAAnB;AACA;AAAA;;MACE,IAAC,KAAI,CAAC,oBAAN,CAA2B,SAA3B,EAAsC,OAAtC;AADF;IAGA,IAAC,KAAI,CAAC,GAAN,CAAU,UAAV,EAAsB,IAAC,IAAG,CAAC,IAAL,CAAU,WAAV,CAAsB,CAAC,GAAvB,EAAtB;IAEA,cAAc;IAEd,KAAO,WAAW,CAAC,YAAZ,EAAP;MACE,gBAAgB,IAAC,IAAG,CAAC,IAAL,CAAU,QAAV;MAChB,IAAG,aAAa,CAAC,MAAjB;QACE,IAA4B,aAAa,CAAC,IAAd,CAAmB,SAAnB,CAA5B;UAAA,WAAW,CAAC,IAAZ,CAAiB,OAAjB;SADF;;MAEA,kBAAkB,IAAC,IAAG,CAAC,IAAL,CAAU,UAAV;MAClB,IAAG,eAAe,CAAC,MAAnB;QACE,IAA8B,eAAe,CAAC,IAAhB,CAAqB,SAArB,CAA9B;UAAA,WAAW,CAAC,IAAZ,CAAiB,SAAjB;SADF;;aAEA,IAAC,KAAI,CAAC,GAAN,CAAU,aAAV,EAAyB,WAAzB,EAPF;;EAba;;;;GAlQkC","file":"public/javascripts/app/views/account/AccountSettingsView.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me,isProduction = locals_.isProduction,view = locals_.view;if ( me.get('anonymous'))\n{\nbuf.push(\"<div data-i18n=\\\"account_settings.not_logged_in\\\" class=\\\"alert alert-danger\\\">Log in or create an account to change your settings.</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"row\\\"><div class=\\\"col-md-6\\\"><div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div data-i18n=\\\"account_settings.me_tab\\\" class=\\\"panel-title\\\"></div></div><div class=\\\"panel-body\\\"><div class=\\\"form\\\">\");\nvar name = me.get('name') || '';\nvar firstName = me.get('firstName') || '';\nvar lastName = me.get('lastName') || '';\nvar email = me.get('email') || '';\nvar admin = me.get('permissions', true).indexOf('admin') != -1;\nvar godmode = me.get('permissions', true).indexOf('godmode') != -1;\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"name\\\" data-i18n=\\\"general.username\\\" class=\\\"control-label\\\"></label><input\" + (jade.attrs({ 'id':('name-input'), 'name':(\"name\"), 'type':(\"text\"), 'value':(\"\" + (name) + \"\"), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true})) + \"/></div><div class=\\\"form-group\\\"><label for=\\\"email\\\" class=\\\"control-label\\\"><span data-i18n=\\\"general.email\\\"></span></label>\");\nif (!( me.get('emailVerified')))\n{\nbuf.push(\"<span class=\\\"spl\\\">(</span><span data-i18n=\\\"account.not_yet_verified\\\" class=\\\"spr\\\"></span><a class=\\\"resend-verification-email\\\"><span data-i18n=\\\"account.resend_email\\\" class=\\\"resend-text\\\"></span><span data-i18n=\\\"account.email_sent\\\" class=\\\"sent-text hide\\\"></span></a><span>)</span>\");\n}\nbuf.push(\"<input\" + (jade.attrs({ 'id':('email'), 'name':(\"email\"), 'type':(\"text\"), 'value':(\"\" + (email) + \"\"), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true})) + \"/></div><div class=\\\"row\\\"><div class=\\\"form-group col-sm-6\\\"><label for=\\\"firstName\\\" data-i18n=\\\"general.first_name\\\" class=\\\"control-label\\\"></label><input\" + (jade.attrs({ 'id':('first-name-input'), 'name':(\"firstName\"), 'type':(\"text\"), 'value':(\"\" + (firstName) + \"\"), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true})) + \"/></div><div class=\\\"form-group col-sm-6\\\">\");\nif ( me.isStudent())\n{\nbuf.push(\"<label for=\\\"lastName\\\" data-i18n=\\\"general.last_initial\\\" class=\\\"control-label\\\"></label><input\" + (jade.attrs({ 'id':('last-name-input'), 'name':(\"lastName\"), 'type':(\"text\"), 'value':(\"\" + (lastName) + \"\"), 'maxlength':(\"1\"), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true,\"maxlength\":true})) + \"/>\");\n}\nelse\n{\nbuf.push(\"<label for=\\\"lastName\\\" data-i18n=\\\"general.last_name\\\" class=\\\"control-label\\\"></label><input\" + (jade.attrs({ 'id':('last-name-input'), 'name':(\"lastName\"), 'type':(\"text\"), 'value':(\"\" + (lastName) + \"\"), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true})) + \"/>\");\n}\nbuf.push(\"</div></div>\");\nif ( !isProduction)\n{\nbuf.push(\"<div class=\\\"form-group checkbox\\\"><label for=\\\"admin\\\" data-i18n=\\\"account_settings.admin\\\"></label><input\" + (jade.attrs({ 'id':('admin'), 'name':(\"admin\"), 'type':(\"checkbox\"), 'checked':(admin) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/></div><div class=\\\"form-group checkbox\\\"><label for=\\\"godmode\\\" data-i18n=\\\"account_settings.god_mode\\\"></label><input\" + (jade.attrs({ 'id':('godmode'), 'name':(\"godmode\"), 'type':(\"checkbox\"), 'checked':(godmode) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/></div>\");\n}\nif ( me.hasSubscription())\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label data-i18n=\\\"account.subscription\\\"></label><br/><span class=\\\"spr\\\">âœ“</span><span data-i18n=\\\"account.active\\\"></span><span class=\\\"spr\\\">\" + (jade.escape(null == (jade.interp = '.') ? \"\" : jade.interp)) + \"</span><!-- TODO: show better summary states, like active, subscribed, free, and active until.--><a href=\\\"/account/subscription\\\" data-i18n=\\\"account_settings.manage_subscription\\\"></a></div>\");\n}\nbuf.push(\"</div></div></div><div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div data-i18n=\\\"account_settings.picture_tab\\\" class=\\\"panel-title\\\"></div></div><div id=\\\"profile-photo-panel-body\\\" class=\\\"panel-body\\\"><img\" + (jade.attrs({ 'src':(me.getPhotoURL(230)), 'draggable':(\"false\"), \"class\": [('profile-photo')] }, {\"src\":true,\"draggable\":true})) + \"/><input\" + (jade.attrs({ 'id':('photoURL'), 'type':(\"hidden\"), 'value':(me.get('photoURL')||'') }, {\"type\":true,\"value\":true})) + \"/><button id=\\\"upload-photo-button\\\" data-i18n=\\\"account_settings.upload_picture\\\" class=\\\"btn form-control btn-primary\\\"></button></div></div><div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div data-i18n=\\\"general.password\\\" class=\\\"panel-title\\\"></div></div><div class=\\\"panel-body\\\"><div class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"password\\\" data-i18n=\\\"account_settings.new_password\\\" class=\\\"control-label\\\">New Password</label><input id=\\\"password\\\" name=\\\"password\\\" type=\\\"password\\\" class=\\\"form-control\\\"/></div><div class=\\\"form-group\\\"><label for=\\\"password2\\\" data-i18n=\\\"account_settings.new_password_verify\\\" class=\\\"control-label\\\">Verify</label><input id=\\\"password2\\\" name=\\\"password2\\\" type=\\\"password\\\" class=\\\"form-control\\\"/></div></div></div></div><div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div id=\\\"delete-account-panel-title\\\" data-i18n=\\\"account_settings.delete_account_tab\\\" class=\\\"panel-title\\\"></div></div><div class=\\\"panel-body\\\"><div id=\\\"delete-account-form\\\" class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"delete-account-email-or-username\\\" data-i18n=\\\"account_settings.type_in_email\\\" class=\\\"control-label\\\"></label><input id=\\\"delete-account-email-or-username\\\" name=\\\"emailOrUsername\\\" class=\\\"form-control\\\"/></div><div class=\\\"form-group\\\"><label for=\\\"delete-account-password\\\" data-i18n=\\\"account_settings.type_in_password\\\" class=\\\"control-label\\\"></label><input id=\\\"delete-account-password\\\" name=\\\"password\\\" type=\\\"password\\\" class=\\\"form-control\\\"/></div></div><button id=\\\"delete-account-btn\\\" data-i18n=\\\"account_settings.delete_this_account\\\" class=\\\"btn form-control btn-primary\\\"></button></div></div></div><div class=\\\"col-md-6\\\">\");\nvar subs = view.getEmailSubsDict();\nbuf.push(\"<div id=\\\"email-panel\\\" class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div data-i18n=\\\"account_settings.emails_tab\\\" class=\\\"panel-title\\\"></div></div><div class=\\\"panel-body\\\"><div class=\\\"form\\\"><div class=\\\"form-group checkbox\\\"><label for=\\\"email_generalNews\\\" data-i18n=\\\"account_settings.email_announcements\\\" class=\\\"control-label\\\">Announcements</label><input\" + (jade.attrs({ 'id':('email_generalNews'), 'name':(\"email_generalNews\"), 'type':(\"checkbox\"), 'checked':(subs.generalNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"account_settings.email_announcements_description\\\" class=\\\"help-block\\\">Get emails on the latest news and developments at CodeCombat.</span></div></div><hr/><h4 data-i18n=\\\"account_settings.email_notifications\\\">Notifications</h4><span data-i18n=\\\"account_settings.email_notifications_summary\\\">Controls for personalized, automatic email notifications related to your CodeCombat activity.</span><div class=\\\"form\\\"><div class=\\\"form-group checkbox\\\"><label for=\\\"email_anyNotes\\\" data-i18n=\\\"account_settings.email_any_notes\\\" class=\\\"control-label\\\">Any Notifications</label><input\" + (jade.attrs({ 'id':('email_anyNotes'), 'name':(\"email_anyNotes\"), 'type':(\"checkbox\"), 'checked':(subs.anyNotes) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"account_settings.email_any_notes_description\\\" class=\\\"help-block\\\">Disable to stop all activity notification emails.</span></div><fieldset id=\\\"specific-notification-settings\\\"><div class=\\\"form-group checkbox\\\"><label for=\\\"email_recruitNotes\\\" data-i18n=\\\"account_settings.email_recruit_notes\\\" class=\\\"control-label\\\">Job Opportunities</label><input\" + (jade.attrs({ 'id':('email_recruitNotes'), 'name':(\"email_recruitNotes\"), 'type':(\"checkbox\"), 'checked':(subs.recruitNotes) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"account_settings.email_recruit_notes_description\\\" class=\\\"help-block\\\">If you play really well, we may contact you about getting you a (better) job.</span></div></fieldset></div><hr/><h4 data-i18n=\\\"account_settings.contributor_emails\\\">Contributor Class Emails</h4><span data-i18n=\\\"account_settings.contribute_prefix\\\">We\\\\'re looking for people to join our party! Check out the </span><a href=\\\"/contribute\\\" data-i18n=\\\"account_settings.contribute_page\\\">contribute page</a><span data-i18n=\\\"account_settings.contribute_suffix\\\"> to find out more.</span><div class=\\\"form\\\"><div class=\\\"form-group checkbox\\\"><label for=\\\"email_archmageNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.archmage_title\\\">Archmage</span> <span data-i18n=\\\"classes.archmage_title_description\\\">(Coder)</span></label><input\" + (jade.attrs({ 'id':('email_archmageNews'), 'name':(\"email_archmageNews\"), 'type':(\"checkbox\"), 'checked':(subs.archmageNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.archmage_subscribe_desc\\\" class=\\\"help-block\\\">Get emails about general news and announcements about CodeCombat.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_artisanNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.artisan_title\\\">Artisan</span> <span data-i18n=\\\"classes.artisan_title_description\\\">(Level Builder)</span></label><input\" + (jade.attrs({ 'id':('email_artisanNews'), 'name':(\"email_artisanNews\"), 'type':(\"checkbox\"), 'checked':(subs.artisanNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.artisan_subscribe_desc\\\" class=\\\"help-block\\\">Get emails on level editor updates and announcements.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_adventurerNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.adventurer_title\\\">Adventurer</span> <span data-i18n=\\\"classes.adventurer_title_description\\\"> \\n(Level Playtester)</span></label><input\" + (jade.attrs({ 'id':('email_adventurerNews'), 'name':(\"email_adventurerNews\"), 'type':(\"checkbox\"), 'checked':(subs.adventurerNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.adventurer_subscribe_desc\\\" class=\\\"help-block\\\">Get emails when there are new levels to test.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_scribeNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.scribe_title\\\">Scribe</span> <span data-i18n=\\\"classes.scribe_title_description\\\">(Article Editor)</span></label><input\" + (jade.attrs({ 'id':('email_scribeNews'), 'name':(\"email_scribeNews\"), 'type':(\"checkbox\"), 'checked':(subs.scribeNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.scribe_subscribe_desc\\\" class=\\\"help-block\\\">Get emails about article writing announcements.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_diplomatNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.diplomat_title\\\">Diplomat</span> <span data-i18n=\\\"classes.diplomat_title_description\\\">(Translator)</span></label><input\" + (jade.attrs({ 'id':('email_diplomatNews'), 'name':(\"email_diplomatNews\"), 'type':(\"checkbox\"), 'checked':(subs.diplomatNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.diplomat_subscribe_desc\\\" class=\\\"help-block\\\">Get emails about i18n developments and, eventually, levels to translate.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_ambassadorNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.ambassador_title\\\">Ambassador</span> <span data-i18n=\\\"classes.ambassador_title_description\\\">(Support)</span></label><input\" + (jade.attrs({ 'id':('email_ambassadorNews'), 'name':(\"email_ambassadorNews\"), 'type':(\"checkbox\"), 'checked':(subs.ambassadorNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.ambassador_subscribe_desc\\\" class=\\\"help-block\\\">Get emails on support updates and multiplayer developments.</span></div><div class=\\\"form-group checkbox\\\"><label for=\\\"email_teacherNews\\\" class=\\\"control-label\\\"><span data-i18n=\\\"classes.teacher_title\\\"></span></label><input\" + (jade.attrs({ 'id':('email_teacherNews'), 'name':(\"email_teacherNews\"), 'type':(\"checkbox\"), 'checked':(subs.teacherNews) }, {\"name\":true,\"type\":true,\"checked\":true})) + \"/><span data-i18n=\\\"contribute.teacher_subscribe_desc\\\" class=\\\"help-block\\\"></span></div><button id=\\\"toggle-all-btn\\\" data-i18n=\\\"account_settings.email_toggle\\\" class=\\\"btn btn-primary form-control\\\">Toggle All</button></div></div></div><div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><div id=\\\"reset-progress-panel-title\\\" data-i18n=\\\"account_settings.reset_progress_tab\\\" class=\\\"panel-title\\\"></div></div><div class=\\\"panel-body\\\"><div id=\\\"reset-progress-form\\\" class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"email-reset-progress\\\" data-i18n=\\\"account_settings.type_in_email_progress\\\" class=\\\"control-label\\\"></label><input id=\\\"email-reset-progress\\\" name=\\\"emailOrUsername\\\" class=\\\"form-control\\\"/></div><div class=\\\"form-group\\\"><label for=\\\"password-reset-progress\\\" data-i18n=\\\"account_settings.type_in_password\\\" class=\\\"control-label\\\"></label><input id=\\\"password-reset-progress\\\" name=\\\"password\\\" type=\\\"password\\\" class=\\\"form-control\\\"/></div></div><button id=\\\"reset-progress-btn\\\" data-i18n=\\\"account_settings.reset_your_progress\\\" class=\\\"btn form-control btn-primary\\\"></button></div></div></div></div>\");\n}\nbuf.push(\"<div class=\\\"clearfix\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","CocoView = require 'views/core/CocoView'\ntemplate = require 'templates/account/account-settings-view'\nforms = require 'core/forms'\nUser = require 'models/User'\nConfirmModal = require 'views/core/ConfirmModal'\n{logoutUser, me} = require('core/auth')\n\nmodule.exports = class AccountSettingsView extends CocoView\n  id: 'account-settings-view'\n  template: template\n  className: 'countainer-fluid'\n\n  events:\n    'change .panel input': 'onChangePanelInput'\n    'change #name-input': 'onChangeNameInput'\n    'click #toggle-all-btn': 'onClickToggleAllButton'\n    'click #profile-photo-panel-body': 'onClickProfilePhotoPanelBody'\n    'click #delete-account-btn': 'onClickDeleteAccountButton'\n    'click #reset-progress-btn': 'onClickResetProgressButton'\n    'click .resend-verification-email': 'onClickResendVerificationEmail'\n\n  initialize: ->\n    require('core/services/filepicker')() unless window.application.isIPadApp  # Initialize if needed\n    @uploadFilePath = \"db/user/#{me.id}\"\n    @user = new User({_id: me.id})\n    @supermodel.trackRequest(@user.fetch()) # use separate, fresh User object instead of `me`\n\n  getEmailSubsDict: ->\n    subs = {}\n    subs[sub] = 1 for sub in @user.getEnabledEmails()\n    return subs\n\n  #- Form input callbacks\n  onChangePanelInput: (e) ->\n    return if $(e.target).closest('.form').attr('id') in ['reset-progress-form', 'delete-account-form']\n    $(e.target).addClass 'changed'\n    @trigger 'input-changed'\n\n  onClickToggleAllButton: ->\n    subs = @getSubscriptions()\n    $('#email-panel input[type=\"checkbox\"]', @$el).prop('checked', not _.any(_.values(subs))).addClass('changed')\n    @trigger 'input-changed'\n\n  onChangeNameInput: ->\n    name = $('#name-input', @$el).val()\n    return if name is @user.get 'name'\n    User.getUnconflictedName name, (newName) =>\n      forms.clearFormAlerts(@$el)\n      if name is newName\n        @suggestedName = undefined\n      else\n        @suggestedName = newName\n        forms.setErrorToProperty @$el, 'name', \"That name is taken! How about #{newName}?\", true\n\n  onPictureChanged: (e) =>\n    @trigger 'inputChanged', e\n    @$el.find('.gravatar-fallback').toggle not @user.get 'photoURL'\n\n  onClickDeleteAccountButton: (e) ->\n    @validateCredentialsForDestruction @$el.find('#delete-account-form'), =>\n      renderData =\n        title: 'Are you really sure?'\n        body: 'This will completely delete your account. This action CANNOT be undone. Are you entirely sure?'\n        decline: 'Cancel'\n        confirm: 'DELETE Your Account'\n      confirmModal = new ConfirmModal renderData\n      confirmModal.on 'confirm', @deleteAccount, @\n      @openModalView confirmModal\n\n  onClickResetProgressButton: ->\n    @validateCredentialsForDestruction @$el.find('#reset-progress-form'), =>\n      renderData =\n        title: 'Are you really sure?'\n        body: 'This will completely erase your progress: code, levels, achievements, earned gems, and course work. This action CANNOT be undone. Are you entirely sure?'\n        decline: 'Cancel'\n        confirm: 'Erase ALL Progress'\n      confirmModal = new ConfirmModal renderData\n      confirmModal.on 'confirm', @resetProgress, @\n      @openModalView confirmModal\n\n  onClickResendVerificationEmail: (e) ->\n    $.post @user.getRequestVerificationEmailURL(), ->\n      link = $(e.currentTarget)\n      link.find('.resend-text').addClass('hide')\n      link.find('.sent-text').removeClass('hide')\n\n  validateCredentialsForDestruction: ($form, onSuccess) ->\n    forms.clearFormAlerts($form)\n    enteredEmailOrUsername = $form.find('input[name=\"emailOrUsername\"]').val()\n    enteredPassword = $form.find('input[name=\"password\"]').val()\n    if enteredEmailOrUsername and enteredEmailOrUsername in [@user.get('email'), @user.get('name')]\n      isPasswordCorrect = false\n      toBeDelayed = true\n      $.ajax\n        url: '/auth/login'\n        type: 'POST'\n        data:\n          username: enteredEmailOrUsername\n          password: enteredPassword\n        parse: true\n        error: (error) ->\n          toBeDelayed = false\n          'Bad Error. Can\\'t connect to server or something. ' + error\n        success: (response, textStatus, jqXHR) ->\n          toBeDelayed = false\n          return unless jqXHR.status is 200\n          isPasswordCorrect = true\n      callback = =>\n        if toBeDelayed\n          setTimeout callback, 100\n        else\n          if isPasswordCorrect\n            onSuccess()\n          else\n            message = $.i18n.t('account_settings.wrong_password', defaultValue: 'Wrong Password.')\n            err = [message: message, property: 'password', formatted: true]\n            forms.applyErrorsToForm($form, err)\n            $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n      setTimeout callback, 100\n    else\n      message = $.i18n.t('account_settings.wrong_email', defaultValue: 'Wrong Email.')\n      err = [message: message, property: 'email', formatted: true]\n      forms.applyErrorsToForm($form, err)\n      $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n\n  deleteAccount: ->\n    $.ajax\n      type: 'DELETE'\n      success: ->\n        noty\n          timeout: 5000\n          text: 'Your account is gone.'\n          type: 'success'\n          layout: 'topCenter'\n        _.delay ->\n          window?.webkit?.messageHandlers?.notification?.postMessage(name: \"signOut\") if window.application.isIPadApp\n          Backbone.Mediator.publish(\"auth:logging-out\", {})\n          window.tracker?.trackEvent 'Log Out', category:'Homepage' if @id is 'home-view'\n          logoutUser($('#login-email').val())\n        , 500\n      error: (jqXHR, status, error) ->\n        console.error jqXHR\n        noty\n          timeout: 5000\n          text: \"Deleting account failed with error code #{jqXHR.status}\"\n          type: 'error'\n          layout: 'topCenter'\n      url: \"/db/user/#{@user.id}\"\n\n  resetProgress: ->\n    $.ajax\n      type: 'POST'\n      success: =>\n        noty\n          timeout: 5000\n          text: 'Your progress is gone.'\n          type: 'success'\n          layout: 'topCenter'\n        localStorage.clear()\n        @user.fetch cache: false\n        _.delay (-> window.location.reload()), 1000\n      error: (jqXHR, status, error) ->\n        console.error jqXHR\n        noty\n          timeout: 5000\n          text: \"Resetting progress failed with error code #{jqXHR.status}\"\n          type: 'error'\n          layout: 'topCenter'\n      url: \"/db/user/#{@user.id}/reset_progress\"\n\n  onClickProfilePhotoPanelBody: (e) ->\n    return if window.application.isIPadApp  # TODO: have an iPad-native way of uploading a photo, since we don't want to load FilePicker on iPad (memory)\n    photoContainer = @$el.find('.profile-photo')\n    onSaving = =>\n      photoContainer.addClass('saving')\n    onSaved = (uploadingPath) =>\n      @$el.find('#photoURL').val(uploadingPath)\n      @$el.find('#photoURL').trigger('change') # cause for some reason editing the value doesn't trigger the jquery event\n      @user.set('photoURL', uploadingPath)\n      photoContainer.removeClass('saving').attr('src', @user.getPhotoURL(photoContainer.width()))\n    filepicker.pick {mimetypes: 'image/*'}, @onImageChosen(onSaving, onSaved)\n\n  formatImagePostData: (inkBlob) ->\n    url: inkBlob.url, filename: inkBlob.filename, mimetype: inkBlob.mimetype, path: @uploadFilePath, force: true\n\n  onImageChosen: (onSaving, onSaved) ->\n    (inkBlob) =>\n      onSaving()\n      uploadingPath = [@uploadFilePath, inkBlob.filename].join('/')\n      data = @formatImagePostData(inkBlob)\n      success = @onImageUploaded(onSaved, uploadingPath)\n      $.ajax '/file', type: 'POST', data: data, success: success\n\n  onImageUploaded: (onSaved, uploadingPath) ->\n    (e) =>\n      onSaved uploadingPath\n\n\n  #- Misc\n\n  getSubscriptions: ->\n    inputs = ($(i) for i in $('#email-panel input[type=\"checkbox\"].changed', @$el))\n    emailNames = (i.attr('name').replace('email_', '') for i in inputs)\n    enableds = (i.prop('checked') for i in inputs)\n    _.zipObject emailNames, enableds\n\n\n  #- Saving changes\n\n  save: ->\n    $('#settings-tabs input').removeClass 'changed'\n    forms.clearFormAlerts(@$el)\n    @grabData()\n    res = @user.validate()\n    if res?\n      console.error 'Couldn\\'t save because of validation errors:', res\n      forms.applyErrorsToForm(@$el, res)\n      $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n      return\n\n    return unless @user.hasLocalChanges()\n\n    res = @user.patch()\n    return unless res\n\n    res.error =>\n      if res.responseJSON?.property\n        errors = res.responseJSON\n        forms.applyErrorsToForm(@$el, errors)\n        $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n      else\n        noty\n          text: res.responseJSON?.message or res.responseText\n          type: 'error'\n          layout: 'topCenter'\n          timeout: 5000\n      @trigger 'save-user-error'\n    res.success (model, response, options) =>\n      me.set(model) # save changes to me\n      @trigger 'save-user-success'\n\n    @trigger 'save-user-began'\n\n  grabData: ->\n    @grabPasswordData()\n    @grabOtherData()\n\n  grabPasswordData: ->\n    password1 = $('#password', @$el).val()\n    password2 = $('#password2', @$el).val()\n    bothThere = Boolean(password1) and Boolean(password2)\n    if bothThere and password1 isnt password2\n      message = $.i18n.t('account_settings.password_mismatch', defaultValue: 'Password does not match.')\n      err = [message: message, property: 'password2', formatted: true]\n      forms.applyErrorsToForm(@$el, err)\n      $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n      return\n    if bothThere\n      @user.set('password', password1)\n    else if password1\n      message = $.i18n.t('account_settings.password_repeat', defaultValue: 'Please repeat your password.')\n      err = [message: message, property: 'password2', formatted: true]\n      forms.applyErrorsToForm(@$el, err)\n      $('.nano').nanoScroller({scrollTo: @$el.find('.has-error')})\n\n  grabOtherData: ->\n    @$el.find('#name-input').val @suggestedName if @suggestedName\n    @user.set 'name', @$el.find('#name-input').val()\n    @user.set 'firstName', @$el.find('#first-name-input').val()\n    @user.set 'lastName', @$el.find('#last-name-input').val()\n    @user.set 'email', @$el.find('#email').val()\n    for emailName, enabled of @getSubscriptions()\n      @user.setEmailSubscription emailName, enabled\n\n    @user.set('photoURL', @$el.find('#photoURL').val())\n\n    permissions = []\n\n    unless application.isProduction()\n      adminCheckbox = @$el.find('#admin')\n      if adminCheckbox.length\n        permissions.push 'admin' if adminCheckbox.prop('checked')\n      godmodeCheckbox = @$el.find('#godmode')\n      if godmodeCheckbox.length\n        permissions.push 'godmode' if godmodeCheckbox.prop('checked')\n      @user.set('permissions', permissions)\n"]}