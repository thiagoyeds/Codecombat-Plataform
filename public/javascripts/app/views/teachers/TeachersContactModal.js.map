{"version":3,"sources":["app/templates/teachers/teachers-contact-modal.jade","app/views/teachers/TeachersContactModal.coffee"],"names":[],"mappings":"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","file":"public/javascripts/app/views/teachers/TeachersContactModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),_ = locals_._,view = locals_.view;var formErrors_mixin = function(errors){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nif ( _.isString(errors))\n{\nerrors = [errors]\n}\nif ( _.size(errors))\n{\nbuf.push(\"<div class=\\\"help-block\\\">\");\n// iterate errors\n;(function(){\n  var $$obj = errors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var error = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape(null == (jade.interp = error) ? \"\" : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var error = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape(null == (jade.interp = error) ? \"\" : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n}\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content style-flat\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<div class=\\\"text-center\\\"><h3>Contact Our Classroom Team</h3></div></div><div class=\\\"modal-body\\\"><p>Send us a message and our classroom success team will be in touch to help find the best solution for your students' needs!</p><form>\");\nvar sending = view.state.get('sendingState') === 'sending'\nvar sent = view.state.get('sendingState') === 'sent';\nvar values = view.state.get('formValues');\nvar errors = view.state.get('formErrors');\nbuf.push(\"<div\" + (jade.attrs({ \"class\": [('form-group'),(errors.name ? 'has-error' : '')] }, {\"class\":true})) + \"><label for=\\\"name\\\" data-i18n=\\\"general.name\\\" class=\\\"control-label\\\"></label>\");\nformErrors_mixin(errors.name);\nbuf.push(\"<input\" + (jade.attrs({ 'name':(\"name\"), 'type':(\"text\"), 'value':(values.name || ''), 'tabindex':(1), 'disabled':(sending || sent), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true,\"tabindex\":true,\"disabled\":true})) + \"/></div><div\" + (jade.attrs({ \"class\": [('form-group'),(errors.email ? 'has-error' : '')] }, {\"class\":true})) + \"><label for=\\\"email\\\" data-i18n=\\\"general.email\\\" class=\\\"control-label\\\"></label>\");\nformErrors_mixin(errors.email);\nbuf.push(\"<input\" + (jade.attrs({ 'name':(\"email\"), 'type':(\"email\"), 'value':(values.email || ''), 'tabindex':(1), 'disabled':(sending || sent), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true,\"tabindex\":true,\"disabled\":true})) + \"/></div><div\" + (jade.attrs({ \"class\": [('form-group'),(errors.licensesNeeded ? 'has-error' : '')] }, {\"class\":true})) + \"><label for=\\\"licensesNeeded\\\" data-i18n=\\\"teachers.licenses_needed\\\" class=\\\"control-label\\\"></label>\");\nformErrors_mixin(errors.licensesNeeded);\nbuf.push(\"<input\" + (jade.attrs({ 'name':(\"licensesNeeded\"), 'type':(\"text\"), 'value':(values.licensesNeeded || ''), 'tabindex':(1), 'disabled':(sending || sent), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true,\"tabindex\":true,\"disabled\":true})) + \"/></div><div\" + (jade.attrs({ \"class\": [('form-group'),(errors.message ? 'has-error' : '')] }, {\"class\":true})) + \"><label for=\\\"message\\\" data-i18n=\\\"general.message\\\" class=\\\"control-label\\\"></label>\");\nformErrors_mixin(errors.message);\nbuf.push(\"<textarea\" + (jade.attrs({ 'name':(\"message\"), 'tabindex':(1), 'disabled':(sending || sent), \"class\": [('form-control')] }, {\"name\":true,\"tabindex\":true,\"disabled\":true})) + \">\" + (jade.escape(null == (jade.interp = values.message) ? \"\" : jade.interp)) + \"</textarea></div>\");\nif ( view.state.get('sendingState') === 'error')\n{\nbuf.push(\"<div class=\\\"alert alert-danger\\\">Could not send message.</div>\");\n}\nif ( sent)\n{\nbuf.push(\"<div class=\\\"alert alert-success\\\">Message sent!</div>\");\n}\nbuf.push(\"<div class=\\\"text-right\\\"><button\" + (jade.attrs({ 'id':('submit-btn'), 'type':('submit'), 'disabled':(sending || sent), \"class\": [('btn'),('btn-navy'),('btn-lg')] }, {\"type\":true,\"disabled\":true})) + \">Submit</button></div></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\nState = require 'models/State'\nTrialRequests = require 'collections/TrialRequests'\nforms = require 'core/forms'\ncontact = require 'core/contact'\n\nmodule.exports = class TeachersContactModal extends ModalView\n  id: 'teachers-contact-modal'\n  template: require 'templates/teachers/teachers-contact-modal'\n\n  events:\n    'submit form': 'onSubmitForm'\n\n  initialize: (options={}) ->\n    @state = new State({\n      formValues: {\n        name: ''\n        email: ''\n        licensesNeeded: ''\n        message: ''\n      }\n      formErrors: {}\n      sendingState: 'standby' # 'sending', 'sent', 'error'\n    })\n    @trialRequests = new TrialRequests()\n    @supermodel.trackRequest @trialRequests.fetchOwn()\n    @state.on 'change', @render, @\n\n  onLoaded: ->\n    trialRequest = @trialRequests.first()\n    props = trialRequest?.get('properties') or {}\n    name = if props.firstName and props.lastName then \"#{props.firstName} #{props.lastName}\" else me.get('name') ? ''\n    email = props.email or me.get('email') or ''\n    message = \"\"\"\n        Hi CodeCombat! I want to learn more about the Classroom experience and get licenses so that my students can access Computer Science 2 and on.\n\n        Name of School #{props.nces_name or props.organization or ''}\n        Name of District: #{props.nces_district or props.district or ''}\n        Role: #{props.role or ''}\n        Phone Number: #{props.phoneNumber or ''}\n      \"\"\"\n    @state.set('formValues', { name, email, message })\n    super()\n\n  onSubmitForm: (e) ->\n    e.preventDefault()\n    return if @state.get('sendingState') is 'sending'\n\n    formValues = forms.formToObject @$el\n    @state.set('formValues', formValues)\n\n    formErrors = {}\n    unless formValues.name\n      formErrors.name = 'Name required.'\n    unless forms.validateEmail(formValues.email)\n      formErrors.email = 'Invalid email.'\n    unless parseInt(formValues.licensesNeeded) > 0\n      formErrors.licensesNeeded = 'Licenses needed is required.'\n    unless formValues.message\n      formErrors.message = 'Message required.'\n    @state.set({ formErrors, formValues, sendingState: 'standby' })\n    return unless _.isEmpty(formErrors)\n\n    @state.set('sendingState', 'sending')\n    data = _.extend({ country: me.get('country') }, formValues)\n    contact.send({\n      data\n      context: @\n      success: ->\n        window.tracker?.trackEvent 'Teacher Contact',\n          category: 'Contact',\n          licensesNeeded: formValues.licensesNeeded\n        @state.set({ sendingState: 'sent' })\n        me.set('enrollmentRequestSent', true)\n        setTimeout(=>\n          @hide?()\n        , 3000)\n      error: -> @state.set({ sendingState: 'error' })\n    })\n\n"]}