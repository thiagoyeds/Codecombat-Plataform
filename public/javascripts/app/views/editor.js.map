{"version":3,"sources":["app/templates/editor/achievement/edit.jade","app/templates/editor/achievement/table.jade","app/templates/editor/article/edit.jade","app/templates/editor/article/preview.jade","app/templates/editor/article/table.jade","app/templates/editor/campaign/campaign-analytics-modal.jade","app/templates/editor/campaign/campaign-editor-view.jade","app/templates/editor/campaign/campaign-level-view.jade","app/templates/editor/campaign/save-campaign-modal.jade","app/templates/editor/component/add-thang-components-modal.jade","app/templates/editor/component/thang-component-config-view.jade","app/templates/editor/component/thang-components-edit-view.jade","app/templates/editor/course/edit.jade","app/templates/editor/course/table.jade","app/templates/editor/delta.jade","app/templates/editor/docs/components-documentation-view.jade","app/templates/editor/docs/systems-documentation-view.jade","app/templates/editor/fork-modal.jade","app/templates/editor/level/add-thangs-view.jade","app/templates/editor/level/component/level-component-edit-view.jade","app/templates/editor/level/component/new.jade","app/templates/editor/level/component/table.jade","app/templates/editor/level/components_tab.jade","app/templates/editor/level/level-edit-view.jade","app/templates/editor/level/level-feedback-view.jade","app/templates/editor/level/modal/artisan-guide-modal.jade","app/templates/editor/level/modal/generate-terrain-modal.jade","app/templates/editor/level/modal/load-branch-modal.jade","app/templates/editor/level/modal/new-achievement.jade","app/templates/editor/level/modal/save-branch-modal.jade","app/templates/editor/level/modal/world-select-modal.jade","app/templates/editor/level/related-achievements.jade","app/templates/editor/level/save-level-modal.jade","app/templates/editor/level/scripts_tab.jade","app/templates/editor/level/settings_tab.jade","app/templates/editor/level/system/add.jade","app/templates/editor/level/system/available_system.jade","app/templates/editor/level/system/level-system-edit-view.jade","app/templates/editor/level/system/new.jade","app/templates/editor/level/system/table.jade","app/templates/editor/level/systems-tab-view.jade","app/templates/editor/level/table.jade","app/templates/editor/level/tasks-tab.jade","app/templates/editor/level/thang/available_component.jade","app/templates/editor/level/thang/level-thang-edit-view.jade","app/templates/editor/level/thangs-tab-view.jade","app/templates/editor/modal/new-model-modal.jade","app/templates/editor/modal/save-version-modal.jade","app/templates/editor/modal/versions-modal.jade","app/templates/editor/patch_modal.jade","app/templates/editor/patches.jade","app/templates/editor/poll/poll-edit-view.jade","app/templates/editor/poll/poll-search-table.jade","app/templates/editor/thang/colors_tab.jade","app/templates/editor/thang/export-thang-type-modal.jade","app/templates/editor/thang/sprite_parser_test.jade","app/templates/editor/thang/table.jade","app/templates/editor/thang/thang-type-edit-view.jade","app/templates/editor/thang/vector-icon-setup-modal.jade","app/templates/editor/verifier/verifier-view.jade","app/views/editor/DeltaView.coffee","app/views/editor/ForkModal.coffee","app/views/editor/PatchModal.coffee","app/views/editor/PatchesView.coffee","app/views/editor/achievement/AchievementEditView.coffee","app/views/editor/achievement/AchievementSearchView.coffee","app/views/editor/article/ArticleEditView.coffee","app/views/editor/article/ArticlePreviewView.coffee","app/views/editor/article/ArticleSearchView.coffee","app/views/editor/article/ArticleVersionsModal.coffee","app/views/editor/campaign/CampaignAnalyticsModal.coffee","app/views/editor/campaign/CampaignEditorView.coffee","app/views/editor/campaign/CampaignLevelView.coffee","app/views/editor/campaign/SaveCampaignModal.coffee","app/views/editor/component/AddThangComponentsModal.coffee","app/views/editor/component/ComponentVersionsModal.coffee","app/views/editor/component/ThangComponentConfigView.coffee","app/views/editor/component/ThangComponentsEditView.coffee","app/views/editor/course/CourseEditView.coffee","app/views/editor/course/CourseSearchView.coffee","app/views/editor/docs/ComponentsDocumentationView.coffee","app/views/editor/docs/SystemsDocumentationView.coffee","app/views/editor/level/LevelEditView.coffee","app/views/editor/level/LevelFeedbackView.coffee","app/views/editor/level/LevelSearchView.coffee","app/views/editor/level/RelatedAchievementsView.coffee","app/views/editor/level/components/ComponentsTabView.coffee","app/views/editor/level/components/LevelComponentEditView.coffee","app/views/editor/level/components/NewLevelComponentModal.coffee","app/views/editor/level/modals/ArtisanGuideModal.coffee","app/views/editor/level/modals/GenerateTerrainModal.coffee","app/views/editor/level/modals/LevelVersionsModal.coffee","app/views/editor/level/modals/LoadBranchModal.coffee","app/views/editor/level/modals/NewAchievementModal.coffee","app/views/editor/level/modals/SaveBranchModal.coffee","app/views/editor/level/modals/SaveLevelModal.coffee","app/views/editor/level/modals/WorldSelectModal.coffee","app/views/editor/level/scripts/ScriptsTabView.coffee","app/views/editor/level/settings/SettingsTabView.coffee","app/views/editor/level/systems/AddLevelSystemModal.coffee","app/views/editor/level/systems/LevelSystemEditView.coffee","app/views/editor/level/systems/NewLevelSystemModal.coffee","app/views/editor/level/systems/SystemVersionsModal.coffee","app/views/editor/level/systems/SystemsTabView.coffee","app/views/editor/level/tasks/TasksTabView.coffee","app/views/editor/level/thangs/AddThangsView.coffee","app/views/editor/level/thangs/LevelThangEditView.coffee","app/views/editor/level/thangs/ThangsTabView.coffee","app/views/editor/level/treema_nodes.coffee","app/views/editor/modal/NewModelModal.coffee","app/views/editor/modal/SaveVersionModal.coffee","app/views/editor/modal/VersionsModal.coffee","app/views/editor/poll/PollEditView.coffee","app/views/editor/poll/PollSearchView.coffee","app/views/editor/thang/ExportThangTypeModal.coffee","app/views/editor/thang/ThangTypeColorsTabView.coffee","app/views/editor/thang/ThangTypeEditView.coffee","app/views/editor/thang/ThangTypeSearchView.coffee","app/views/editor/thang/ThangTypeVersionsModal.coffee","app/views/editor/thang/VectorIconSetupModal.coffee","app/views/editor/verifier/VerifierTest.coffee","app/views/editor/verifier/VerifierView.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5FA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhHA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApGA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3LA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5GA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9IA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3IA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5LA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxDA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlGA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5EA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlDA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtEA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlDA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"public/javascripts/app/views/editor.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),features = locals_.features,me = locals_.me,view = locals_.view,usesSocialMedia = locals_.usesSocialMedia,isIE = locals_.isIE,fbRef = locals_.fbRef;buf.push(\"<div id=\\\"site-nav\\\"><a href=\\\"/\\\"><img id=\\\"nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><div id=\\\"site-nav-links\\\"><a href=\\\"/\\\"><img id=\\\"small-nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><a href=\\\"/\\\"><span class=\\\"glyphicon glyphicon-home\\\"></span></a>\");\nif ( !features.playViewsOnly)\n{\nbuf.push(\"<a href=\\\"/play\\\" data-i18n=\\\"common.play\\\"></a><a href=\\\"/play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\nif ( me.isStudent())\n{\nbuf.push(\"<a href=\\\"/students\\\" data-i18n=\\\"nav.my_courses\\\"></a>\");\n}\nif ( me.isTeacher())\n{\nbuf.push(\"<a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a><a href=\\\"/community\\\" data-i18n=\\\"nav.community\\\"></a>\");\nif ( me.get('anonymous') === false)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><button href=\\\"#\\\" data-toggle=\\\"dropdown\\\" class=\\\"btn btn-sm header-font dropdown-toggle\\\">\");\nif ( me.get('photoURL'))\n{\nbuf.push(\"<img\" + (jade.attrs({ 'src':(me.getPhotoURL(18)), 'alt':(\"\"), \"class\": [('account-settings-image')] }, {\"src\":true,\"alt\":true})) + \"/>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"glyphicon glyphicon-user\\\"></i>\");\n}\nbuf.push(\"<span data-i18n=\\\"nav.account\\\" href=\\\"/account\\\" class=\\\"spl spr\\\"></span><span class=\\\"caret\\\"></span></button><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"><li class=\\\"user-dropdown-header\\\"><span class=\\\"user-level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\") }, {\"href\":true})) + \"><div\" + (jade.attrs({ 'style':(\"background-image: url(\" + (me.getPhotoURL()) + \")\"), \"class\": [('img-circle')] }, {\"style\":true})) + \"></div></a><h3>\" + (jade.escape(null == (jade.interp = me.broadName()) ? \"\" : jade.interp)) + \"</h3></li><li><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\"), 'data-i18n':(\"nav.profile\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li><li><a href=\\\"/account/settings\\\" data-i18n=\\\"play.settings\\\"></a></li>\");\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/payments\\\" data-i18n=\\\"account.payments\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()) || me.hasSubscription())\n{\nbuf.push(\"<li><a href=\\\"/account/subscription\\\" data-i18n=\\\"account.subscription\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/prepaid\\\" data-i18n=\\\"account.prepaid_codes\\\"></a></li>\");\n}\nbuf.push(\"<li><a id=\\\"logout-button\\\" data-i18n=\\\"login.log_out\\\"></a></li></ul></span>\");\n}\nelse\n{\nbuf.push(\"<button data-i18n=\\\"login.sign_up\\\" class=\\\"btn btn-sm btn-primary header-font signup-button\\\"></button><button data-i18n=\\\"login.log_in\\\" class=\\\"btn btn-sm btn-default header-font login-button\\\"></button>\");\n}\n}\nbuf.push(\"<select class=\\\"language-dropdown form-control\\\"></select></div></div><div id=\\\"site-content-area\\\">\");\nvar authorized = me.isAdmin() || me.isArtisan();\nbuf.push(\"<ol class=\\\"breadcrumb\\\"><li><a href=\\\"/editor\\\" data-i18n=\\\"editor.main_title\\\">CodeCombat Editors</a></li><li><a href=\\\"/editor/achievement\\\" data-i18n=\\\"editor.achievement_title\\\">Achievement Editor</a></li><li class=\\\"active\\\">\" + (jade.escape((jade.interp = view.achievement.attributes.name) == null ? '' : jade.interp)) + \"</li></ol>\");\nif ( authorized)\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"\"), 'disabled':(me.isAdmin() === true ? undefined : \"true\"), 'id':('recalculate-all-button'), \"class\": [('achievement-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Recalculate All</button><button\" + (jade.attrs({ 'data-i18n':(\"\"), 'disabled':(me.isAdmin() === true ? undefined : \"true\"), 'id':('recalculate-button'), \"class\": [('achievement-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Recalculate</button><button\" + (jade.attrs({ 'data-i18n':(\"common.delete\"), 'disabled':(me.isAdmin() === true ? undefined : \"true\"), 'id':('delete-button'), \"class\": [('achievement-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Delete</button><button\" + (jade.attrs({ 'data-i18n':(\"common.save\"), 'disabled':((me.isAdmin() === true || me.isArtisan() === true) ? undefined : \"true\"), 'id':('save-button'), \"class\": [('achievement-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Save</button>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"achievement.edit_achievement_title\\\">Edit Achievement<span>: \\\"\" + (jade.escape((jade.interp = view.achievement.get('name')) == null ? '' : jade.interp)) + \"\\\"</span></h3><div id=\\\"achievement-treema\\\"></div><div id=\\\"achievement-view\\\" class=\\\"clearfix\\\"></div><h3 data-i18n=\\\"resources.patches\\\">Patches</h3><div class=\\\"patches-view\\\"></div><hr/></div><div class=\\\"achievement-corner\\\"></div><div id=\\\"site-footer\\\"><img id=\\\"footer-background\\\" src=\\\"/images/pages/base/nav_background.png\\\"/><div\" + (jade.attrs({ 'id':('footer-links'), \"class\": [(features.playViewsOnly ? 'hide' : '')] }, {\"class\":true})) + \"><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a tabindex=\\\"-1\\\" data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"http://blog.codecombat.com/\\\" data-i18n=\\\"nav.blog\\\"></a><a href=\\\"https://jobs.lever.co/codecombat\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.careers\\\"></a><a href=\\\"/legal\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.legal\\\"></a><a href=\\\"/privacy\\\" tabindex=\\\"-1\\\" data-i18n=\\\"legal.privacy_title\\\"></a><a href=\\\"/contribute\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.contribute\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a href=\\\"/play/ladder\\\" tabindex=\\\"-1\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<a href=\\\"/admin\\\">Admin</a>\");\n}\nif ( usesSocialMedia)\n{\nbuf.push(\"<div class=\\\"share-buttons\\\">\");\nif ( !isIE)\n{\nbuf.push(\"<div data-href=\\\"http://codecombat.com\\\" data-size=\\\"medium\\\" class=\\\"g-plusone\\\"></div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-href':(\"https://www.facebook.com/codecombat\"), 'data-send':(\"false\"), 'data-layout':(\"button_count\"), 'data-width':(\"350\"), 'data-show-faces':(\"true\"), 'data-ref':(\"coco_footer_\" + (fbRef) + \"\"), \"class\": [('fb-like')] }, {\"data-href\":true,\"data-send\":true,\"data-layout\":true,\"data-width\":true,\"data-show-faces\":true,\"data-ref\":true})) + \"></div>\");\nif ( !isIE)\n{\nbuf.push(\"<a href=\\\"https://twitter.com/CodeCombat\\\" data-show-count=\\\"true\\\" data-show-screen-name=\\\"false\\\" data-dnt=\\\"true\\\" data-align=\\\"right\\\" data-i18n=\\\"nav.twitter_follow\\\" class=\\\"twitter-follow-button\\\"></a><iframe src=\\\"https://ghbtns.com/github-btn.html?user=codecombat&amp;repo=codecombat&amp;type=watch&amp;count=true\\\" allowtransparency=\\\"true\\\" frameborder=\\\"0\\\" scrolling=\\\"0\\\" width=\\\"110\\\" height=\\\"20\\\" class=\\\"github-star-button\\\"></iframe>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div><div id=\\\"footer-credits\\\"><span><span> All Rights Reserved</span><br/><span>CodeCombat 2015</span></span><img id=\\\"footer-logo\\\" src=\\\"/images/pages/base/logo.png\\\" alt=\\\"CodeCombat\\\"/><span><span>Site Design by</span><br/><a href=\\\"http://www.fullyillustrated.com/\\\">Fully Illustrated</a></span><!--a.firebase-bade(href=\\\"https://www.firebase.com/\\\")  // Not using right now--><!--  img(src=\\\"/images/pages/base/firebase.png\\\", alt=\\\"Powered by Firebase\\\")--></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"3\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th data-i18n=\\\"general.collection\\\">Collection</th></tr>\");\n// iterate documents\n;(function(){\n  var $$obj = documents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var data = $$obj[$index];\n\ndata = data.attributes;\nbuf.push(\"<tr><td><a\" + (jade.attrs({ 'href':(\"/editor/achievement/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.collection) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var data = $$obj[$index];\n\ndata = data.attributes;\nbuf.push(\"<tr><td><a\" + (jade.attrs({ 'href':(\"/editor/achievement/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.collection) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),features = locals_.features,me = locals_.me,view = locals_.view,usesSocialMedia = locals_.usesSocialMedia,isIE = locals_.isIE,fbRef = locals_.fbRef;buf.push(\"<div id=\\\"site-nav\\\"><a href=\\\"/\\\"><img id=\\\"nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><div id=\\\"site-nav-links\\\"><a href=\\\"/\\\"><img id=\\\"small-nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><a href=\\\"/\\\"><span class=\\\"glyphicon glyphicon-home\\\"></span></a>\");\nif ( !features.playViewsOnly)\n{\nbuf.push(\"<a href=\\\"/play\\\" data-i18n=\\\"common.play\\\"></a><a href=\\\"/play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\nif ( me.isStudent())\n{\nbuf.push(\"<a href=\\\"/students\\\" data-i18n=\\\"nav.my_courses\\\"></a>\");\n}\nif ( me.isTeacher())\n{\nbuf.push(\"<a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a><a href=\\\"/community\\\" data-i18n=\\\"nav.community\\\"></a>\");\nif ( me.get('anonymous') === false)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><button href=\\\"#\\\" data-toggle=\\\"dropdown\\\" class=\\\"btn btn-sm header-font dropdown-toggle\\\">\");\nif ( me.get('photoURL'))\n{\nbuf.push(\"<img\" + (jade.attrs({ 'src':(me.getPhotoURL(18)), 'alt':(\"\"), \"class\": [('account-settings-image')] }, {\"src\":true,\"alt\":true})) + \"/>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"glyphicon glyphicon-user\\\"></i>\");\n}\nbuf.push(\"<span data-i18n=\\\"nav.account\\\" href=\\\"/account\\\" class=\\\"spl spr\\\"></span><span class=\\\"caret\\\"></span></button><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"><li class=\\\"user-dropdown-header\\\"><span class=\\\"user-level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\") }, {\"href\":true})) + \"><div\" + (jade.attrs({ 'style':(\"background-image: url(\" + (me.getPhotoURL()) + \")\"), \"class\": [('img-circle')] }, {\"style\":true})) + \"></div></a><h3>\" + (jade.escape(null == (jade.interp = me.broadName()) ? \"\" : jade.interp)) + \"</h3></li><li><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\"), 'data-i18n':(\"nav.profile\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li><li><a href=\\\"/account/settings\\\" data-i18n=\\\"play.settings\\\"></a></li>\");\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/payments\\\" data-i18n=\\\"account.payments\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()) || me.hasSubscription())\n{\nbuf.push(\"<li><a href=\\\"/account/subscription\\\" data-i18n=\\\"account.subscription\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/prepaid\\\" data-i18n=\\\"account.prepaid_codes\\\"></a></li>\");\n}\nbuf.push(\"<li><a id=\\\"logout-button\\\" data-i18n=\\\"login.log_out\\\"></a></li></ul></span>\");\n}\nelse\n{\nbuf.push(\"<button data-i18n=\\\"login.sign_up\\\" class=\\\"btn btn-sm btn-primary header-font signup-button\\\"></button><button data-i18n=\\\"login.log_in\\\" class=\\\"btn btn-sm btn-default header-font login-button\\\"></button>\");\n}\n}\nbuf.push(\"<select class=\\\"language-dropdown form-control\\\"></select></div></div><div id=\\\"site-content-area\\\"><div><ol class=\\\"breadcrumb\\\"><li><a href=\\\"/editor\\\" data-i18n=\\\"editor.main_title\\\">CodeCombat Editors</a></li><li><a href=\\\"/editor/article\\\" data-i18n=\\\"editor.article_title\\\">Article Editor</a></li><li class=\\\"active\\\">\" + (jade.escape((jade.interp = view.article.attributes.name) == null ? '' : jade.interp)) + \"</li></ol></div>\");\nvar authorized = !me.get('anonymous');\nbuf.push(\"<button data-i18n=\\\"general.version_history\\\" id=\\\"history-button\\\" class=\\\"article-tool-button btn btn-primary\\\">Version History</button><button\" + (jade.attrs({ 'data-toggle':(\"coco-modal\"), 'data-target':(\"modal/RevertModal\"), 'data-i18n':(\"editor.revert\"), 'disabled':(authorized === true ? undefined : \"true\"), 'id':('revert-button'), \"class\": [('article-tool-button'),('btn'),('btn-primary')] }, {\"data-toggle\":true,\"data-target\":true,\"data-i18n\":true,\"disabled\":true})) + \">Revert</button><button\" + (jade.attrs({ 'data-i18n':(\"article.edit_btn_preview\"), 'disabled':(authorized === true ? undefined : \"true\"), 'id':('preview-button'), \"class\": [('article-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Preview</button><button\" + (jade.attrs({ 'data-i18n':(\"common.save\"), 'disabled':(authorized === true ? undefined : \"true\"), 'id':('save-button'), \"class\": [('article-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Save</button><h3 data-i18n=\\\"article.edit_article_title\\\">Edit Article<span>: \\\"\" + (jade.escape((jade.interp = view.article.attributes.name) == null ? '' : jade.interp)) + \"\\\"</span></h3><div id=\\\"article-treema\\\"></div><h3 data-i18n=\\\"resources.patches\\\">Patches</h3><div class=\\\"patches-view\\\"></div><hr/></div><div class=\\\"achievement-corner\\\"></div><div id=\\\"site-footer\\\"><img id=\\\"footer-background\\\" src=\\\"/images/pages/base/nav_background.png\\\"/><div\" + (jade.attrs({ 'id':('footer-links'), \"class\": [(features.playViewsOnly ? 'hide' : '')] }, {\"class\":true})) + \"><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a tabindex=\\\"-1\\\" data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"http://blog.codecombat.com/\\\" data-i18n=\\\"nav.blog\\\"></a><a href=\\\"https://jobs.lever.co/codecombat\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.careers\\\"></a><a href=\\\"/legal\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.legal\\\"></a><a href=\\\"/privacy\\\" tabindex=\\\"-1\\\" data-i18n=\\\"legal.privacy_title\\\"></a><a href=\\\"/contribute\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.contribute\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a href=\\\"/play/ladder\\\" tabindex=\\\"-1\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<a href=\\\"/admin\\\">Admin</a>\");\n}\nif ( usesSocialMedia)\n{\nbuf.push(\"<div class=\\\"share-buttons\\\">\");\nif ( !isIE)\n{\nbuf.push(\"<div data-href=\\\"http://codecombat.com\\\" data-size=\\\"medium\\\" class=\\\"g-plusone\\\"></div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-href':(\"https://www.facebook.com/codecombat\"), 'data-send':(\"false\"), 'data-layout':(\"button_count\"), 'data-width':(\"350\"), 'data-show-faces':(\"true\"), 'data-ref':(\"coco_footer_\" + (fbRef) + \"\"), \"class\": [('fb-like')] }, {\"data-href\":true,\"data-send\":true,\"data-layout\":true,\"data-width\":true,\"data-show-faces\":true,\"data-ref\":true})) + \"></div>\");\nif ( !isIE)\n{\nbuf.push(\"<a href=\\\"https://twitter.com/CodeCombat\\\" data-show-count=\\\"true\\\" data-show-screen-name=\\\"false\\\" data-dnt=\\\"true\\\" data-align=\\\"right\\\" data-i18n=\\\"nav.twitter_follow\\\" class=\\\"twitter-follow-button\\\"></a><iframe src=\\\"https://ghbtns.com/github-btn.html?user=codecombat&amp;repo=codecombat&amp;type=watch&amp;count=true\\\" allowtransparency=\\\"true\\\" frameborder=\\\"0\\\" scrolling=\\\"0\\\" width=\\\"110\\\" height=\\\"20\\\" class=\\\"github-star-button\\\"></iframe>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div><div id=\\\"footer-credits\\\"><span><span> All Rights Reserved</span><br/><span>CodeCombat 2015</span></span><img id=\\\"footer-logo\\\" src=\\\"/images/pages/base/logo.png\\\" alt=\\\"CodeCombat\\\"/><span><span>Site Design by</span><br/><a href=\\\"http://www.fullyillustrated.com/\\\">Fully Illustrated</a></span><!--a.firebase-bade(href=\\\"https://www.firebase.com/\\\")  // Not using right now--><!--  img(src=\\\"/images/pages/base/firebase.png\\\", alt=\\\"Powered by Firebase\\\")--></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<body><h1 id=\\\"title\\\"></h1><div id=\\\"insert\\\">loading...</div></body>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents,me = locals_.me,page = locals_.page;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"3\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th data-i18n=\\\"general.version\\\">Version</th></tr>\");\n// iterate documents\n;(function(){\n  var $$obj = documents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var document = $$obj[$index];\n\nvar data = document.attributes;\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(document.getOwner() == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(data.name), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(data.description), \"class\": [('body-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var document = $$obj[$index];\n\nvar data = document.attributes;\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(document.getOwner() == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(data.name), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(data.description), \"class\": [('body-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,campaignCompletions = locals_.campaignCompletions,showLeftGame = locals_.showLeftGame,showSubscriptions = locals_.showSubscriptions;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Campaign Analytics</h3>\");\nif ( campaignCompletions.startDay && campaignCompletions.endDay)\n{\nbuf.push(\"<div class=\\\"input-group input-group-sm\\\"><input\" + (jade.attrs({ 'id':('input-startday'), 'type':('text'), 'style':('width:100px;'), 'value':(campaignCompletions.startDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'id':('input-endday'), 'type':('text'), 'style':('width:100px;'), 'value':(campaignCompletions.endDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><button id=\\\"reload-button\\\" style=\\\"margin-left:10px;\\\" class=\\\"btn btn-default btn-sm\\\">Reload</button></div>\");\n}\nbuf.push(\"<label style=\\\"font-size:10px;font-weight:normal;\\\"><span>Double-click row to open level details.</span><span>&nbsp;&nbsp;</span><input\" + (jade.attrs({ 'id':('option-show-left-game'), 'type':('checkbox'), 'checked':(showLeftGame) }, {\"type\":true,\"checked\":true})) + \"/><span>Show Left Game</span><span>&nbsp;&nbsp;</span><input\" + (jade.attrs({ 'id':('option-show-subscriptions'), 'type':('checkbox'), 'checked':(showSubscriptions) }, {\"type\":true,\"checked\":true})) + \"/><span>Show Subscriptions</span></label></div><div class=\\\"modal-body\\\">\");\nif ( campaignCompletions && campaignCompletions.levels)\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td class=\\\"level\\\">Level</td><td>Started</td><td>Finished</td><td class=\\\"completion-rate\\\">Completion %</td><td>Playtime (s)</td>\");\nif ( showLeftGame)\n{\nbuf.push(\"<td>Left Game</td><td>LG %</td><td>LG/s</td>\");\n}\nif ( showSubscriptions)\n{\nbuf.push(\"<td>Sub Shown</td><td>Sub Purchased</td>\");\n}\nbuf.push(\"</tr></thead><tbody>\");\nfor (var i = 0; i < campaignCompletions.levels.length; i++)\n{\nbuf.push(\"<tr\" + (jade.attrs({ 'data-level-slug':(campaignCompletions.levels[i].level), \"class\": [('level')] }, {\"data-level-slug\":true})) + \"><td class=\\\"level-name-container\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].level) ? \"\" : jade.interp)) + \"<span\" + (jade.attrs({ 'style':(\"width:\" + (campaignCompletions.levels[i].usersRemaining || 0) + \"%;\"), \"class\": [('level-name-background')] }, {\"style\":true})) + \"></span></td><td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].started) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].finished) ? \"\" : jade.interp)) + \"</td>\");\nif ( campaignCompletions.levels[i].completionRate)\n{\nif ( campaignCompletions.top3 && campaignCompletions.top3.indexOf(campaignCompletions.levels[i].level) >= 0)\n{\nbuf.push(\"<td style=\\\"background-color:lightblue;\\\" class=\\\"level-completion-container\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].completionRate.toFixed(2)) ? \"\" : jade.interp)) + \"<svg\" + (jade.attrs({ 'id':(\"background\" + (campaignCompletions.levels[i].level) + \"\"), \"class\": [('level-completion-background')] }, {\"id\":true})) + \"></svg></td>\");\n}\nelse if ( campaignCompletions.bottom3 && campaignCompletions.bottom3.indexOf(campaignCompletions.levels[i].level) >= 0)\n{\nbuf.push(\"<td style=\\\"background-color:pink;\\\" class=\\\"level-completion-container\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].completionRate.toFixed(2)) ? \"\" : jade.interp)) + \"<svg\" + (jade.attrs({ 'id':(\"background\" + (campaignCompletions.levels[i].level) + \"\"), \"class\": [('level-completion-background')] }, {\"id\":true})) + \"></svg></td>\");\n}\nelse\n{\nbuf.push(\"<td class=\\\"level-completion-container\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].completionRate.toFixed(2)) ? \"\" : jade.interp)) + \"<svg\" + (jade.attrs({ 'id':(\"background\" + (campaignCompletions.levels[i].level) + \"\"), \"class\": [('level-completion-background')] }, {\"id\":true})) + \"></svg></td>\");\n}\n}\nelse\n{\nbuf.push(\"<td class=\\\"completion-rate\\\"></td>\");\n}\nif ( campaignCompletions.levels[i].averagePlaytime)\n{\nbuf.push(\"<td class=\\\"level-playtime-container\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].averagePlaytime.toFixed(2)) ? \"\" : jade.interp)) + \"<span\" + (jade.attrs({ 'style':(\"width:\" + (campaignCompletions.levels[i].playtimePercentage || 0) + \"%;\"), \"class\": [('level-playtime-background')] }, {\"style\":true})) + \"></span></td>\");\n}\nelse\n{\nbuf.push(\"<td></td>\");\n}\nif ( showLeftGame)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].dropped) ? \"\" : jade.interp)) + \"</td>\");\nif ( campaignCompletions.levels[i].dropPercentage)\n{\nif ( campaignCompletions.top3DropPercentage && campaignCompletions.top3DropPercentage.indexOf(campaignCompletions.levels[i].level) >= 0)\n{\nbuf.push(\"<td style=\\\"background-color:pink;\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].dropPercentage.toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].dropPercentage.toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\n}\nelse\n{\nbuf.push(\"<td></td>\");\n}\nif ( campaignCompletions.levels[i].droppedPerSecond)\n{\nif ( campaignCompletions.top3DropPerSecond && campaignCompletions.top3DropPerSecond.indexOf(campaignCompletions.levels[i].level) >= 0)\n{\nbuf.push(\"<td style=\\\"background-color:pink;\\\">\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].droppedPerSecond.toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].droppedPerSecond.toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\n}\nelse\n{\nbuf.push(\"<td></td>\");\n}\n}\nif ( showSubscriptions)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].subsShown) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = campaignCompletions.levels[i].subsPurchased) ? \"\" : jade.interp)) + \"</td>\");\n}\nbuf.push(\"</tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nelse\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,me = locals_.me,anonymous = locals_.anonymous;if ( view.campaign.loading)\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"campaign-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><div class=\\\"container-fluid\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul></div></nav>\");\n}\nelse\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"campaign-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul><ul class=\\\"nav navbar-nav navbar-right\\\">\");\nif ( me.isAdmin())\n{\nbuf.push(\"<li id=\\\"analytics-button\\\"><a><span class=\\\"glyphicon-stats glyphicon\\\"></span></a></li>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<li id=\\\"save-button\\\"><a><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\"><span class=\\\"glyphicon-chevron-down glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li data-i18n=\\\"common.actions\\\" class=\\\"dropdown-header\\\">Actions</li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-toggle=\\\"coco-modal\\\" data-target=\\\"modal/RevertModal\\\" data-i18n=\\\"editor.revert\\\" id=\\\"revert-button\\\">Revert</a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-i18n=\\\"editor.pop_i18n\\\" id=\\\"pop-level-i18n-button\\\">Populate i18n</a></li>\");\nif ( me.isAdmin())\n{\nbuf.push(\"<li id=\\\"patches-button\\\"><a><span class=\\\"spr glyphicon-wrench glyphicon\\\"></span><span data-i18n=\\\"resources.patches\\\">Patches</span></a></li>\");\n}\nbuf.push(\"<li class=\\\"divider\\\"></li><li data-i18n=\\\"common.info\\\" class=\\\"dropdown-header\\\">Info</li></ul></li></ul></nav>\");\n}\nbuf.push(\"<div class=\\\"outer-content\\\"><div id=\\\"left-column\\\"><div id=\\\"campaign-treema\\\"></div></div><div id=\\\"right-column\\\"><div id=\\\"campaign-view\\\"></div><div id=\\\"campaign-level-view\\\" class=\\\"hidden\\\"></div><div class=\\\"patches-view hidden\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),level = locals_.level,analytics = locals_.analytics;buf.push(\"<div class=\\\"jumbotron\\\"><div type=\\\"button\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div><h1><span class=\\\"spr\\\">\" + (jade.escape(null == (jade.interp = level.get('name')) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/editor/level/\" + (level.get('slug')) + \"\"), 'target':(\"_blank\") }, {\"href\":true,\"target\":true})) + \">(edit)</a></h1><p>\" + (jade.escape(null == (jade.interp = level.get('description')) ? \"\" : jade.interp)) + \"</p>\");\nif ( analytics.startDay && analytics.endDay)\n{\nbuf.push(\"<div class=\\\"input-group input-group-sm\\\"><input\" + (jade.attrs({ 'id':('input-startday'), 'type':('text'), 'style':('width:100px;'), 'value':(analytics.startDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'id':('input-endday'), 'type':('text'), 'style':('width:100px;'), 'value':(analytics.endDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><button id=\\\"reload-button\\\" style=\\\"margin-left:10px;\\\" class=\\\"btn btn-default btn-sm\\\">Reload</button></div>\");\n}\n// iterate analytics.graphs\n;(function(){\n  var $$obj = analytics.graphs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var graph = $$obj[$index];\n\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"line-graph-container\\\">\");\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var graph = $$obj[$index];\n\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"line-graph-container\\\">\");\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<h4>Common Problems</h4>\");\nif ( analytics.commonProblems.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Language</td><td>Error Message</td><td>Error Hint</td><td>Count</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.commonProblems.data.length && i < 20; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].language) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].message) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].hint) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].count) ? \"\" : jade.interp)) + \"</td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Recent Sessions</h4>\");\nif ( analytics.recentSessions.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<div style=\\\"font-size:10pt\\\">Latest \" + (jade.escape((jade.interp = analytics.recentSessions.data.length) == null ? '' : jade.interp)) + \" sessions for this level</div><div style=\\\"font-size:10pt\\\">Double-click row to open player and session</div><table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Session ID</td><td>Player</td><td>Code Language</td><td>Playtime</td><td>Complete</td><td>Changed</td><td>Replay</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.recentSessions.data.length; i++)\n{\nbuf.push(\"<tr\" + (jade.attrs({ 'data-player-id':(analytics.recentSessions.data[i].creator), 'data-session-id':(analytics.recentSessions.data[i]._id), \"class\": [('recent-session')] }, {\"data-player-id\":true,\"data-session-id\":true})) + \"><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i]._id) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].creatorName || analytics.recentSessions.data[i].creator) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].codeLanguage) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].playtime) ? \"\" : jade.interp)) + \"</td>\");\nif ( analytics.recentSessions.data[i].state && analytics.recentSessions.data[i].state.complete)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].state.complete) ? \"\" : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td>false</td>\");\n}\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].changed) ? \"\" : jade.interp)) + \"</td><td><button class=\\\"btn replay-button btn-xs\\\"><div class=\\\"glyphicon glyphicon-eye-open\\\"></div></button></td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Completion Rates</h4>\");\nif ( analytics.levelCompletions.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Date</td><td>Started</td><td>Finished</td><td>Completion %</td>\");\nif ( analytics.levelHelps.data.length === analytics.levelCompletions.data.length)\n{\nbuf.push(\"<td>Helps Clicked</td><td>Helps / Started</td><td>Help Videos</td><td>Videos / Started</td>\");\n}\nbuf.push(\"</tr></thead><tbody>\");\nfor (var i = 0; i < analytics.levelCompletions.data.length; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].created) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].started) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].finished) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].rate) ? \"\" : jade.interp)) + \"</td>\");\nif ( analytics.levelHelps.data.length === analytics.levelCompletions.data.length && analytics.levelCompletions.data[i].created == analytics.levelHelps.data[i].day)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.levelHelps.data[i].alertHelps + analytics.levelHelps.data[i].paletteHelps) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = ((analytics.levelHelps.data[i].alertHelps + analytics.levelHelps.data[i].paletteHelps) / analytics.levelCompletions.data[i].started).toFixed(2)) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelHelps.data[i].videoStarts) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = (analytics.levelHelps.data[i].videoStarts / analytics.levelCompletions.data[i].started).toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\nbuf.push(\"</tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Average Playtimes</h4>\");\nif ( analytics.levelPlaytimes.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Date</td><td>Average (s)</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.levelPlaytimes.data.length; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.levelPlaytimes.data[i].created) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelPlaytimes.data[i].average.toFixed(2)) ? \"\" : jade.interp)) + \"</td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"</div>\");\nif ( level.get('tasks'))\n{\nbuf.push(\"<div class=\\\"tasks\\\"><h3>Tasks (read only)</h3><ul class=\\\"list-unstyled\\\">\");\n// iterate level.get('tasks')\n;(function(){\n  var $$obj = level.get('tasks');\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var task = $$obj[$index];\n\nbuf.push(\"<li><input\" + (jade.attrs({ 'type':('checkbox'), 'checked':(task.complete) }, {\"type\":true,\"checked\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = task.name) ? \"\" : jade.interp)) + \"</span></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var task = $$obj[$index];\n\nbuf.push(\"<li><input\" + (jade.attrs({ 'type':('checkbox'), 'checked':(task.complete) }, {\"type\":true,\"checked\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = task.name) ? \"\" : jade.interp)) + \"</span></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></div>\");\n};return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Save Changes to Campaign</h3></div><div class=\\\"modal-body\\\">\");\nif ( !view.modelsToSave.models.length)\n{\nbuf.push(\"<div data-i18n=\\\"delta.no_changes\\\" class=\\\"alert alert-info\\\">No changes</div>\");\n}\n// iterate view.modelsToSave.models\n;(function(){\n  var $$obj = view.modelsToSave.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var model = $$obj[$index];\n\nbuf.push(\"<div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><span class=\\\"panel-title spr\\\">\" + (jade.escape(null == (jade.interp = model.get('name')) ? \"\" : jade.interp)) + \"</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = model.constructor.className) ? \"\" : jade.interp)) + \"</span></div><div class=\\\"panel-body\\\"><div\" + (jade.attrs({ 'data-model-id':(model.id), \"class\": [('delta-view')] }, {\"data-model-id\":true})) + \"></div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var model = $$obj[$index];\n\nbuf.push(\"<div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><span class=\\\"panel-title spr\\\">\" + (jade.escape(null == (jade.interp = model.get('name')) ? \"\" : jade.interp)) + \"</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = model.constructor.className) ? \"\" : jade.interp)) + \"</span></div><div class=\\\"panel-body\\\"><div\" + (jade.attrs({ 'data-model-id':(model.id), \"class\": [('delta-view')] }, {\"data-model-id\":true})) + \"></div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button data-i18n=\\\"common.save\\\" id=\\\"save-button\\\" class=\\\"btn btn-primary\\\">Save</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,systems = locals_.systems,nameLists = locals_.nameLists,components = locals_.components;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h1 data-i18n=\\\"editor.add_components\\\">Add Components</h1></div><div class=\\\"modal-body\\\"><form><ul class=\\\"list-group\\\">\");\n// iterate systems\n;(function(){\n  var $$obj = systems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<li class=\\\"list-group-item\\\"><div\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-target':(\"#\" + (system) + \"\"), \"class\": [('item-title'),('collapsed')] }, {\"data-toggle\":true,\"data-target\":true})) + \"><span class=\\\"glyphicon glyphicon-chevron-down text-muted spr\\\"></span><span class=\\\"glyphicon glyphicon-chevron-up text-muted spr\\\"></span><a>\" + (jade.escape(null == (jade.interp = system) ? \"\" : jade.interp)) + \"</a><span class=\\\"spl text-muted\\\">\" + (jade.escape(null == (jade.interp = nameLists[system]) ? \"\" : jade.interp)) + \"</span></div><div\" + (jade.attrs({ 'id':(system), \"class\": [('collapse-panel'),('collapse')] }, {\"id\":true})) + \">\");\n// iterate components[system]\n;(function(){\n  var $$obj = components[system];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':('checkbox'), 'value':(component.id) }, {\"type\":true,\"value\":true})) + \"/><span class=\\\"spr\\\">\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \":</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = component.get('description')) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':('checkbox'), 'value':(component.id) }, {\"type\":true,\"value\":true})) + \"/><span class=\\\"spr\\\">\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \":</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = component.get('description')) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<li class=\\\"list-group-item\\\"><div\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-target':(\"#\" + (system) + \"\"), \"class\": [('item-title'),('collapsed')] }, {\"data-toggle\":true,\"data-target\":true})) + \"><span class=\\\"glyphicon glyphicon-chevron-down text-muted spr\\\"></span><span class=\\\"glyphicon glyphicon-chevron-up text-muted spr\\\"></span><a>\" + (jade.escape(null == (jade.interp = system) ? \"\" : jade.interp)) + \"</a><span class=\\\"spl text-muted\\\">\" + (jade.escape(null == (jade.interp = nameLists[system]) ? \"\" : jade.interp)) + \"</span></div><div\" + (jade.attrs({ 'id':(system), \"class\": [('collapse-panel'),('collapse')] }, {\"id\":true})) + \">\");\n// iterate components[system]\n;(function(){\n  var $$obj = components[system];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':('checkbox'), 'value':(component.id) }, {\"type\":true,\"value\":true})) + \"/><span class=\\\"spr\\\">\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \":</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = component.get('description')) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':('checkbox'), 'value':(component.id) }, {\"type\":true,\"value\":true})) + \"/><span class=\\\"spr\\\">\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \":</span><span class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = component.get('description')) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" data-i18n=\\\"modal.okay\\\" class=\\\"btn btn-primary\\\">Okay</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"panel panel-default\\\"><div\" + (jade.attrs({ \"class\": [('panel-heading'),(view.isDefaultComponent ? \"is-default-component\" : \"\")] }, {\"class\":true})) + \"><em>\" + (jade.escape((jade.interp = view.component.attributes.system) == null ? '' : jade.interp)) + \".</em><strong class=\\\"panel-title spr\\\">\" + (jade.escape(null == (jade.interp = view.component.attributes.name) ? \"\" : jade.interp)) + \"</strong><span id=\\\"description\\\" class=\\\"text-muted\\\">\" + (jade.escape(null == (jade.interp = view.component.attributes.description) ? \"\" : jade.interp)) + \"</span></div><div class=\\\"panel-body\\\"><div class=\\\"treema\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<div id=\\\"thang-components-column\\\" class=\\\"column\\\"><h3 data-i18n=\\\"editor.level_tab_components\\\">Components</h3><button id=\\\"add-components-button\\\" data-i18n=\\\"editor.add_components\\\" class=\\\"btn\\\">Add Components</button><div class=\\\"treema\\\"></div></div><div id=\\\"thang-components-config-column\\\" class=\\\"column\\\"><h3 data-i18n=\\\"editor.component_configs\\\">Component Configurations</h3><div id=\\\"thang-component-configs\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),features = locals_.features,me = locals_.me,view = locals_.view,usesSocialMedia = locals_.usesSocialMedia,isIE = locals_.isIE,fbRef = locals_.fbRef;buf.push(\"<div id=\\\"site-nav\\\"><a href=\\\"/\\\"><img id=\\\"nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><div id=\\\"site-nav-links\\\"><a href=\\\"/\\\"><img id=\\\"small-nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><a href=\\\"/\\\"><span class=\\\"glyphicon glyphicon-home\\\"></span></a>\");\nif ( !features.playViewsOnly)\n{\nbuf.push(\"<a href=\\\"/play\\\" data-i18n=\\\"common.play\\\"></a><a href=\\\"/play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\nif ( me.isStudent())\n{\nbuf.push(\"<a href=\\\"/students\\\" data-i18n=\\\"nav.my_courses\\\"></a>\");\n}\nif ( me.isTeacher())\n{\nbuf.push(\"<a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a><a href=\\\"/community\\\" data-i18n=\\\"nav.community\\\"></a>\");\nif ( me.get('anonymous') === false)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><button href=\\\"#\\\" data-toggle=\\\"dropdown\\\" class=\\\"btn btn-sm header-font dropdown-toggle\\\">\");\nif ( me.get('photoURL'))\n{\nbuf.push(\"<img\" + (jade.attrs({ 'src':(me.getPhotoURL(18)), 'alt':(\"\"), \"class\": [('account-settings-image')] }, {\"src\":true,\"alt\":true})) + \"/>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"glyphicon glyphicon-user\\\"></i>\");\n}\nbuf.push(\"<span data-i18n=\\\"nav.account\\\" href=\\\"/account\\\" class=\\\"spl spr\\\"></span><span class=\\\"caret\\\"></span></button><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"><li class=\\\"user-dropdown-header\\\"><span class=\\\"user-level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\") }, {\"href\":true})) + \"><div\" + (jade.attrs({ 'style':(\"background-image: url(\" + (me.getPhotoURL()) + \")\"), \"class\": [('img-circle')] }, {\"style\":true})) + \"></div></a><h3>\" + (jade.escape(null == (jade.interp = me.broadName()) ? \"\" : jade.interp)) + \"</h3></li><li><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\"), 'data-i18n':(\"nav.profile\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li><li><a href=\\\"/account/settings\\\" data-i18n=\\\"play.settings\\\"></a></li>\");\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/payments\\\" data-i18n=\\\"account.payments\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()) || me.hasSubscription())\n{\nbuf.push(\"<li><a href=\\\"/account/subscription\\\" data-i18n=\\\"account.subscription\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/prepaid\\\" data-i18n=\\\"account.prepaid_codes\\\"></a></li>\");\n}\nbuf.push(\"<li><a id=\\\"logout-button\\\" data-i18n=\\\"login.log_out\\\"></a></li></ul></span>\");\n}\nelse\n{\nbuf.push(\"<button data-i18n=\\\"login.sign_up\\\" class=\\\"btn btn-sm btn-primary header-font signup-button\\\"></button><button data-i18n=\\\"login.log_in\\\" class=\\\"btn btn-sm btn-default header-font login-button\\\"></button>\");\n}\n}\nbuf.push(\"<select class=\\\"language-dropdown form-control\\\"></select></div></div><div id=\\\"site-content-area\\\"><div><ol class=\\\"breadcrumb\\\"><li><a href=\\\"/editor\\\" data-i18n=\\\"editor.main_title\\\">CodeCombat Editors</a></li><li><a href=\\\"/editor/course\\\" data-i18n=\\\"editor.course_title\\\">Course Editor</a></li><li class=\\\"active\\\">\" + (jade.escape((jade.interp = view.course.get('name')) == null ? '' : jade.interp)) + \"</li></ol></div>\");\nvar authorized = !me.get('anonymous');\nbuf.push(\"<button\" + (jade.attrs({ 'data-i18n':(\"common.save\"), 'disabled':(authorized === true ? undefined : \"true\"), 'id':('save-button'), \"class\": [('course-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Save</button><h3 data-i18n=\\\"course.edit_course_title\\\">Edit Course<span>: \\\"\" + (jade.escape((jade.interp = view.course.attributes.name) == null ? '' : jade.interp)) + \"\\\"</span></h3><div class=\\\"alert alert-warning\\\">Can only edit translations currently</div><div id=\\\"course-treema\\\"></div><h3 data-i18n=\\\"resources.patches\\\">Patches</h3><div class=\\\"patches-view\\\"></div><hr/></div><div class=\\\"achievement-corner\\\"></div><div id=\\\"site-footer\\\"><img id=\\\"footer-background\\\" src=\\\"/images/pages/base/nav_background.png\\\"/><div\" + (jade.attrs({ 'id':('footer-links'), \"class\": [(features.playViewsOnly ? 'hide' : '')] }, {\"class\":true})) + \"><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a tabindex=\\\"-1\\\" data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"http://blog.codecombat.com/\\\" data-i18n=\\\"nav.blog\\\"></a><a href=\\\"https://jobs.lever.co/codecombat\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.careers\\\"></a><a href=\\\"/legal\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.legal\\\"></a><a href=\\\"/privacy\\\" tabindex=\\\"-1\\\" data-i18n=\\\"legal.privacy_title\\\"></a><a href=\\\"/contribute\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.contribute\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a href=\\\"/play/ladder\\\" tabindex=\\\"-1\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<a href=\\\"/admin\\\">Admin</a>\");\n}\nif ( usesSocialMedia)\n{\nbuf.push(\"<div class=\\\"share-buttons\\\">\");\nif ( !isIE)\n{\nbuf.push(\"<div data-href=\\\"http://codecombat.com\\\" data-size=\\\"medium\\\" class=\\\"g-plusone\\\"></div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-href':(\"https://www.facebook.com/codecombat\"), 'data-send':(\"false\"), 'data-layout':(\"button_count\"), 'data-width':(\"350\"), 'data-show-faces':(\"true\"), 'data-ref':(\"coco_footer_\" + (fbRef) + \"\"), \"class\": [('fb-like')] }, {\"data-href\":true,\"data-send\":true,\"data-layout\":true,\"data-width\":true,\"data-show-faces\":true,\"data-ref\":true})) + \"></div>\");\nif ( !isIE)\n{\nbuf.push(\"<a href=\\\"https://twitter.com/CodeCombat\\\" data-show-count=\\\"true\\\" data-show-screen-name=\\\"false\\\" data-dnt=\\\"true\\\" data-align=\\\"right\\\" data-i18n=\\\"nav.twitter_follow\\\" class=\\\"twitter-follow-button\\\"></a><iframe src=\\\"https://ghbtns.com/github-btn.html?user=codecombat&amp;repo=codecombat&amp;type=watch&amp;count=true\\\" allowtransparency=\\\"true\\\" frameborder=\\\"0\\\" scrolling=\\\"0\\\" width=\\\"110\\\" height=\\\"20\\\" class=\\\"github-star-button\\\"></iframe>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div><div id=\\\"footer-credits\\\"><span><span> All Rights Reserved</span><br/><span>CodeCombat 2015</span></span><img id=\\\"footer-logo\\\" src=\\\"/images/pages/base/logo.png\\\" alt=\\\"CodeCombat\\\"/><span><span>Site Design by</span><br/><a href=\\\"http://www.fullyillustrated.com/\\\">Fully Illustrated</a></span><!--a.firebase-bade(href=\\\"https://www.firebase.com/\\\")  // Not using right now--><!--  img(src=\\\"/images/pages/base/firebase.png\\\", alt=\\\"Powered by Firebase\\\")--></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents,me = locals_.me,page = locals_.page;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"4\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th></tr>\");\n// iterate documents\n;(function(){\n  var $$obj = documents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var course = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(course.get('creator') == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(course.get('name')), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (course.get('slug') || course.id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape(null == (jade.interp = course.get('name')) ? \"\" : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(course.get('description')), \"class\": [('description-row')] }, {\"title\":true})) + \">\" + (jade.escape(null == (jade.interp = course.get('description')) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var course = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(course.get('creator') == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(course.get('name')), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (course.get('slug') || course.id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape(null == (jade.interp = course.get('name')) ? \"\" : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(course.get('description')), \"class\": [('description-row')] }, {\"title\":true})) + \">\" + (jade.escape(null == (jade.interp = course.get('description')) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;var i = 0\nvar counter = view.constructor.deltaCounter;\nvar deltaPanel_mixin = function(delta, conflict){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\ndelta.index = i++\nbuf.push(\"<div\" + (jade.attrs({ 'data-index':(i), \"class\": [('delta'),('panel'),('panel-default'),('delta-'+delta.action)] }, {\"class\":true,\"data-index\":true})) + \"><div class=\\\"panel-heading\\\">\");\nif ( delta.action === 'added')\n{\nbuf.push(\"<strong data-i18n=\\\"delta.added\\\">Added</strong>\");\n}\nif ( delta.action === 'modified')\n{\nbuf.push(\"<strong data-i18n=\\\"delta.modified\\\">Modified</strong>\");\n}\nif ( delta.action === 'deleted')\n{\nbuf.push(\"<strong data-i18n=\\\"delta.deleted\\\">Deleted</strong>\");\n}\nif ( delta.action === 'moved-index')\n{\nbuf.push(\"<strong data-i18n=\\\"delta.moved_index\\\">Moved Index</strong>\");\n}\nif ( delta.action === 'text-diff')\n{\nbuf.push(\"<strong data-i18n=\\\"delta.text_diff\\\">Text Diff</strong>\");\n}\nbuf.push(\"<span> </span><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#delta-accordion\"+(counter)), 'href':(\"#collapse-\"+(i+counter)) }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \"><span>\" + (jade.escape(null == (jade.interp = delta.humanPath) ? \"\" : jade.interp)) + \"</span></a></div><div\" + (jade.attrs({ 'id':(\"collapse-\"+(i+counter)), \"class\": [('panel-collapse'),('collapse')] }, {\"id\":true})) + \"><div\" + (jade.attrs({ \"class\": [('panel-body'),('row'),(conflict ? \"conflict-details\" : \"details\")] }, {\"class\":true})) + \">\");\nif ( delta.action === 'added')\n{\nbuf.push(\"<div class=\\\"new-value col-md-12\\\">\" + (jade.escape(null == (jade.interp = delta.right) ? \"\" : jade.interp)) + \"</div>\");\n}\nif ( delta.action === 'modified')\n{\nbuf.push(\"<div class=\\\"old-value col-md-6\\\">\" + (jade.escape(null == (jade.interp = delta.left) ? \"\" : jade.interp)) + \"</div><div class=\\\"new-value col-md-6\\\">\" + (jade.escape(null == (jade.interp = delta.right) ? \"\" : jade.interp)) + \"</div>\");\n}\nif ( delta.action === 'deleted')\n{\nbuf.push(\"<div class=\\\"col-md-12\\\"><div class=\\\"old-value\\\">\" + (jade.escape(null == (jade.interp = delta.left) ? \"\" : jade.interp)) + \"</div></div>\");\n}\nif ( delta.action === 'text-diff')\n{\nbuf.push(\"<div class=\\\"col-md-12\\\"><div class=\\\"text-diff\\\"></div></div>\");\n}\nif ( delta.action === 'moved-index')\n{\nbuf.push(\"<div class=\\\"col-md-12\\\"><span>Moved array value \" + (jade.escape((jade.interp = delta.hash) == null ? '' : jade.interp)) + \": \" + (jade.escape((jade.interp = delta.originalIndex) == null ? '' : jade.interp)) + \"  \" + (jade.escape((jade.interp = delta.destinationIndex) == null ? '' : jade.interp)) + \"</span></div>\");\n}\nbuf.push(\"</div></div>\");\nif ( delta.conflict && !conflict)\n{\nbuf.push(\"<div class=\\\"panel-body\\\"><strong data-i18n=\\\"delta.merge_conflict_with\\\">MERGE CONFLICT WITH</strong>\");\ndeltaPanel_mixin(delta.conflict, true);\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div>\");\n};\nbuf.push(\"<div\" + (jade.attrs({ 'id':('delta-accordion-'+(counter)), \"class\": [('panel-group')] }, {\"id\":true})) + \">\");\n// iterate view.expandedDeltas\n;(function(){\n  var $$obj = view.expandedDeltas;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var delta = $$obj[$index];\n\ndeltaPanel_mixin(delta);\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var delta = $$obj[$index];\n\ndeltaPanel_mixin(delta);\n    }\n\n  }\n}).call(this);\n\nif ( !view.expandedDeltas.length)\n{\nbuf.push(\"<alert data-i18n=\\\"delta.no_changes\\\" class=\\\"alert-warning\\\">No changes</alert>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"delta panel panel-default\\\"><div class=\\\"panel-heading\\\"><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#delta-accordion-expert\"), 'href':(\"#collapse-expert-\"+(counter)) }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \"><span>Expert View</span></a></div><div\" + (jade.attrs({ 'id':(\"collapse-expert-\"+(counter)), \"class\": [('panel-collapse'),('collapse')] }, {\"id\":true})) + \"><div class=\\\"panel-body row\\\"><div class=\\\"expert-view\\\"></div></div></div></div>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),components = locals_.components,codeLanguage = locals_.codeLanguage,marked = locals_.marked;buf.push(\"<div class=\\\"container\\\"><div class=\\\"pull-right\\\"><button id=\\\"toggle-all-component-code\\\" class=\\\"btn btn-primary\\\">Toggle all code</button></div><div class=\\\"clearfix\\\"></div><div class=\\\"row\\\"><div class=\\\"col-xs-3 index-column nano\\\"><ul class=\\\"nav nav-list list-group nano-content\\\">\");\n// iterate components\n;(function(){\n  var $$obj = components;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\"), \"class\": [('doc-name')] }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape(null == (jade.interp = component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</li><ul><!-- .list-group for different layout-->\");\n// iterate (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : [])\n;(function(){\n  var $$obj = (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var doc = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\" + (doc.name) + \"\") }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"</li></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var doc = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\" + (doc.name) + \"\") }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"</li></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\"), \"class\": [('doc-name')] }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape(null == (jade.interp = component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</li><ul><!-- .list-group for different layout-->\");\n// iterate (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : [])\n;(function(){\n  var $$obj = (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var doc = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\" + (doc.name) + \"\") }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"</li></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var doc = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (component.get('name')) + \"\" + (doc.name) + \"\") }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"</li></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></div><div class=\\\"col-xs-9 documentation-column nano\\\"><ul class=\\\"nano-content\\\">\");\n// iterate components\n;(function(){\n  var $$obj = components;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\"), \"class\": [(\"panel panel-defalt\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-heading\\\"><strong>\" + (jade.escape(null == (jade.interp = component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</strong></div><div class=\\\"panel-body\\\">\" + (jade.escape((jade.interp = component.get('description')) == null ? '' : jade.interp)) + \"</div><ul>\");\n// iterate (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : [])\n;(function(){\n  var $$obj = (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var doc = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\" + (doc.name) + \"\"), \"class\": [('list-group-item')] }, {\"id\":true})) + \">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"<ul class=\\\"special-list\\\">\");\nif ( doc.description[codeLanguage])\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description[codeLanguage])) ? \"\" : jade.interp) + \"</li>\");\n}\nelse\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description)) ? \"\" : jade.interp) + \"</li>\");\n}\nbuf.push(\"</ul></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var doc = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\" + (doc.name) + \"\"), \"class\": [('list-group-item')] }, {\"id\":true})) + \">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"<ul class=\\\"special-list\\\">\");\nif ( doc.description[codeLanguage])\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description[codeLanguage])) ? \"\" : jade.interp) + \"</li>\");\n}\nelse\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description)) ? \"\" : jade.interp) + \"</li>\");\n}\nbuf.push(\"</ul></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<li class=\\\"panel-heading\\\"><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#\" + (component.get('name')) + \"\"), 'href':(\"#\" + (component.get('name')) + \"Code\"), \"class\": [('code-block')] }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \">Code</a></li></ul><div\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"Code\"), \"class\": [(\"panel-collapse collapse\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-body\\\"><pre>\" + (jade.escape((jade.interp = component.attributes.code) == null ? '' : jade.interp)) + \"</pre></div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\"), \"class\": [(\"panel panel-defalt\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-heading\\\"><strong>\" + (jade.escape(null == (jade.interp = component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</strong></div><div class=\\\"panel-body\\\">\" + (jade.escape((jade.interp = component.get('description')) == null ? '' : jade.interp)) + \"</div><ul>\");\n// iterate (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : [])\n;(function(){\n  var $$obj = (component.attributes.propertyDocumentation ? component.attributes.propertyDocumentation : []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var doc = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\" + (doc.name) + \"\"), \"class\": [('list-group-item')] }, {\"id\":true})) + \">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"<ul class=\\\"special-list\\\">\");\nif ( doc.description[codeLanguage])\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description[codeLanguage])) ? \"\" : jade.interp) + \"</li>\");\n}\nelse\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description)) ? \"\" : jade.interp) + \"</li>\");\n}\nbuf.push(\"</ul></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var doc = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"\" + (doc.name) + \"\"), \"class\": [('list-group-item')] }, {\"id\":true})) + \">\" + (jade.escape((jade.interp = doc.name) == null ? '' : jade.interp)) + \"<ul class=\\\"special-list\\\">\");\nif ( doc.description[codeLanguage])\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description[codeLanguage])) ? \"\" : jade.interp) + \"</li>\");\n}\nelse\n{\nbuf.push(\"<li>\" + (null == (jade.interp = marked(doc.description)) ? \"\" : jade.interp) + \"</li>\");\n}\nbuf.push(\"</ul></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<li class=\\\"panel-heading\\\"><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#\" + (component.get('name')) + \"\"), 'href':(\"#\" + (component.get('name')) + \"Code\"), \"class\": [('code-block')] }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \">Code</a></li></ul><div\" + (jade.attrs({ 'id':(\"\" + (component.get('name')) + \"Code\"), \"class\": [(\"panel-collapse collapse\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-body\\\"><pre>\" + (jade.escape((jade.interp = component.attributes.code) == null ? '' : jade.interp)) + \"</pre></div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul><div class=\\\"clearfix\\\"></div></div><div class=\\\"clearfix\\\"></div></div><div class=\\\"clearfix\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),systems = locals_.systems;buf.push(\"<div class=\\\"container\\\"><div class=\\\"pull-right\\\"><button id=\\\"toggle-all-system-code\\\" class=\\\"btn btn-primary\\\">Toggle all code</button></div><div class=\\\"clearfix\\\"></div><div class=\\\"row\\\"><div class=\\\"col-xs-3 index-column nano\\\"><ul class=\\\"nav nav-list list-group nano-content\\\">\");\n// iterate systems\n;(function(){\n  var $$obj = systems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (system.get('name')) + \"\"), \"class\": [('doc-name')] }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape(null == (jade.interp = system.get('name')) ? \"\" : jade.interp)) + \"</li></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"#\" + (system.get('name')) + \"\"), \"class\": [('doc-name')] }, {\"href\":true})) + \"><li class=\\\"list-group-item\\\">\" + (jade.escape(null == (jade.interp = system.get('name')) ? \"\" : jade.interp)) + \"</li></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></div><div class=\\\"col-xs-9 documentation-column nano\\\"><ul class=\\\"nano-content\\\">\");\n// iterate systems\n;(function(){\n  var $$obj = systems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"\" + (system.get('name')) + \"\"), \"class\": [(\"panel panel-defalt\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-heading\\\">\" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</div><div class=\\\"panel-body\\\">\" + (jade.escape((jade.interp = system.get('description')) == null ? '' : jade.interp)) + \"</div><ul><li class=\\\"panel-heading\\\"><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#\" + (system.get('name')) + \"\"), 'href':(\"#\" + (system.get('name')) + \"Code\"), \"class\": [('code-block')] }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \">Code</a></li></ul><div\" + (jade.attrs({ 'id':(\"\" + (system.get('name')) + \"Code\"), \"class\": [(\"panel-collapse collapse\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-body\\\"><pre>\" + (jade.escape((jade.interp = system.attributes.code) == null ? '' : jade.interp)) + \"</pre></div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(\"\" + (system.get('name')) + \"\"), \"class\": [(\"panel panel-defalt\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-heading\\\">\" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</div><div class=\\\"panel-body\\\">\" + (jade.escape((jade.interp = system.get('description')) == null ? '' : jade.interp)) + \"</div><ul><li class=\\\"panel-heading\\\"><a\" + (jade.attrs({ 'data-toggle':(\"collapse\"), 'data-parent':(\"#\" + (system.get('name')) + \"\"), 'href':(\"#\" + (system.get('name')) + \"Code\"), \"class\": [('code-block')] }, {\"data-toggle\":true,\"data-parent\":true,\"href\":true})) + \">Code</a></li></ul><div\" + (jade.attrs({ 'id':(\"\" + (system.get('name')) + \"Code\"), \"class\": [(\"panel-collapse collapse\")] }, {\"id\":true,\"class\":true})) + \"><div class=\\\"panel-body\\\"><pre>\" + (jade.escape((jade.interp = system.attributes.code) == null ? '' : jade.interp)) + \"</pre></div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul><div class=\\\"clearfix\\\"></div></div><div class=\\\"clearfix\\\"></div></div><div class=\\\"clearfix\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"editor.fork_title\\\">Fork New Version</h3></div><div class=\\\"modal-body\\\"><form class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"model-name\\\" data-i18n=\\\"general.name\\\">Name</label><input id=\\\"fork-model-name\\\" name=\\\"name\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div></form></div><div class=\\\"modal-body wait secret\\\"><h3 data-i18n=\\\"editor.fork_creating\\\">Creating Fork...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button id=\\\"fork-model-confirm-button\\\" data-i18n=\\\"common.save\\\" class=\\\"btn btn-primary\\\">Save</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),groups = locals_.groups;buf.push(\"<h3 data-i18n=\\\"editor.level_tab_thangs_add\\\">Add Thangs</h3><input type=\\\"search\\\" id=\\\"thang-search\\\" data-i18n=\\\"[placeholder]editor.level_tab_thangs_search\\\" placeholder=\\\"Search thangs\\\"/><div class=\\\"editor-nano-container nano\\\"><div id=\\\"thangs-list\\\" class=\\\"nano-content\\\">\");\n// iterate groups\n;(function(){\n  var $$obj = groups;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var group = $$obj[$index];\n\nbuf.push(\"<h4>\" + (jade.escape(null == (jade.interp = group.name) ? \"\" : jade.interp)) + \"</h4>\");\n// iterate group.thangs\n;(function(){\n  var $$obj = group.thangs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var thangType = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-thang-type':(thangType.get('name')), 'title':(thangType.get('name')), \"class\": [('add-thang-palette-icon')] }, {\"data-thang-type\":true,\"title\":true})) + \"><img\" + (jade.attrs({ 'src':(thangType.getPortraitURL()), 'alt':(\"\") }, {\"src\":true,\"alt\":true})) + \"/></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var thangType = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-thang-type':(thangType.get('name')), 'title':(thangType.get('name')), \"class\": [('add-thang-palette-icon')] }, {\"data-thang-type\":true,\"title\":true})) + \"><img\" + (jade.attrs({ 'src':(thangType.getPortraitURL()), 'alt':(\"\") }, {\"src\":true,\"alt\":true})) + \"/></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"clearfix\\\"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var group = $$obj[$index];\n\nbuf.push(\"<h4>\" + (jade.escape(null == (jade.interp = group.name) ? \"\" : jade.interp)) + \"</h4>\");\n// iterate group.thangs\n;(function(){\n  var $$obj = group.thangs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var thangType = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-thang-type':(thangType.get('name')), 'title':(thangType.get('name')), \"class\": [('add-thang-palette-icon')] }, {\"data-thang-type\":true,\"title\":true})) + \"><img\" + (jade.attrs({ 'src':(thangType.getPortraitURL()), 'alt':(\"\") }, {\"src\":true,\"alt\":true})) + \"/></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var thangType = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-thang-type':(thangType.get('name')), 'title':(thangType.get('name')), \"class\": [('add-thang-palette-icon')] }, {\"data-thang-type\":true,\"title\":true})) + \"><img\" + (jade.attrs({ 'src':(thangType.getPortraitURL()), 'alt':(\"\") }, {\"src\":true,\"alt\":true})) + \"/></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"clearfix\\\"></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),editTitle = locals_.editTitle,component = locals_.component,me = locals_.me;buf.push(\"<nav role=\\\"navigation\\\" class=\\\"navbar navbar-default\\\"><ul class=\\\"nav navbar-nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#component-code\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"general.code\\\" id=\\\"component-code-tab\\\">Code</a></li><li><a href=\\\"#component-config-schema\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_component_config_schema\\\" id=\\\"component-config-schema-tab\\\">Config Schema</a></li><li><a href=\\\"#component-settings\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"play.settings\\\" id=\\\"component-settings-tab\\\">Settings</a></li><li><a href=\\\"#component-patches\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"resources.patches\\\" id=\\\"component-patches-tab\\\">Patches</a></li></ul><div class=\\\"navbar-header\\\"><span class=\\\"navbar-brand\\\">\" + (jade.escape(null == (jade.interp = editTitle) ? \"\" : jade.interp)) + \"</span></div><ul class=\\\"nav navbar-nav navbar-right\\\">\");\nif ( !component.hasWriteAccess())\n{\nbuf.push(\"<li id=\\\"patch-component-button\\\"><a data-i18n=\\\"[title]common.submit_patch\\\"><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\"><span class=\\\"glyphicon-chevron-down glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li data-i18n=\\\"common.actions\\\" class=\\\"dropdown-header\\\">Actions</li><li><a id=\\\"component-watch-button\\\"><span class=\\\"watch\\\"><span class=\\\"glyphicon glyphicon-eye-open\\\"></span><span data-i18n=\\\"common.watch\\\" class=\\\"spl\\\">Watch</span></span><span class=\\\"unwatch secret\\\"><span class=\\\"glyphicon glyphicon-eye-close\\\"></span><span data-i18n=\\\"common.unwatch\\\" class=\\\"spl\\\">Unwatch</span></span></a></li>\");\nif ( !me.get('anonymous'))\n{\nbuf.push(\"<li id=\\\"create-new-component-button\\\"><a data-i18n=\\\"editor.level_component_btn_new\\\">Create New Component</a></li><li><a data-i18n=\\\"editor.pop_i18n\\\" id=\\\"pop-component-i18n-button\\\">Populate i18n</a></li>\");\n}\nbuf.push(\"<li class=\\\"divider\\\"></li><li data-i18n=\\\"common.info\\\" class=\\\"dropdown-header\\\">Info</li><li id=\\\"component-history-button\\\"><a data-i18n=\\\"general.version_history\\\">Version History</a></li></ul></li></ul></nav><div class=\\\"tab-content\\\"><div id=\\\"component-code\\\" class=\\\"tab-pane active\\\"><div id=\\\"component-code-editor\\\"></div></div><div id=\\\"component-config-schema\\\" class=\\\"tab-pane\\\"><div id=\\\"config-schema-treema\\\"></div></div><div id=\\\"component-settings\\\" class=\\\"tab-pane\\\"><div id=\\\"edit-component-treema\\\"></div></div><div id=\\\"component-patches\\\" class=\\\"tab-pane\\\"><div class=\\\"patches-view\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"editor.new_component_title\\\">Create New Component</h3></div><div class=\\\"modal-body\\\"><form class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"level-component-system\\\" data-i18n=\\\"editor.new_component_field_system\\\" class=\\\"control-label\\\">System</label><select id=\\\"level-component-system\\\" name=\\\"system\\\" class=\\\"form-control\\\">\");\n// iterate view.systems\n;(function(){\n  var $$obj = view.systems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(system) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = system) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(system) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = system) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</select></div><div class=\\\"form-group\\\"><label for=\\\"level-component-name\\\" data-i18n=\\\"general.name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"level-component-name\\\" name=\\\"name\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button data-i18n=\\\"common.create\\\" id=\\\"new-level-component-submit\\\" class=\\\"btn btn-primary\\\">Create</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),components = locals_.components;buf.push(\"<table class=\\\"table components-table\\\"><tr><th colspan=\\\"3\\\">Results: \" + (jade.escape((jade.interp = components.length) == null ? '' : jade.interp)) + \"</th></tr><tr><th>Name</th><th>Description</th><th>Version</th><th></th></tr>\");\n// iterate components\n;(function(){\n  var $$obj = components;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = component.system + \".\" + component.name) ? \"\" : jade.interp)) + \"</td><td class=\\\"body-row\\\">\" + (jade.escape((jade.interp = component.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = component.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.version.minor) == null ? '' : jade.interp)) + \"</td><td><i\" + (jade.attrs({ 'data-system':(component.system), 'data-name':(component.name), \"class\": [('icon-pencil'),('edit-component-button')] }, {\"data-system\":true,\"data-name\":true})) + \"></i></td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = component.system + \".\" + component.name) ? \"\" : jade.interp)) + \"</td><td class=\\\"body-row\\\">\" + (jade.escape((jade.interp = component.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = component.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.version.minor) == null ? '' : jade.interp)) + \"</td><td><i\" + (jade.attrs({ 'data-system':(component.system), 'data-name':(component.name), \"class\": [('icon-pencil'),('edit-component-button')] }, {\"data-system\":true,\"data-name\":true})) + \"></i></td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me;buf.push(\"<div class=\\\"components-container\\\"><h3 data-i18n=\\\"editor.level_component_tab_title\\\">Current Components</h3><button type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#components-treema\\\" class=\\\"navbar-toggle toggle btn-primary\\\"><span class=\\\"icon-list\\\"></span></button><div class=\\\"editor-nano-container nano\\\"><div id=\\\"components-treema\\\" class=\\\"nano-content\\\"></div></div></div><div class=\\\"edit-component-container\\\">\");\nif ( !me.get('anonymous'))\n{\nbuf.push(\"<button id=\\\"create-new-component-button-no-select\\\" class=\\\"btn btn-primary\\\"><span class=\\\"icon-plus\\\"></span><span data-i18n=\\\"editor.level_component_btn_new\\\" class=\\\"text\\\">Create New Component</span></button>\");\n}\nbuf.push(\"<div id=\\\"level-component-edit-view\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),level = locals_.level,view = locals_.view,authorized = locals_.authorized,recentlyPlayedOpponents = locals_.recentlyPlayedOpponents,anonymous = locals_.anonymous,me = locals_.me;if ( level.loading)\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"level-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><div class=\\\"container-fluid\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/editor/level\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul></div></nav>\");\n}\nelse\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"level-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/editor/level\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul><ul class=\\\"nav navbar-nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#thangs-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_thangs\\\">Thangs</a></li><li><a href=\\\"#editor-level-scripts-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_scripts\\\">Scripts</a></li><li><a href=\\\"#editor-level-settings-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"play.settings\\\">Settings</a></li><li><a href=\\\"#editor-level-components-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_components\\\" id=\\\"components-tab\\\">Components</a></li><li><a href=\\\"#systems-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_systems\\\">Systems</a></li><li><a href=\\\"#editor-level-tasks-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_tasks\\\" id=\\\"tasks-tab\\\">\" + (jade.escape(null == (jade.interp = \"Tasks\" + \" \" + view.getTaskCompletionRatio()) ? \"\" : jade.interp)) + \"</a></li><li><a href=\\\"#editor-level-patches\\\" data-toggle=\\\"tab\\\" id=\\\"patches-tab\\\"><span data-i18n=\\\"resources.patches\\\" class=\\\"spr\\\">Patches</span>\");\nvar patches = level.get('patches')\nif ( patches && patches.length)\n{\nbuf.push(\"<span class=\\\"badge\\\">\" + (jade.escape(null == (jade.interp = patches.length) ? \"\" : jade.interp)) + \"</span>\");\n}\nbuf.push(\"</a></li><li><a href=\\\"#related-achievements-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"user.achievements_title\\\">Achievements</a></li><li><a href=\\\"#editor-level-documentation\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_docs\\\">Documentation</a></li><li><a href=\\\"#level-feedback-view\\\" data-toggle=\\\"tab\\\"><div class=\\\"glyphicon glyphicon-star\\\"></div></a></li></ul><div class=\\\"navbar-header\\\"><span class=\\\"navbar-brand\\\">\" + (jade.escape((jade.interp = level.attributes.name) == null ? '' : jade.interp)) + \"<span id=\\\"completion-rate\\\" class=\\\"spl\\\"></span></span></div><ul class=\\\"nav navbar-nav navbar-right\\\"><li id=\\\"undo-button\\\"><a><span class=\\\"glyphicon-arrow-left glyphicon\\\"></span></a></li><li id=\\\"redo-button\\\"><a><span class=\\\"glyphicon-arrow-right glyphicon\\\"></span></a></li><li id=\\\"artisan-guide-button\\\"><a><span class=\\\"glyphicon-book glyphicon\\\"></span></a></li>\");\nif ( authorized)\n{\nbuf.push(\"<li id=\\\"commit-level-start-button\\\"><a><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nelse\n{\nbuf.push(\"<li id=\\\"level-patch-button\\\"><a><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nif ( level.isType('ladder'))\n{\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\" class=\\\"play-with-team-parent\\\"><span class=\\\"glyphicon-play glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li class=\\\"dropdown-header\\\">Play As Which Team?</li><li>\");\n// iterate ['humans', 'ogres']\n;(function(){\n  var $$obj = ['humans', 'ogres'];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var team = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-team':(team), \"class\": [('play-with-team-button')] }, {\"data-team\":true})) + \">\" + (jade.escape(null == (jade.interp = team + ' vs. AI') ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var team = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-team':(team), \"class\": [('play-with-team-button')] }, {\"data-team\":true})) + \">\" + (jade.escape(null == (jade.interp = team + ' vs. AI') ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  }\n}).call(this);\n\n// iterate recentlyPlayedOpponents\n;(function(){\n  var $$obj = recentlyPlayedOpponents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var match = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-team':(match.yourTeam), 'data-opponent':(match.opponentSessionID), \"class\": [('play-with-team-button')] }, {\"data-team\":true,\"data-opponent\":true})) + \">\" + (jade.escape(null == (jade.interp = match.yourTeam + ' vs. ' + match.opponentName) ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var match = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-team':(match.yourTeam), 'data-opponent':(match.opponentSessionID), \"class\": [('play-with-team-button')] }, {\"data-team\":true,\"data-opponent\":true})) + \">\" + (jade.escape(null == (jade.interp = match.yourTeam + ' vs. ' + match.opponentName) ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</li></ul></li>\");\n}\nelse\n{\nbuf.push(\"<li data-i18n=\\\"[title]general.play_preview\\\" title=\\\"Play preview of current level\\\" id=\\\"play-button\\\"><a><span class=\\\"glyphicon-play glyphicon\\\"></span></a></li>\");\n}\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\"><span class=\\\"glyphicon-chevron-down glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li data-i18n=\\\"common.actions\\\" class=\\\"dropdown-header\\\">Actions</li><li><a id=\\\"level-watch-button\\\"><span class=\\\"watch\\\"><span class=\\\"glyphicon glyphicon-eye-open\\\"></span><span data-i18n=\\\"common.watch\\\" class=\\\"spl\\\">Watch</span></span><span class=\\\"unwatch secret\\\"><span class=\\\"glyphicon glyphicon-eye-close\\\"></span><span data-i18n=\\\"common.unwatch\\\" class=\\\"spl\\\">Unwatch</span></span></a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-i18n=\\\"common.fork\\\" id=\\\"fork-start-button\\\">Fork</a></li>\");\nif ( me.isAdmin() || me.isArtisan())\n{\nbuf.push(\"<!-- DNT--><li><a id=\\\"save-branch\\\">Save/Stash Branch</a></li><li><a id=\\\"load-branch\\\">Load/Unstash Branch</a></li>\");\n}\nbuf.push(\"<li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a\" + (jade.attrs({ 'data-toggle':(\"coco-modal\"), 'data-target':(\"modal/RevertModal\"), 'data-i18n':(\"editor.revert\"), 'disabled':(anonymous), 'id':('revert-button') }, {\"data-toggle\":true,\"data-target\":true,\"data-i18n\":true,\"disabled\":true})) + \">Revert</a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a\" + (jade.attrs({ 'data-toggle':(\"coco-modal\"), 'data-target':(\"editor/level/modals/GenerateTerrainModal\"), 'data-i18n':(\"editor.generate_terrain\"), 'disabled':(anonymous), \"class\": [('generate-terrain-button')] }, {\"data-toggle\":true,\"data-target\":true,\"data-i18n\":true,\"disabled\":true})) + \">Generate Terrain</a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-i18n=\\\"editor.pop_i18n\\\" id=\\\"pop-level-i18n-button\\\">Populate i18n</a></li>\");\nif ( view.courseID)\n{\nbuf.push(\"<li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-classroom=\\\"classroom\\\" data-code-language=\\\"javascript\\\" class=\\\"play-classroom-level\\\">Play Classroom JavaScript</a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-classroom=\\\"classroom\\\" data-code-language=\\\"python\\\" class=\\\"play-classroom-level\\\">Play Classroom Python</a></li><li\" + (jade.attrs({ \"class\": [(anonymous ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-classroom=\\\"home\\\" data-code-language=\\\"\\\" class=\\\"play-classroom-level\\\">Play Home</a></li>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<li><a\" + (jade.attrs({ 'href':(\"/editor/verifier/\" + (level.get('slug')) + \"?dev=true\") }, {\"href\":true})) + \">Verifier</a></li>\");\n}\nbuf.push(\"<li class=\\\"divider\\\"></li><li data-i18n=\\\"common.info\\\" class=\\\"dropdown-header\\\">Info</li><li id=\\\"level-history-button\\\"><a href=\\\"#\\\" data-i18n=\\\"general.version_history\\\">Version History</a></li><li class=\\\"divider\\\"></li><li data-i18n=\\\"common.help\\\" class=\\\"dropdown-header\\\">Help</li><li><a href=\\\"https://github.com/codecombat/codecombat/wiki/Artisan-Home\\\" data-i18n=\\\"editor.wiki\\\" target=\\\"_blank\\\">Wiki</a></li><li><a href=\\\"https://coco-slack-invite.herokuapp.com/\\\" data-i18n=\\\"editor.live_chat\\\" target=\\\"_blank\\\">Live Chat</a></li><li><a href=\\\"http://discourse.codecombat.com/category/artisan\\\" data-i18n=\\\"nav.forum\\\" target=\\\"_blank\\\">Forum</a></li>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<li><a data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a></li>\");\n}\nbuf.push(\"</ul></li></ul></nav>\");\n}\nbuf.push(\"<div class=\\\"outer-content\\\"><div id=\\\"level-editor-tabs\\\" class=\\\"tab-content\\\"><div id=\\\"thangs-tab-view\\\" class=\\\"tab-pane active\\\"></div><div id=\\\"editor-level-scripts-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-level-settings-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-level-components-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"systems-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-level-tasks-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-level-patches\\\" class=\\\"tab-pane nano\\\"><div class=\\\"nano-content\\\"><div class=\\\"patches-view\\\"></div></div></div><div id=\\\"related-achievements-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-level-documentation\\\" class=\\\"tab-pane\\\"><div class=\\\"tab-content\\\"><ul class=\\\"nav nav-pills nav-justified\\\"><li><a href=\\\"#components-documentation-view\\\" data-toggle=\\\"pill\\\" data-i18n=\\\"resources.components\\\">Components</a></li><li><a href=\\\"#systems-documentation-view\\\" data-toggle=\\\"pill\\\" data-i18n=\\\"resources.systems\\\">Systems</a></li></ul><div id=\\\"components-documentation-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"systems-documentation-view\\\" class=\\\"tab-pane\\\"></div></div></div><div id=\\\"level-feedback-view\\\" class=\\\"tab-pane\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),averageRating = locals_.averageRating,totalRatings = locals_.totalRatings,allFeedback = locals_.allFeedback,moment = locals_.moment;buf.push(\"<h2>Average Rating: \" + (jade.escape((jade.interp = averageRating.toFixed(2)) == null ? '' : jade.interp)) + \", \" + (jade.escape((jade.interp = totalRatings) == null ? '' : jade.interp)) + \" ratings</h2><ul class=\\\"user-feedback-list list-group\\\">\");\n// iterate allFeedback\n;(function(){\n  var $$obj = allFeedback;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var feedback = $$obj[$index];\n\nbuf.push(\"<li class=\\\"list-group-item\\\">\");\n// iterate Array(feedback.rating)\n;(function(){\n  var $$obj = Array(feedback.rating);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star\\\"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star\\\"></div>\");\n    }\n\n  }\n}).call(this);\n\nif ( feedback.rating < 5)\n{\n// iterate Array(5 - feedback.rating)\n;(function(){\n  var $$obj = Array(5 - feedback.rating);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star-empty\\\"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star-empty\\\"></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"<span class=\\\"spl spr\\\">-</span><em>\" + (jade.escape(null == (jade.interp = moment(new Date(feedback.created)).fromNow()) ? \"\" : jade.interp)) + \"</em><span class=\\\"spl spr\\\">-</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (feedback.creator) + \"\") }, {\"href\":true})) + \"><strong>\" + (jade.escape(null == (jade.interp = feedback.creatorName || 'Anonymous') ? \"\" : jade.interp)) + \"</strong></a>\");\nif ( feedback.review)\n{\nbuf.push(\"<span class=\\\"spr\\\">:</span><span>\" + (jade.escape(null == (jade.interp = feedback.review) ? \"\" : jade.interp)) + \"</span>\");\n}\nbuf.push(\"</li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var feedback = $$obj[$index];\n\nbuf.push(\"<li class=\\\"list-group-item\\\">\");\n// iterate Array(feedback.rating)\n;(function(){\n  var $$obj = Array(feedback.rating);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star\\\"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star\\\"></div>\");\n    }\n\n  }\n}).call(this);\n\nif ( feedback.rating < 5)\n{\n// iterate Array(5 - feedback.rating)\n;(function(){\n  var $$obj = Array(5 - feedback.rating);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star-empty\\\"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<div class=\\\"glyphicon glyphicon-star-empty\\\"></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"<span class=\\\"spl spr\\\">-</span><em>\" + (jade.escape(null == (jade.interp = moment(new Date(feedback.created)).fromNow()) ? \"\" : jade.interp)) + \"</em><span class=\\\"spl spr\\\">-</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (feedback.creator) + \"\") }, {\"href\":true})) + \"><strong>\" + (jade.escape(null == (jade.interp = feedback.creatorName || 'Anonymous') ? \"\" : jade.interp)) + \"</strong></a>\");\nif ( feedback.review)\n{\nbuf.push(\"<span class=\\\"spr\\\">:</span><span>\" + (jade.escape(null == (jade.interp = feedback.review) ? \"\" : jade.interp)) + \"</span>\");\n}\nbuf.push(\"</li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Artisan Compendium</h3></div><div class=\\\"modal-body\\\"><p>Welcome to the Artisan Compendium. Below you will find a series of helpful guides and tutorials for getting your levels to Master Artisan quality\");\nif ( view.hasOwnership())\n{\nbuf.push(\", as well as a way to submit your level for official Artisan review\");\n}\nbuf.push(\"! If you have any feedback on the Level Editor, please contact us at: <a href=\\\"mailto:artisans@codecombat.com\\\">artisans@codecombat.com</a></p><div class=\\\"centered-stack\\\"><div><a href=\\\"https://github.com/codecombat/codecombat/wiki/Artisan-Home\\\" target=\\\"_blank\\\">Wiki Homepage</a></div><div><a href=\\\"https://github.com/codecombat/codecombat/wiki/Artisan-How-To-Index\\\" target=\\\"_blank\\\">Basic How-tos</a></div><div><a href=\\\"http://www.codecombat.com/community\\\" target=\\\"_blank\\\">Artisan Rankings</a></div></div>\");\nif ( view.hasOwnership())\n{\nbuf.push(\"<h4>Level Submission</h4><p>Do you want your level to be added to the campaign? Please take a moment to fill out the questions below! Dont worry, this isnt a timed quiz. It is just a way for the artisans at CodeCombat HQ to get a feel for the purpose of this level. If it doesnt quite yet meet our standards for release we will give you feedback to help polish it further!</p><div class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"credit-name\\\" class=\\\"control-label\\\">How would you like to be credited?</label><input id=\\\"credit-name\\\" name=\\\"creditName\\\" class=\\\"form-control\\\"/></div><div class=\\\"form-group\\\"><label for=\\\"level-purpose\\\" class=\\\"control-label\\\">What is the purpose of this level?</label><textarea id=\\\"level-purpose\\\" name=\\\"levelPurpose\\\" rows=\\\"4\\\" class=\\\"form-control\\\"></textarea></div><div class=\\\"form-group\\\"><label for=\\\"level-inspiration\\\" class=\\\"control-label\\\">What was the inspiration for the level?</label><textarea id=\\\"level-inspiration\\\" name=\\\"levelInspiration\\\" rows=\\\"4\\\" class=\\\"form-control\\\"></textarea></div><div class=\\\"form-group\\\"><label for=\\\"level-location\\\" class=\\\"control-label\\\">Where in the campaign do you think this level belongs?</label><textarea id=\\\"level-location\\\" name=\\\"levelLocation\\\" rows=\\\"4\\\" class=\\\"form-control\\\"></textarea></div></div>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><div><a href=\\\"#\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"btn\\\">Close</a>\");\nif ( view.hasOwnership())\n{\nbuf.push(\"<button id=\\\"level-submit\\\" class=\\\"btn btn-primary\\\">Submit</button>\");\n}\nbuf.push(\"</div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"editor.pick_a_terrain\\\">Pick a Terrain</h3></div><div class=\\\"modal-body\\\"><div id=\\\"normal-view\\\">\");\n// iterate view.presetSizes\n;(function(){\n  var $$obj = view.presetSizes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var size = 0, $$l = $$obj.length; size < $$l; size++) {\n      var sizeObject = $$obj[size];\n\n// iterate view.presets\n;(function(){\n  var $$obj = view.presets;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var preset = $$obj[$index];\n\nbuf.push(\"<a href=\\\"#\\\"><div\" + (jade.attrs({ 'data-preset-type':(preset.type), 'data-preset-size':(size), 'style':(\"background:url(/images/pages/editor/level/preset_\"+preset.type+\"_\"+size+\".jpg) no-repeat center; background-size: cover\"), \"class\": [('choose-option')] }, {\"data-preset-type\":true,\"data-preset-size\":true,\"style\":true})) + \"><div class=\\\"preset-size name-label capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+size) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = size) == null ? '' : jade.interp)) + \"</span></div><div class=\\\"preset-name capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+preset.type) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = preset.type) == null ? '' : jade.interp)) + \"</span></div></div></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var preset = $$obj[$index];\n\nbuf.push(\"<a href=\\\"#\\\"><div\" + (jade.attrs({ 'data-preset-type':(preset.type), 'data-preset-size':(size), 'style':(\"background:url(/images/pages/editor/level/preset_\"+preset.type+\"_\"+size+\".jpg) no-repeat center; background-size: cover\"), \"class\": [('choose-option')] }, {\"data-preset-type\":true,\"data-preset-size\":true,\"style\":true})) + \"><div class=\\\"preset-size name-label capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+size) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = size) == null ? '' : jade.interp)) + \"</span></div><div class=\\\"preset-name capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+preset.type) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = preset.type) == null ? '' : jade.interp)) + \"</span></div></div></a>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  } else {\n    var $$l = 0;\n    for (var size in $$obj) {\n      $$l++;      var sizeObject = $$obj[size];\n\n// iterate view.presets\n;(function(){\n  var $$obj = view.presets;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var preset = $$obj[$index];\n\nbuf.push(\"<a href=\\\"#\\\"><div\" + (jade.attrs({ 'data-preset-type':(preset.type), 'data-preset-size':(size), 'style':(\"background:url(/images/pages/editor/level/preset_\"+preset.type+\"_\"+size+\".jpg) no-repeat center; background-size: cover\"), \"class\": [('choose-option')] }, {\"data-preset-type\":true,\"data-preset-size\":true,\"style\":true})) + \"><div class=\\\"preset-size name-label capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+size) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = size) == null ? '' : jade.interp)) + \"</span></div><div class=\\\"preset-name capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+preset.type) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = preset.type) == null ? '' : jade.interp)) + \"</span></div></div></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var preset = $$obj[$index];\n\nbuf.push(\"<a href=\\\"#\\\"><div\" + (jade.attrs({ 'data-preset-type':(preset.type), 'data-preset-size':(size), 'style':(\"background:url(/images/pages/editor/level/preset_\"+preset.type+\"_\"+size+\".jpg) no-repeat center; background-size: cover\"), \"class\": [('choose-option')] }, {\"data-preset-type\":true,\"data-preset-size\":true,\"style\":true})) + \"><div class=\\\"preset-size name-label capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+size) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = size) == null ? '' : jade.interp)) + \"</span></div><div class=\\\"preset-name capitalize\\\"><span\" + (jade.attrs({ 'data-i18n':(\"editor.\"+preset.type) }, {\"data-i18n\":true})) + \">\" + (jade.escape((jade.interp = preset.type) == null ? '' : jade.interp)) + \"</span></div></div></a>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"clearfix\\\"></div></div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,moment = locals_.moment;buf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content style-flat\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Load Branch</h3></div><div class=\\\"modal-body\\\"><div class=\\\"container-fluid\\\"><div class=\\\"row\\\"><div class=\\\"col-sm-2\\\"><div id=\\\"branches-list-group\\\" class=\\\"list-group\\\">\");\n// iterate view.branches.models\n;(function(){\n  var $$obj = view.branches.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var i = 0, $$l = $$obj.length; i < $$l; i++) {\n      var branch = $$obj[i];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-branch-cid':(branch.cid), \"class\": [('list-group-item'),((i == 0 ? 'active' : ''))] }, {\"class\":true,\"data-branch-cid\":true})) + \"><span class=\\\"delete-branch-btn glyphicon glyphicon-remove pull-right\\\"></span>\" + (jade.escape(null == (jade.interp = branch.get('name')) ? \"\" : jade.interp)) + \"<div class=\\\"small\\\"><i>\" + (jade.escape(null == (jade.interp = branch.get('updatedByName')) ? \"\" : jade.interp)) + \"</i><br/><span>\" + (jade.escape(null == (jade.interp = moment(branch.get('updated')).format('lll')) ? \"\" : jade.interp)) + \"</span></div></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var i in $$obj) {\n      $$l++;      var branch = $$obj[i];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-branch-cid':(branch.cid), \"class\": [('list-group-item'),((i == 0 ? 'active' : ''))] }, {\"class\":true,\"data-branch-cid\":true})) + \"><span class=\\\"delete-branch-btn glyphicon glyphicon-remove pull-right\\\"></span>\" + (jade.escape(null == (jade.interp = branch.get('name')) ? \"\" : jade.interp)) + \"<div class=\\\"small\\\"><i>\" + (jade.escape(null == (jade.interp = branch.get('updatedByName')) ? \"\" : jade.interp)) + \"</i><br/><span>\" + (jade.escape(null == (jade.interp = moment(branch.get('updated')).format('lll')) ? \"\" : jade.interp)) + \"</span></div></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div><div id=\\\"selected-branch-col\\\" class=\\\"col-sm-10\\\">\");\nif ( view.selectedBranch)\n{\nbuf.push(\"<div class=\\\"container-fluid\\\"><div class=\\\"row\\\"><div class=\\\"col-sm-6\\\"><h2>Original Changes</h2></div><div class=\\\"col-sm-6\\\"><h2>Resulting Changes if Loaded</h2></div></div>\");\n// iterate view.selectedBranch.get('patches')\n;(function(){\n  var $$obj = view.selectedBranch.get('patches');\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var patch = $$obj[$index];\n\nbuf.push(\"<hr/><h4>\" + (jade.escape(null == (jade.interp = patch.postLoadChange.get('name')) ? \"\" : jade.interp)));\nif ( patch.modelHasChangedSincePatchCreated)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-warning\\\">Document has changed since patch was created</i>\");\n}\nif ( patch.currentModelHasLocalChanges)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-danger\\\">Local Changes Will Be Overwritten</i>\");\n}\nif ( !patch.applied)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-danger\\\">Patch could not be applied</i>\");\n}\nbuf.push(\"</h4><div class=\\\"row\\\"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('col-sm-6')] }, {\"data-patch-id\":true})) + \"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), 'data-prop':(\"original-change\"), \"class\": [('changes-stub')] }, {\"data-patch-id\":true,\"data-prop\":true})) + \"></div></div><div\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('col-sm-6')] }, {\"data-patch-id\":true})) + \"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), 'data-prop':(\"post-load-change\"), \"class\": [('changes-stub')] }, {\"data-patch-id\":true,\"data-prop\":true})) + \"></div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var patch = $$obj[$index];\n\nbuf.push(\"<hr/><h4>\" + (jade.escape(null == (jade.interp = patch.postLoadChange.get('name')) ? \"\" : jade.interp)));\nif ( patch.modelHasChangedSincePatchCreated)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-warning\\\">Document has changed since patch was created</i>\");\n}\nif ( patch.currentModelHasLocalChanges)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-danger\\\">Local Changes Will Be Overwritten</i>\");\n}\nif ( !patch.applied)\n{\nbuf.push((jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"<i class=\\\"label label-danger\\\">Patch could not be applied</i>\");\n}\nbuf.push(\"</h4><div class=\\\"row\\\"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('col-sm-6')] }, {\"data-patch-id\":true})) + \"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), 'data-prop':(\"original-change\"), \"class\": [('changes-stub')] }, {\"data-patch-id\":true,\"data-prop\":true})) + \"></div></div><div\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('col-sm-6')] }, {\"data-patch-id\":true})) + \"><div\" + (jade.attrs({ 'data-patch-id':(patch.id), 'data-prop':(\"post-load-change\"), \"class\": [('changes-stub')] }, {\"data-patch-id\":true,\"data-prop\":true})) + \"></div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div></div></div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button id=\\\"unstash-branch-btn\\\" class=\\\"btn btn-primary\\\">Unstash Branch</button><button id=\\\"load-branch-btn\\\" class=\\\"btn btn-primary\\\">Load Branch</button></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3\" + (jade.attrs({ 'data-i18n':(\"\" + (view.newModelTitle) + \"\") }, {\"data-i18n\":true})) + \">Create New \" + (jade.escape((jade.interp = view.modelLabel) == null ? '' : jade.interp)) + \"</h3></div><div class=\\\"modal-body\\\"><form class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"name\\\" data-i18n=\\\"general.name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"name\\\" name=\\\"name\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div><div class=\\\"form-group\\\"><label for=\\\"description\\\" data-i18n=\\\"general.description\\\" class=\\\"control-label\\\">Description</label><input id=\\\"description\\\" name=\\\"description\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div><h4 data-i18n=\\\"editor.achievement_query_misc\\\">Key achievement off of miscellanea</h4><div class=\\\"radio\\\"><label><input type=\\\"checkbox\\\" name=\\\"queryOptions\\\" id=\\\"misc-level-completion\\\" value=\\\"misc-level-completion\\\"/><span data-i18n=\\\"editor.level_completion\\\" class=\\\"spl\\\">Level Completion</span></label></div>\");\nvar goals = view.level.get('goals');\nif ( goals && goals.length)\n{\nbuf.push(\"<h4 data-i18n=\\\"editor.achievement_query_goals\\\">Key achievement off of level goals</h4>\");\n// iterate goals\n;(function(){\n  var $$obj = goals;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var goal = $$obj[$index];\n\nbuf.push(\"<div class=\\\"radio\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'name':(\"queryOptions\"), 'id':(\"\" + (goal.id) + \"\"), 'value':(\"\" + (goal.id) + \"\") }, {\"type\":true,\"name\":true,\"id\":true,\"value\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = goal.name) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var goal = $$obj[$index];\n\nbuf.push(\"<div class=\\\"radio\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'name':(\"queryOptions\"), 'id':(\"\" + (goal.id) + \"\"), 'value':(\"\" + (goal.id) + \"\") }, {\"type\":true,\"name\":true,\"id\":true,\"value\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = goal.name) ? \"\" : jade.interp)) + \"</span></label></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button id=\\\"save-new-achievement-link\\\" data-i18n=\\\"common.create\\\" class=\\\"btn btn-primary new-model-submit\\\">Create</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,moment = locals_.moment;buf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content style-flat\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Save Branch</h3></div><div class=\\\"modal-body\\\"><div class=\\\"container-fluid\\\"><div class=\\\"row\\\"><div class=\\\"col-sm-2\\\"><div id=\\\"branches-list-group\\\" class=\\\"list-group\\\"><a\" + (jade.attrs({ \"class\": [('list-group-item'),((view.selectedBranch ? '' : 'active'))] }, {\"class\":true})) + \"><i>New Branch</i><input id=\\\"new-branch-name-input\\\" placeholder=\\\"Name\\\" class=\\\"form-control\\\"/></a>\");\n// iterate view.branches.models\n;(function(){\n  var $$obj = view.branches.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var branch = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-branch-cid':(branch.cid), \"class\": [('list-group-item'),((view.selectedBranch == branch ? 'active': ''))] }, {\"class\":true,\"data-branch-cid\":true})) + \"><span class=\\\"delete-branch-btn glyphicon glyphicon-remove pull-right\\\"></span>\" + (jade.escape(null == (jade.interp = branch.get('name')) ? \"\" : jade.interp)) + \"<div class=\\\"small\\\"><i>\" + (jade.escape(null == (jade.interp = branch.get('updatedByName')) ? \"\" : jade.interp)) + \"</i><br/><span>\" + (jade.escape(null == (jade.interp = moment(branch.get('updated')).format('lll')) ? \"\" : jade.interp)) + \"</span></div></a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var branch = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-branch-cid':(branch.cid), \"class\": [('list-group-item'),((view.selectedBranch == branch ? 'active': ''))] }, {\"class\":true,\"data-branch-cid\":true})) + \"><span class=\\\"delete-branch-btn glyphicon glyphicon-remove pull-right\\\"></span>\" + (jade.escape(null == (jade.interp = branch.get('name')) ? \"\" : jade.interp)) + \"<div class=\\\"small\\\"><i>\" + (jade.escape(null == (jade.interp = branch.get('updatedByName')) ? \"\" : jade.interp)) + \"</i><br/><span>\" + (jade.escape(null == (jade.interp = moment(branch.get('updated')).format('lll')) ? \"\" : jade.interp)) + \"</span></div></a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div><div class=\\\"col-sm-5\\\"><h2>Changes from Prod</h2>\");\n// iterate view.componentsWithChanges.models\n;(function(){\n  var $$obj = view.componentsWithChanges.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<h4 class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'data-component-id':(component.id), 'checked':(true), \"class\": [('component-checkbox')] }, {\"type\":true,\"data-component-id\":true,\"checked\":true})) + \"/>\" + (jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"Component: \" + (jade.escape((jade.interp = component.get('system')) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \"</label></h4><div\" + (jade.attrs({ 'data-component-id':(component.id), \"class\": [('component-changes-stub')] }, {\"data-component-id\":true})) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<h4 class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'data-component-id':(component.id), 'checked':(true), \"class\": [('component-checkbox')] }, {\"type\":true,\"data-component-id\":true,\"checked\":true})) + \"/>\" + (jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"Component: \" + (jade.escape((jade.interp = component.get('system')) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \"</label></h4><div\" + (jade.attrs({ 'data-component-id':(component.id), \"class\": [('component-changes-stub')] }, {\"data-component-id\":true})) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\n// iterate view.systemsWithChanges.models\n;(function(){\n  var $$obj = view.systemsWithChanges.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<h4 class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'data-system-id':(system.id), 'checked':(true), \"class\": [('system-checkbox')] }, {\"type\":true,\"data-system-id\":true,\"checked\":true})) + \"/>\" + (jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"System: \" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</label></h4><div\" + (jade.attrs({ 'data-system-id':(system.id), \"class\": [('system-changes-stub')] }, {\"data-system-id\":true})) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<h4 class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'data-system-id':(system.id), 'checked':(true), \"class\": [('system-checkbox')] }, {\"type\":true,\"data-system-id\":true,\"checked\":true})) + \"/>\" + (jade.escape(null == (jade.interp = \" \") ? \"\" : jade.interp)) + \"System: \" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</label></h4><div\" + (jade.attrs({ 'data-system-id':(system.id), \"class\": [('system-changes-stub')] }, {\"data-system-id\":true})) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div><div id=\\\"selected-branch-col\\\" class=\\\"col-sm-5\\\">\");\nif ( view.selectedBranch)\n{\nbuf.push(\"<h2>Changes from Branch</h2>\");\n// iterate view.selectedBranch.components.models\n;(function(){\n  var $$obj = view.selectedBranch.components.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nbuf.push(\"<h4>Component: \" + (jade.escape((jade.interp = component.get('system')) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \"</h4><div\" + (jade.attrs({ 'data-component-id':(component.id), \"class\": [('component-changes-stub')] }, {\"data-component-id\":true})) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nbuf.push(\"<h4>Component: \" + (jade.escape((jade.interp = component.get('system')) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = component.get('name')) == null ? '' : jade.interp)) + \"</h4><div\" + (jade.attrs({ 'data-component-id':(component.id), \"class\": [('component-changes-stub')] }, {\"data-component-id\":true})) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\n// iterate view.selectedBranch.systems.models\n;(function(){\n  var $$obj = view.selectedBranch.systems.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<h4>System: \" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</h4><div\" + (jade.attrs({ 'data-system-id':(system.id), \"class\": [('system-changes-stub')] }, {\"data-system-id\":true})) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<h4>System: \" + (jade.escape((jade.interp = system.get('name')) == null ? '' : jade.interp)) + \"</h4><div\" + (jade.attrs({ 'data-system-id':(system.id), \"class\": [('system-changes-stub')] }, {\"data-system-id\":true})) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nelse\n{\nbuf.push(\"<h2>New Branch</h2>\");\n}\nbuf.push(\"</div></div></div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button id=\\\"stash-branch-btn\\\" class=\\\"btn btn-primary\\\">Stash Branch</button><button id=\\\"save-branch-btn\\\" class=\\\"btn btn-primary\\\">Save Branch</button></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,selectingPoint = locals_.selectingPoint,flexibleRegion = locals_.flexibleRegion;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3> \");\nif ( selectingPoint)\n{\nbuf.push(\"Select Point\");\n}\nelse\n{\nbuf.push(\"Select Region\");\n}\nbuf.push(\"</h3></div><div class=\\\"modal-body\\\"><div class=\\\"instructions\\\"><div class=\\\"alert alert-info\\\"> <strong>Click</strong> to pan</div><div class=\\\"alert alert-info\\\"> <strong>Scroll</strong> to zoom</div>\");\nif ( selectingPoint)\n{\nbuf.push(\"<div class=\\\"alert alert-info\\\"><strong>Shift-click </strong> to select</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"alert alert-info\\\"><strong>Shift-drag</strong> to select</div>\");\n}\nif ( flexibleRegion)\n{\nbuf.push(\"<div class=\\\"alert alert-info\\\"><strong>Alt-shift-drag</strong> to select ratio</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"alert alert-info\\\"><strong>Enter</strong> to confirm</div>\");\n}\nbuf.push(\"</div><div class=\\\"canvas-wrapper\\\"><canvas width=\\\"924\\\" height=\\\"589\\\" class=\\\"webgl-canvas\\\"></canvas><canvas width=\\\"924\\\" height=\\\"589\\\" class=\\\"normal-canvas\\\"></canvas></div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><a id=\\\"done-button\\\" class=\\\"btn btn-primary\\\">Done</a></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me,view = locals_.view;buf.push(\"<div class=\\\"nano editor-nano-container\\\"><div class=\\\"nano-content\\\"><button\" + (jade.attrs({ 'id':('new-achievement-button'), 'disabled':((me.isAdmin() === true || me.isArtisan() === true) ? undefined : \"true\"), 'data-i18n':(\"editor.new_achievement_title\"), \"class\": [('btn'),('btn-primary')] }, {\"disabled\":true,\"data-i18n\":true})) + \">Create a New Achievement</button>\");\nif ( !view.achievements.models.length)\n{\nbuf.push(\"<div class=\\\"panel\\\"><div class=\\\"panel-body\\\"><p data-i18n=\\\"editor.no_achievements\\\">No achievements added for this level yet.</p></div></div>\");\n}\nelse\n{\nbuf.push(\"<table class=\\\"table table-hover\\\"><thead><tr><th></th><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th>XP</th></tr></thead><tbody>\");\n// iterate view.achievements.models\n;(function(){\n  var $$obj = view.achievements.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var achievement = $$obj[$index];\n\nbuf.push(\"<tr><td style=\\\"width: 20px\\\"><img\" + (jade.attrs({ 'src':(achievement.getImageURL()), 'alt':(\"#{achievement.get('name') icon\"), \"class\": [('achievement-icon-small')] }, {\"src\":true,\"alt\":true})) + \"/></td><td><a\" + (jade.attrs({ 'href':(\"/editor/achievement/\" + (achievement.get('slug')) + \"\") }, {\"href\":true})) + \">\" + (jade.escape(null == (jade.interp = achievement.get('name', true)) ? \"\" : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = achievement.get('description', true)) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = achievement.get('worth', true)) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var achievement = $$obj[$index];\n\nbuf.push(\"<tr><td style=\\\"width: 20px\\\"><img\" + (jade.attrs({ 'src':(achievement.getImageURL()), 'alt':(\"#{achievement.get('name') icon\"), \"class\": [('achievement-icon-small')] }, {\"src\":true,\"alt\":true})) + \"/></td><td><a\" + (jade.attrs({ 'href':(\"/editor/achievement/\" + (achievement.get('slug')) + \"\") }, {\"href\":true})) + \">\" + (jade.escape(null == (jade.interp = achievement.get('name', true)) ? \"\" : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = achievement.get('description', true)) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = achievement.get('worth', true)) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"</div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,level = locals_.level,levelNeedsSave = locals_.levelNeedsSave,modifiedComponents = locals_.modifiedComponents,modifiedSystems = locals_.modifiedSystems,me = locals_.me,_ = locals_._;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nif ( view.isPatch)\n{\nbuf.push(\"<h3 data-i18n=\\\"common.submit_patch\\\">Submit Patch</h3>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"versions.save_version_title\\\">Save New Version</h3>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body\\\"><h3><span data-i18n=\\\"resources.level\\\">Level</span><span>\" + (jade.escape(null == (jade.interp = \": \" + level.get('name') + \" - \") ? \"\" : jade.interp)) + \"</span>\");\nif ( levelNeedsSave)\n{\nbuf.push(\"<span data-i18n=\\\"delta.modified\\\">Modified</span>\");\n}\nelse\n{\nbuf.push(\"<span data-i18n=\\\"delta.not_modified\\\">Not Modified</span>\");\n}\nbuf.push(\"</h3>\");\nif ( levelNeedsSave)\n{\nbuf.push(\"<div class=\\\"changes-stub\\\"></div><form id=\\\"save-level-form\\\" class=\\\"form-inline\\\"><div class=\\\"form-group commit-message\\\"><input id=\\\"level-commit-message\\\" name=\\\"commit-message\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div>\");\nif ( level.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input id=\\\"level-version-is-major\\\" name=\\\"version-is-major\\\" type=\\\"checkbox\\\"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nif ( !level.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input id=\\\"level-publish\\\" name=\\\"publish\\\" type=\\\"checkbox\\\"/><span data-i18n=\\\"common.publish\\\">Publish</span></label></div>\");\n}\nbuf.push(\"</form>\");\n}\nif ( modifiedComponents.length)\n{\nbuf.push(\"<hr/>\");\n}\n// iterate modifiedComponents\n;(function(){\n  var $$obj = modifiedComponents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var component = $$obj[$index];\n\nvar id = component.get('_id')\nbuf.push(\"<h4><span data-i18n=\\\"resources.component\\\">Component</span><span>\" + (jade.escape(null == (jade.interp = \": \" + component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</span></h4><div class=\\\"changes-stub\\\"></div><form\" + (jade.attrs({ 'id':(\"save-component-\" + id + \"-form\"), \"class\": [('form-inline'),('component-form')] }, {\"id\":true})) + \"><input\" + (jade.attrs({ 'name':(\"component-original\"), 'type':(\"hidden\"), 'value':(component.get('original')) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'name':(\"component-parent-major-version\"), 'type':(\"hidden\"), 'value':(component.get('version').major) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><div class=\\\"form-group commit-message\\\"><input\" + (jade.attrs({ 'id':(id + \"-commit-message\"), 'name':(\"commit-message\"), 'type':(\"text\"), \"class\": [('form-control')] }, {\"id\":true,\"name\":true,\"type\":true})) + \"/></div>\");\nif ( component.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'id':(id + \"-version-is-major\"), 'name':(\"version-is-major\"), 'type':(\"checkbox\") }, {\"id\":true,\"name\":true,\"type\":true})) + \"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nbuf.push(\"</form>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var component = $$obj[$index];\n\nvar id = component.get('_id')\nbuf.push(\"<h4><span data-i18n=\\\"resources.component\\\">Component</span><span>\" + (jade.escape(null == (jade.interp = \": \" + component.get('system') + '.' + component.get('name')) ? \"\" : jade.interp)) + \"</span></h4><div class=\\\"changes-stub\\\"></div><form\" + (jade.attrs({ 'id':(\"save-component-\" + id + \"-form\"), \"class\": [('form-inline'),('component-form')] }, {\"id\":true})) + \"><input\" + (jade.attrs({ 'name':(\"component-original\"), 'type':(\"hidden\"), 'value':(component.get('original')) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'name':(\"component-parent-major-version\"), 'type':(\"hidden\"), 'value':(component.get('version').major) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><div class=\\\"form-group commit-message\\\"><input\" + (jade.attrs({ 'id':(id + \"-commit-message\"), 'name':(\"commit-message\"), 'type':(\"text\"), \"class\": [('form-control')] }, {\"id\":true,\"name\":true,\"type\":true})) + \"/></div>\");\nif ( component.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'id':(id + \"-version-is-major\"), 'name':(\"version-is-major\"), 'type':(\"checkbox\") }, {\"id\":true,\"name\":true,\"type\":true})) + \"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nbuf.push(\"</form>\");\n    }\n\n  }\n}).call(this);\n\nif ( modifiedSystems.length)\n{\nbuf.push(\"<hr/>\");\n}\n// iterate modifiedSystems\n;(function(){\n  var $$obj = modifiedSystems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nvar id = system.get('_id')\nbuf.push(\"<h4><span data-i18n=\\\"resources.system\\\">System</span><span>\" + (jade.escape(null == (jade.interp = \": \" + system.get('name')) ? \"\" : jade.interp)) + \"</span></h4><div class=\\\"changes-stub\\\"></div><form\" + (jade.attrs({ 'id':(\"save-system-\" + id + \"-form\"), \"class\": [('form-inline'),('system-form')] }, {\"id\":true})) + \"><input\" + (jade.attrs({ 'name':(\"system-original\"), 'type':(\"hidden\"), 'value':(system.get('original')) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'name':(\"system-parent-major-version\"), 'type':(\"hidden\"), 'value':(system.get('version').major) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><div class=\\\"form-group commit-message\\\"><input\" + (jade.attrs({ 'id':(id + \"-commit-message\"), 'name':(\"commit-message\"), 'type':(\"text\"), 'placeholder':(\"Commit Message\"), \"class\": [('form-control')] }, {\"id\":true,\"name\":true,\"type\":true,\"placeholder\":true})) + \"/></div>\");\nif ( system.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'id':(id + \"-version-is-major\"), 'name':(\"version-is-major\"), 'type':(\"checkbox\") }, {\"id\":true,\"name\":true,\"type\":true})) + \"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nbuf.push(\"</form>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nvar id = system.get('_id')\nbuf.push(\"<h4><span data-i18n=\\\"resources.system\\\">System</span><span>\" + (jade.escape(null == (jade.interp = \": \" + system.get('name')) ? \"\" : jade.interp)) + \"</span></h4><div class=\\\"changes-stub\\\"></div><form\" + (jade.attrs({ 'id':(\"save-system-\" + id + \"-form\"), \"class\": [('form-inline'),('system-form')] }, {\"id\":true})) + \"><input\" + (jade.attrs({ 'name':(\"system-original\"), 'type':(\"hidden\"), 'value':(system.get('original')) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'name':(\"system-parent-major-version\"), 'type':(\"hidden\"), 'value':(system.get('version').major) }, {\"name\":true,\"type\":true,\"value\":true})) + \"/><div class=\\\"form-group commit-message\\\"><input\" + (jade.attrs({ 'id':(id + \"-commit-message\"), 'name':(\"commit-message\"), 'type':(\"text\"), 'placeholder':(\"Commit Message\"), \"class\": [('form-control')] }, {\"id\":true,\"name\":true,\"type\":true,\"placeholder\":true})) + \"/></div>\");\nif ( system.isPublished())\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'id':(id + \"-version-is-major\"), 'name':(\"version-is-major\"), 'type':(\"checkbox\") }, {\"id\":true,\"name\":true,\"type\":true})) + \"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nbuf.push(\"</form>\");\n    }\n\n  }\n}).call(this);\n\nif ( me.isAdmin())\n{\nbuf.push(\"<div id=\\\"verifier-stub\\\"><h3>Verifying...</h3><div id=\\\"verifier-tests\\\">\");\n// iterate ['waiting', 'running', 'problems', 'failed', 'passedExceptFrames', 'passed']\n;(function(){\n  var $$obj = ['waiting', 'running', 'problems', 'failed', 'passedExceptFrames', 'passed'];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var state = $$obj[$index];\n\nbuf.push(\"<span\" + (jade.attrs({ 'style':(view[state] ? \"font-weight: bold\" : \"\") }, {\"style\":true})) + \"> \" + (jade.escape((jade.interp = _.string.humanize(state)) == null ? '' : jade.interp)) + \": \" + (jade.escape((jade.interp = view[state]) == null ? '' : jade.interp)) + \" |</span>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var state = $$obj[$index];\n\nbuf.push(\"<span\" + (jade.attrs({ 'style':(view[state] ? \"font-weight: bold\" : \"\") }, {\"style\":true})) + \"> \" + (jade.escape((jade.interp = _.string.humanize(state)) == null ? '' : jade.interp)) + \": \" + (jade.escape((jade.interp = view[state]) == null ? '' : jade.interp)) + \" |</span>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<span>\" + (jade.escape(null == (jade.interp = ' ') ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/editor/verifier/\" + (level.get('slug')) + \"?dev=true\"), 'target':(\"_blank\") }, {\"href\":true,\"target\":true})) + \">Details</a></div></div>\");\n}\nbuf.push(\"<div id=\\\"errors-wrapper\\\" class=\\\"alert alert-danger hide\\\"><strong>Validation Error! Save failed.</strong><p class=\\\"errors\\\"></p></div></div><div class=\\\"modal-body wait secret\\\">\");\nif ( view.hasChanges)\n{\nif ( view.isPatch)\n{\nbuf.push(\"<h3 data-i18n=\\\"versions.submitting_patch\\\">Submitting Patch...</h3>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"common.saving\\\">Saving...</h3>\");\n}\n}\nbuf.push(\"<div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\">\");\nif ( view.hasChanges)\n{\nbuf.push(\"<div id=\\\"accept-cla-wrapper\\\" class=\\\"alert alert-info\\\"><span data-i18n=\\\"versions.cla_prefix\\\" class=\\\"spr\\\">To save changes, first you must agree to our</span><strong id=\\\"cla-link\\\" data-i18n=\\\"versions.cla_url\\\">CLA</strong><span data-i18n=\\\"versions.cla_suffix\\\"></span><button id=\\\"agreement-button\\\" data-i18n=\\\"versions.cla_agree\\\" class=\\\"btn btn-sm\\\">I AGREE</button></div>\");\nif ( view.isPatch)\n{\nbuf.push(\"<div data-i18n=\\\"versions.owner_approve\\\" class=\\\"alert alert-info\\\">An owner will need to approve it before your changes will become visible.</div>\");\n}\nbuf.push(\"<div class=\\\"save-error-area\\\">\");\nif ( view.savingPatchError)\n{\nbuf.push(\"<div class=\\\"alert alert-danger\\\">Unable to save patch: \" + (jade.escape((jade.interp = view.savingPatchError) == null ? '' : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"<div class=\\\"buttons\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button>\");\nif ( view.hasChanges && !view.isPatch)\n{\nbuf.push(\"<button id=\\\"save-version-button\\\" data-i18n=\\\"common.save\\\" class=\\\"btn btn-primary\\\">Save</button>\");\n}\nif ( view.hasChanges && view.isPatch)\n{\nbuf.push(\"<button id=\\\"submit-patch-button\\\" data-i18n=\\\"common.submit_patch\\\" class=\\\"btn btn-primary\\\">Submit Patch</button>\");\n}\nbuf.push(\"</div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<button type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#scripts-treema\\\" class=\\\"navbar-toggle toggle btn-primary\\\"><span class=\\\"icon-list\\\"></span></button><div class=\\\"editor-nano-container nano\\\"><div id=\\\"scripts-treema\\\" class=\\\"nano-content\\\"></div></div><div class=\\\"editor-nano-container nano\\\"><div id=\\\"script-treema\\\" class=\\\"nano-content\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<div class=\\\"editor-nano-container nano\\\"><div id=\\\"settings-treema\\\" class=\\\"nano-content\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"editor.add_system_title\\\">Add Systems to Level</h3></div><div class=\\\"modal-body\\\"><ul class=\\\"available-systems-list\\\"></ul></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"editor.done_adding\\\" class=\\\"btn btn-primary\\\">Done Adding</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),system = locals_.system;buf.push(\"<li\" + (jade.attrs({ 'title':(\"\" + (system.description) + \"\"), 'data-system-id':(\"\" + (system._id) + \"\") }, {\"title\":true,\"data-system-id\":true})) + \"><a class=\\\"system-name\\\"><strong>\" + (jade.escape((jade.interp = system.name) == null ? '' : jade.interp)) + \"</strong></a></li>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me,view = locals_.view;buf.push(\"<nav role=\\\"navigation\\\" class=\\\"navbar navbar-default\\\"><ul class=\\\"nav navbar-nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#system-code\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"general.code\\\" id=\\\"system-code-tab\\\">Code</a></li><li><a href=\\\"#system-config-schema\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_component_config_schema\\\" id=\\\"system-config-schema-tab\\\">Config Schema</a></li><li><a href=\\\"#system-settings\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"play.settings\\\" id=\\\"system-settings-tab\\\">Settings</a></li><li><a href=\\\"#system-patches\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"resources.patches\\\" id=\\\"system-patches-tab\\\">Patches</a></li></ul><ul class=\\\"nav navbar-nav navbar-right\\\">\");\nif ( !me.isAdmin() && !me.isArtisan())\n{\nbuf.push(\"<li id=\\\"patch-system-button\\\"><a data-i18n=\\\"[title]common.submit_patch\\\"><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\"><span class=\\\"glyphicon-chevron-down glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li data-i18n=\\\"common.actions\\\" class=\\\"dropdown-header\\\">Actions</li><li><a id=\\\"system-watch-button\\\"><span class=\\\"watch\\\"><span class=\\\"glyphicon glyphicon-eye-open\\\"></span><span data-i18n=\\\"common.watch\\\" class=\\\"spl\\\">Watch</span></span><span class=\\\"unwatch secret\\\"><span class=\\\"glyphicon glyphicon-eye-close\\\"></span><span data-i18n=\\\"common.unwatch\\\" class=\\\"spl\\\">Unwatch</span></span></a></li>\");\nif ( me.isAdmin())\n{\nbuf.push(\"<li id=\\\"create-new-system\\\"><a data-i18n=\\\"editor.level_system_btn_new\\\">Create New System</a></li>\");\n}\nbuf.push(\"<li class=\\\"divider\\\"></li><li data-i18n=\\\"common.info\\\" class=\\\"dropdown-header\\\">Info</li><li id=\\\"system-history-button\\\"><a data-i18n=\\\"general.version_history\\\">Version History</a></li></ul></li></ul><div class=\\\"navbar-header\\\"><span class=\\\"navbar-brand\\\">\" + (jade.escape(null == (jade.interp = view.levelSystem.get('name')) ? \"\" : jade.interp)) + \"</span></div></nav><div class=\\\"tab-content\\\"><div id=\\\"system-code\\\" class=\\\"tab-pane active\\\"><div id=\\\"system-code-editor\\\"></div></div><div id=\\\"system-config-schema\\\" class=\\\"tab-pane\\\"><div id=\\\"config-schema-treema\\\"></div></div><div id=\\\"system-settings\\\" class=\\\"tab-pane\\\"><div id=\\\"edit-system-treema\\\"></div></div><div id=\\\"system-patches\\\" class=\\\"tab-pane\\\"><div class=\\\"patches-view\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3 data-i18n=\\\"editor.create_system_title\\\">Create New System</h3></div><div class=\\\"modal-body\\\"><form class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"level-system-name\\\" data-i18n=\\\"general.name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"level-system-name\\\" name=\\\"name\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button data-i18n=\\\"common.create\\\" id=\\\"new-level-system-submit\\\" class=\\\"btn btn-primary\\\">Create</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),systems = locals_.systems;buf.push(\"<table class=\\\"table systems-table\\\"><tr><th colspan=\\\"3\\\">Results: \" + (jade.escape((jade.interp = systems.length) == null ? '' : jade.interp)) + \"</th></tr><tr><th>Name</th><th>Description</th><th>Version</th><th></th></tr>\");\n// iterate systems\n;(function(){\n  var $$obj = systems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var system = $$obj[$index];\n\nbuf.push(\"<tr><td class=\\\"body-row\\\">\" + (jade.escape((jade.interp = system.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = system.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = system.version.minor) == null ? '' : jade.interp)) + \"</td><td><i\" + (jade.attrs({ 'data-name':(system.name), \"class\": [('icon-pencil'),('edit-system-button')] }, {\"data-name\":true})) + \"></i></td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var system = $$obj[$index];\n\nbuf.push(\"<tr><td class=\\\"body-row\\\">\" + (jade.escape((jade.interp = system.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = system.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = system.version.minor) == null ? '' : jade.interp)) + \"</td><td><i\" + (jade.attrs({ 'data-name':(system.name), \"class\": [('icon-pencil'),('edit-system-button')] }, {\"data-name\":true})) + \"></i></td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me;buf.push(\"<div class=\\\"systems-container\\\"><button type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#systems-treema\\\" class=\\\"navbar-toggle toggle btn-primary\\\"><span class=\\\"icon-list\\\"></span></button><h3 data-i18n=\\\"editor.level_systems_tab_title\\\">Current Systems</h3><div class=\\\"editor-nano-container nano\\\"><div id=\\\"systems-treema\\\" class=\\\"nano-content\\\"></div></div></div><div class=\\\"edit-system-container\\\">\");\nif ( me.isAdmin())\n{\nbuf.push(\"<button id=\\\"create-new-system-button\\\" class=\\\"btn btn-primary\\\"><span class=\\\"icon-file\\\"></span><span data-i18n=\\\"editor.level_systems_btn_new\\\" class=\\\"text\\\">Create New System</span></button>\");\n}\nbuf.push(\"<div id=\\\"level-system-edit-view\\\"></div></div><button id=\\\"add-system-button\\\" class=\\\"btn btn-primary\\\"><span class=\\\"icon-plus\\\"></span><span data-i18n=\\\"editor.level_systems_btn_add\\\" class=\\\"text\\\">Add System</span></button>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents,me = locals_.me,page = locals_.page;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"4\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th data-i18n=\\\"general.version\\\">Version</th><th data-i18n=\\\"common.watch\\\">Watch</th></tr>\");\n// iterate documents\n;(function(){\n  var $$obj = documents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var document = $$obj[$index];\n\nvar data = document.attributes;\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(document.get('creator') == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(data.name), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(data.description), \"class\": [('description-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</td>\");\nif ( document.watching())\n{\nbuf.push(\"<td class=\\\"watch-row watching\\\"><span aria-hidden=\\\"true\\\" class=\\\"glyphicon glyphicon-eye-open\\\"></span><span data-i18n=\\\"common.watch\\\" class=\\\"sr-only\\\">Watch</span></td>\");\n}\nelse\n{\nbuf.push(\"<td class=\\\"watch-row not-watching\\\"><span aria-hidden=\\\"true\\\" class=\\\"glyphicon glyphicon-eye-close\\\"></span><span data-i18n=\\\"common.unwatch\\\" class=\\\"sr-only\\\">Unwatch</span></td>\");\n}\nbuf.push(\"</tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var document = $$obj[$index];\n\nvar data = document.attributes;\nbuf.push(\"<tr\" + (jade.attrs({ \"class\": [(document.get('creator') == me.id ? 'mine' : '')] }, {\"class\":true})) + \"><td\" + (jade.attrs({ 'title':(data.name), \"class\": [('name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td\" + (jade.attrs({ 'title':(data.description), \"class\": [('description-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = data.description) == null ? '' : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</td>\");\nif ( document.watching())\n{\nbuf.push(\"<td class=\\\"watch-row watching\\\"><span aria-hidden=\\\"true\\\" class=\\\"glyphicon glyphicon-eye-open\\\"></span><span data-i18n=\\\"common.watch\\\" class=\\\"sr-only\\\">Watch</span></td>\");\n}\nelse\n{\nbuf.push(\"<td class=\\\"watch-row not-watching\\\"><span aria-hidden=\\\"true\\\" class=\\\"glyphicon glyphicon-eye-close\\\"></span><span data-i18n=\\\"common.unwatch\\\" class=\\\"sr-only\\\">Unwatch</span></td>\");\n}\nbuf.push(\"</tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"nano editor-nano-container\\\"><div class=\\\"nano-content\\\">\");\nvar task_row_mixin = function(cid){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nvar task = view.getTaskByCID(cid)\nvar taskName = task.get('name');\nvar isComplete = task.get('complete')\nbuf.push(\"<tr\" + (jade.attrs({ 'data-task-cid':(cid), \"class\": [('task-row')] }, {\"data-task-cid\":true})) + \"><td class=\\\"task-check\\\"><div class=\\\"checkbox\\\"><input\" + (jade.attrs({ 'type':('checkbox'), 'checked':((isComplete || false)), \"class\": [('task-input')] }, {\"type\":true,\"checked\":true})) + \"/></div></td>\");\nif ( task.get('curEdit') == true)\n{\nbuf.push(\"<td class=\\\"edit-cell\\\"></td><td class=\\\"task-name\\\"><input\" + (jade.attrs({ 'type':(\"input\"), 'value':(taskName), 'id':('cur-edit') }, {\"type\":true,\"value\":true})) + \"/></td>\");\n}\nelse\n{\nbuf.push(\"<td class=\\\"edit-cell\\\"><span class=\\\"glyphicon glyphicon-edit start-edit\\\"></span></td><td class=\\\"task-name\\\">\");\nvar result = view.getTaskURL(taskName)\nif ( result !== null)\n{\nbuf.push(\"<!-- https://github.com/codecombat/codecombat/wiki/Tasks-Tab#<slug goes here>--><a\" + (jade.attrs({ 'href':('https://github.com/codecombat/codecombat/wiki/Tasks-Tab#' + result), 'target':('blank') }, {\"href\":true,\"target\":true})) + \">\" + (jade.escape(null == (jade.interp = taskName) ? \"\" : jade.interp)) + \"</a>\");\n}\nelse\n{\nbuf.push(\"<span>\" + (jade.escape(null == (jade.interp = taskName) ? \"\" : jade.interp)) + \"</span>\");\n}\nbuf.push(\"</td>\");\n}\nbuf.push(\"</tr>\");\n};\nbuf.push(\"<table class=\\\"table table-striped table-hover\\\"><tr><th class=\\\"task-check\\\">Complete</th><th class=\\\"edit-cell\\\">Edit</th><th>Incomplete Tasks</th></tr>\");\n// iterate (view.taskArray() || [])\n;(function(){\n  var $$obj = (view.taskArray() || []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var task = $$obj[$index];\n\nif ( task.get('revert').complete !== true)\n{\ntask_row_mixin(task.cid);\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var task = $$obj[$index];\n\nif ( task.get('revert').complete !== true)\n{\ntask_row_mixin(task.cid);\n}\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<tr><th class=\\\"task-check\\\"></th><th class=\\\"edit-cell\\\"></th><th>Completed Tasks</th></tr>\");\n// iterate (view.taskArray() || [])\n;(function(){\n  var $$obj = (view.taskArray() || []);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var task = $$obj[$index];\n\nif ( task.get('revert').complete === true)\n{\ntask_row_mixin(task.cid);\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var task = $$obj[$index];\n\nif ( task.get('revert').complete === true)\n{\ntask_row_mixin(task.cid);\n}\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table><button id=\\\"create-task\\\" class=\\\"btn btn-primary\\\">Add Task</button></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),component = locals_.component;buf.push(\"<li\" + (jade.attrs({ 'title':(\"\" + (component.description) + \"\"), 'data-component-id':(\"\" + (component._id) + \"\") }, {\"title\":true,\"data-component-id\":true})) + \"><strong class=\\\"component-system\\\">\" + (jade.escape((jade.interp = component.system) == null ? '' : jade.interp)) + \": </strong><a class=\\\"component-name\\\">\" + (jade.escape((jade.interp = component.name) == null ? '' : jade.interp)) + \"</a></li>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"well\\\"><a data-i18n=\\\"editor.level_components_title\\\" id=\\\"all-thangs-link\\\">Back To All Thangs</a><span id=\\\"thang-props\\\"><a id=\\\"thang-name-link\\\"><span>\" + (jade.escape(null == (jade.interp = view.thangData.id) ? \"\" : jade.interp)) + \"</span><input\" + (jade.attrs({ 'value':(view.thangData.id), \"class\": [('secret')] }, {\"value\":true})) + \"/></a> ( <span data-i18n=\\\"editor.level_components_type\\\">Type</span>: <a id=\\\"thang-type-link\\\"><span>\" + (jade.escape(null == (jade.interp = view.thangData.thangType) ? \"\" : jade.interp)) + \"</span><input\" + (jade.attrs({ 'value':(view.thangData.thangType), \"class\": [('secret')] }, {\"value\":true})) + \"/></a> ) </span></div><div id=\\\"thang-components-edit-view\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<button id=\\\"thangs-container-toggle\\\" class=\\\"btn\\\"><span class=\\\"icon-list\\\"></span></button><button id=\\\"thangs-palette-toggle\\\" class=\\\"btn\\\"><span class=\\\"icon-plus\\\"></span></button><div id=\\\"all-thangs\\\" class=\\\"thangs-container hide\\\"><h3 data-i18n=\\\"editor.level_tab_thangs_title\\\">Current Thangs</h3><div id=\\\"thangs-treema\\\" data-i18n=\\\"[title]editor.config_thang\\\" title=\\\"Double click to configure a thang\\\"></div></div><div class=\\\"world-container\\\"><div id=\\\"canvas-wrapper\\\"><button data-toggle=\\\"coco-modal\\\" data-target=\\\"editor/level/modals/GenerateTerrainModal\\\" data-i18n=\\\"editor.generate_terrain\\\" class=\\\"generate-terrain-button btn btn-info btn-lg\\\">Generate Terrain</button><ul id=\\\"contextmenu\\\" class=\\\"dropdown-menu\\\"><li id=\\\"delete\\\"><a data-i18n=\\\"editor.delete\\\">Delete</a></li><li id=\\\"duplicate\\\"><a data-i18n=\\\"editor.duplicate\\\">Duplicate</a></li><li class=\\\"divider\\\"></li><li id=\\\"rotation-menu-item\\\" class=\\\"dropdown-header\\\"><span data-i18n=\\\"editor.rotate\\\" class=\\\"spr\\\">Rotate</span><button data-rotation=\\\"-0.5\\\" class=\\\"btn btn-xs spr\\\"><span class=\\\"glyphicon glyphicon-arrow-up\\\"></span></button><button data-rotation=\\\"1\\\" class=\\\"btn btn-xs spr\\\"><span class=\\\"glyphicon glyphicon-arrow-left\\\"></span></button><button data-rotation=\\\"0\\\" class=\\\"btn btn-xs spr\\\"><span class=\\\"glyphicon glyphicon-arrow-right\\\"></span></button><button data-rotation=\\\"0.5\\\" class=\\\"btn btn-xs\\\"><span class=\\\"glyphicon glyphicon-arrow-down\\\"></span></button></li></ul><canvas width=\\\"924\\\" height=\\\"589\\\" id=\\\"webgl-surface\\\"></canvas><canvas width=\\\"924\\\" height=\\\"589\\\" id=\\\"normal-surface\\\"></canvas><div id=\\\"canvas-left-gradient\\\" class=\\\"gradient\\\"></div><div id=\\\"canvas-top-gradient\\\" class=\\\"gradient\\\"></div></div></div><div id=\\\"add-thangs-view\\\"></div><div id=\\\"level-thang-edit-view\\\" class=\\\"secret\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3\" + (jade.attrs({ 'data-i18n':(\"\" + (view.newModelTitle) + \"\") }, {\"data-i18n\":true})) + \">Create New \" + (jade.escape((jade.interp = view.modelLabel) == null ? '' : jade.interp)) + \"</h3></div><div class=\\\"modal-body\\\"><form class=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"name\\\" data-i18n=\\\"general.name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"name\\\" name=\\\"name\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button><button data-i18n=\\\"common.create\\\" class=\\\"btn btn-primary new-model-submit\\\">Create</button></div><div class=\\\"modal-body wait secret\\\"><h3 data-i18n=\\\"play_level.tip_reticulating\\\">Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nif ( view.isPatch)\n{\nbuf.push(\"<h3 data-i18n=\\\"common.submit_patch\\\">Submit Patch</h3>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"versions.save_version_title\\\">Save New Version</h3>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body\\\">\");\nif ( view.hasChanges)\n{\nbuf.push(\"<div class=\\\"changes-stub\\\"></div><form class=\\\"form-inline\\\"><div class=\\\"form-group commit-message\\\"><input id=\\\"commit-message\\\" name=\\\"commitMessage\\\" type=\\\"text\\\" class=\\\"form-control\\\"/></div>\");\nif ( !view.isPatch && !view.options.noNewMajorVersions)\n{\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input id=\\\"major-version\\\" name=\\\"version-is-major\\\" type=\\\"checkbox\\\"/><span data-i18n=\\\"versions.new_major_version\\\">New Major Version</span></label></div>\");\n}\nbuf.push(\"</form>\");\n}\nelse\n{\nbuf.push(\"<div data-i18n=\\\"delta.no_changes\\\" class=\\\"alert alert-danger\\\">No changes</div>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\">\");\nif ( view.hasChanges)\n{\nif ( view.isPatch)\n{\nbuf.push(\"<h3 data-i18n=\\\"versions.submitting_patch\\\">Submitting Patch...</h3>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"common.saving\\\">Saving...</h3>\");\n}\n}\nbuf.push(\"<div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\">\");\nif ( view.hasChanges)\n{\nbuf.push(\"<div id=\\\"accept-cla-wrapper\\\" class=\\\"alert alert-info\\\"><span data-i18n=\\\"versions.cla_prefix\\\" class=\\\"spr\\\">To save changes, first you must agree to our</span><strong id=\\\"cla-link\\\" data-i18n=\\\"versions.cla_url\\\">CLA</strong><span data-i18n=\\\"versions.cla_suffix\\\"></span><button id=\\\"agreement-button\\\" data-i18n=\\\"versions.cla_agree\\\" class=\\\"btn btn-sm\\\">I AGREE</button></div>\");\nif ( view.isPatch)\n{\nbuf.push(\"<div data-i18n=\\\"versions.owner_approve\\\" class=\\\"alert alert-info\\\">An owner will need to approve it before your changes will become visible.</div>\");\n}\nbuf.push(\"<div class=\\\"save-error-area\\\">\");\nif ( view.savingPatchError)\n{\nbuf.push(\"<div class=\\\"alert alert-danger\\\">Unable to save patch: \" + (jade.escape((jade.interp = view.savingPatchError) == null ? '' : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"<div class=\\\"buttons\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\">Cancel</button>\");\nif ( view.hasChanges && !view.isPatch)\n{\nbuf.push(\"<button id=\\\"save-version-button\\\" data-i18n=\\\"common.save\\\" class=\\\"btn btn-primary\\\">Save</button>\");\n}\nif ( view.hasChanges && view.isPatch)\n{\nbuf.push(\"<button id=\\\"submit-patch-button\\\" data-i18n=\\\"common.submit_patch\\\" class=\\\"btn btn-primary\\\">Submit Patch</button>\");\n}\nbuf.push(\"</div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,dataList = locals_.dataList,page = locals_.page,moment = locals_.moment;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nif ( dataList)\n{\nbuf.push(\"<h3><span data-i18n=\\\"general.version_history_for\\\">Version History for:</span>\\\"\" + (jade.escape((jade.interp = dataList[0].name) == null ? '' : jade.interp)) + \"\\\"</h3><p data-i18n=\\\"general.select_changes\\\">Select two changes below to see the difference.</p>\");\n}\nbuf.push(\"<div class=\\\"delta-container\\\"><div class=\\\"delta-view\\\"></div></div></div><div class=\\\"modal-body\\\">\");\nif ( dataList)\n{\nbuf.push(\"<table class=\\\"table table-condensed\\\"><tr><th></th><th></th><th></th><th></th><th data-i18n=\\\"general.commit_msg\\\">Commit Message</th></tr>\");\n// iterate dataList\n;(function(){\n  var $$obj = dataList;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var data = $$obj[$index];\n\nbuf.push(\"<tr><td><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'value':(data._id), \"class\": [('select')] }, {\"type\":true,\"value\":true})) + \"/></td><td><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = moment(data.created).format('l')) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = data.creator) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.commitMessage) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var data = $$obj[$index];\n\nbuf.push(\"<tr><td><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'value':(data._id), \"class\": [('select')] }, {\"type\":true,\"value\":true})) + \"/></td><td><a\" + (jade.attrs({ 'href':(\"/editor/\" + (page) + \"/\" + (data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = data.version.minor) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = moment(data.created).format('l')) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = data.creator) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape((jade.interp = data.commitMessage) == null ? '' : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,patch = locals_.patch,deltaWorked = locals_.deltaWorked,isPatchCreator = locals_.isPatchCreator,status = locals_.status,isPatchRecipient = locals_.isPatchRecipient;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<div class=\\\"modal-header-content\\\"><h3 data-i18n=\\\"resources.patch\\\"></h3></div></div><div class=\\\"modal-body\\\"><div class=\\\"modal-body\\\"><p>\" + (jade.escape(null == (jade.interp = patch.get('commitMessage')) ? \"\" : jade.interp)) + \"</p>\");\nif ( deltaWorked)\n{\nbuf.push(\"<div class=\\\"changes-stub\\\"></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"alert alert-danger\\\">Could not apply this delta to the current version.</div>\");\n}\nbuf.push(\"</div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" data-i18n=\\\"common.cancel\\\" class=\\\"btn\\\"></button>\");\nif ( isPatchCreator)\n{\nif ( status != 'withdrawn')\n{\nbuf.push(\"<button id=\\\"withdraw-button\\\" data-i18n=\\\"general.withdraw\\\" class=\\\"btn btn-danger\\\"></button>\");\n}\n}\nif ( isPatchRecipient)\n{\nif ( status != 'accepted')\n{\nbuf.push(\"<button id=\\\"accept-button\\\" data-i18n=\\\"general.accept\\\" class=\\\"btn btn-primary\\\"></button>\");\n}\nif ( status != 'rejected')\n{\nbuf.push(\"<button id=\\\"reject-button\\\" data-i18n=\\\"general.reject\\\" class=\\\"btn btn-danger\\\"></button>\");\n}\n}\nbuf.push(\"</div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),patches = locals_.patches,moment = locals_.moment;buf.push(\"<div data-toggle=\\\"buttons\\\" class=\\\"btn-group status-buttons\\\"><label class=\\\"btn btn-default pending\\\"><input type=\\\"radio\\\" name=\\\"status\\\" value=\\\"pending\\\"/><span data-i18n=\\\"general.pending\\\">Pending</span></label><label class=\\\"btn btn-default accepted\\\"><input type=\\\"radio\\\" name=\\\"status\\\" value=\\\"accepted\\\"/><span data-i18n=\\\"general.accepted\\\">Accepted</span></label><label class=\\\"btn btn-default rejected\\\"><input type=\\\"radio\\\" name=\\\"status\\\" value=\\\"rejected\\\"/><span data-i18n=\\\"general.rejected\\\">Rejected</span></label><label class=\\\"btn btn-default withdrawn\\\"><input type=\\\"radio\\\" name=\\\"status\\\" value=\\\"withdrawn\\\"/><span data-i18n=\\\"general.withdrawn\\\">Withdrawn</span></label></div>\");\nif ( patches.loading)\n{\nbuf.push(\"<p data-i18n=\\\"common.loading\\\">Loading...</p>\");\n}\nelse\n{\nbuf.push(\"<table class=\\\"table table-condensed table-bordered\\\"><tr><th data-i18n=\\\"general.submitter\\\">Submitter</th><th data-i18n=\\\"general.submitted\\\">Submitted</th><th data-i18n=\\\"general.commit_msg\\\">Commit Message</th></tr>\");\n// iterate patches\n;(function(){\n  var $$obj = patches;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var patch = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('patch-row')] }, {\"data-patch-id\":true})) + \"><td>\" + (jade.escape(null == (jade.interp = patch.userName) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = moment(patch.get('created')).format('llll')) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = patch.get('commitMessage')) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var patch = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attrs({ 'data-patch-id':(patch.id), \"class\": [('patch-row')] }, {\"data-patch-id\":true})) + \"><td>\" + (jade.escape(null == (jade.interp = patch.userName) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = moment(patch.get('created')).format('llll')) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = patch.get('commitMessage')) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");\n};return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),features = locals_.features,me = locals_.me,view = locals_.view,usesSocialMedia = locals_.usesSocialMedia,isIE = locals_.isIE,fbRef = locals_.fbRef;buf.push(\"<div id=\\\"site-nav\\\"><a href=\\\"/\\\"><img id=\\\"nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><div id=\\\"site-nav-links\\\"><a href=\\\"/\\\"><img id=\\\"small-nav-logo\\\" src=\\\"/images/pages/base/logo.png\\\" title=\\\"CodeCombat - Learn how to code by playing a game\\\" alt=\\\"CodeCombat\\\"/></a><a href=\\\"/\\\"><span class=\\\"glyphicon glyphicon-home\\\"></span></a>\");\nif ( !features.playViewsOnly)\n{\nbuf.push(\"<a href=\\\"/play\\\" data-i18n=\\\"common.play\\\"></a><a href=\\\"/play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\nif ( me.isStudent())\n{\nbuf.push(\"<a href=\\\"/students\\\" data-i18n=\\\"nav.my_courses\\\"></a>\");\n}\nif ( me.isTeacher())\n{\nbuf.push(\"<a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a><a href=\\\"/community\\\" data-i18n=\\\"nav.community\\\"></a>\");\nif ( me.get('anonymous') === false)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><button href=\\\"#\\\" data-toggle=\\\"dropdown\\\" class=\\\"btn btn-sm header-font dropdown-toggle\\\">\");\nif ( me.get('photoURL'))\n{\nbuf.push(\"<img\" + (jade.attrs({ 'src':(me.getPhotoURL(18)), 'alt':(\"\"), \"class\": [('account-settings-image')] }, {\"src\":true,\"alt\":true})) + \"/>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"glyphicon glyphicon-user\\\"></i>\");\n}\nbuf.push(\"<span data-i18n=\\\"nav.account\\\" href=\\\"/account\\\" class=\\\"spl spr\\\"></span><span class=\\\"caret\\\"></span></button><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"><li class=\\\"user-dropdown-header\\\"><span class=\\\"user-level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\") }, {\"href\":true})) + \"><div\" + (jade.attrs({ 'style':(\"background-image: url(\" + (me.getPhotoURL()) + \")\"), \"class\": [('img-circle')] }, {\"style\":true})) + \"></div></a><h3>\" + (jade.escape(null == (jade.interp = me.broadName()) ? \"\" : jade.interp)) + \"</h3></li><li><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\"), 'data-i18n':(\"nav.profile\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li><li><a href=\\\"/account/settings\\\" data-i18n=\\\"play.settings\\\"></a></li>\");\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/payments\\\" data-i18n=\\\"account.payments\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()) || me.hasSubscription())\n{\nbuf.push(\"<li><a href=\\\"/account/subscription\\\" data-i18n=\\\"account.subscription\\\"></a></li>\");\n}\nif ( me.isAdmin() || !(me.isTeacher() || me.isStudent()))\n{\nbuf.push(\"<li><a href=\\\"/account/prepaid\\\" data-i18n=\\\"account.prepaid_codes\\\"></a></li>\");\n}\nbuf.push(\"<li><a id=\\\"logout-button\\\" data-i18n=\\\"login.log_out\\\"></a></li></ul></span>\");\n}\nelse\n{\nbuf.push(\"<button data-i18n=\\\"login.sign_up\\\" class=\\\"btn btn-sm btn-primary header-font signup-button\\\"></button><button data-i18n=\\\"login.log_in\\\" class=\\\"btn btn-sm btn-default header-font login-button\\\"></button>\");\n}\n}\nbuf.push(\"<select class=\\\"language-dropdown form-control\\\"></select></div></div><div id=\\\"site-content-area\\\">\");\nvar authorized = me.isAdmin();\nif ( authorized)\n{\nbuf.push(\"<ol class=\\\"breadcrumb\\\"><li><a href=\\\"/editor\\\" data-i18n=\\\"editor.main_title\\\">CodeCombat Editors</a></li><li><a href=\\\"/editor/poll\\\" data-i18n=\\\"editor.poll_title\\\">Poll Editor</a></li><li class=\\\"active\\\">\" + (jade.escape((jade.interp = view.poll.attributes.name) == null ? '' : jade.interp)) + \"</li></ol><button\" + (jade.attrs({ 'data-i18n':(\"common.delete\"), 'disabled':(!me.isAdmin()), 'id':('delete-button'), \"class\": [('poll-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Delete</button><button\" + (jade.attrs({ 'data-i18n':(\"common.save\"), 'disabled':(!me.isAdmin()), 'id':('save-button'), \"class\": [('poll-tool-button'),('btn'),('btn-primary')] }, {\"data-i18n\":true,\"disabled\":true})) + \">Save</button><h3 data-i18n=\\\"poll.edit_poll_title\\\">Edit Poll<span>: \\\"\" + (jade.escape((jade.interp = view.poll.attributes.name) == null ? '' : jade.interp)) + \"\\\"</span></h3><div id=\\\"poll-treema\\\"></div><div id=\\\"poll-view\\\" class=\\\"clearfix\\\"></div><h3 data-i18n=\\\"resources.patches\\\">Patches</h3><div class=\\\"patches-view\\\"></div><hr/>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"alert alert-danger\\\"><span>Admin only. Turn around.</span></div>\");\n}\nbuf.push(\"</div><div class=\\\"achievement-corner\\\"></div><div id=\\\"site-footer\\\"><img id=\\\"footer-background\\\" src=\\\"/images/pages/base/nav_background.png\\\"/><div\" + (jade.attrs({ 'id':('footer-links'), \"class\": [(features.playViewsOnly ? 'hide' : '')] }, {\"class\":true})) + \"><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a tabindex=\\\"-1\\\" data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a>\");\n}\nbuf.push(\"<a href=\\\"http://blog.codecombat.com/\\\" data-i18n=\\\"nav.blog\\\"></a><a href=\\\"https://jobs.lever.co/codecombat\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.careers\\\"></a><a href=\\\"/legal\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.legal\\\"></a><a href=\\\"/privacy\\\" tabindex=\\\"-1\\\" data-i18n=\\\"legal.privacy_title\\\"></a><a href=\\\"/contribute\\\" tabindex=\\\"-1\\\" data-i18n=\\\"nav.contribute\\\"></a>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<a href=\\\"/play/ladder\\\" tabindex=\\\"-1\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<a href=\\\"/admin\\\">Admin</a>\");\n}\nif ( usesSocialMedia)\n{\nbuf.push(\"<div class=\\\"share-buttons\\\">\");\nif ( !isIE)\n{\nbuf.push(\"<div data-href=\\\"http://codecombat.com\\\" data-size=\\\"medium\\\" class=\\\"g-plusone\\\"></div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-href':(\"https://www.facebook.com/codecombat\"), 'data-send':(\"false\"), 'data-layout':(\"button_count\"), 'data-width':(\"350\"), 'data-show-faces':(\"true\"), 'data-ref':(\"coco_footer_\" + (fbRef) + \"\"), \"class\": [('fb-like')] }, {\"data-href\":true,\"data-send\":true,\"data-layout\":true,\"data-width\":true,\"data-show-faces\":true,\"data-ref\":true})) + \"></div>\");\nif ( !isIE)\n{\nbuf.push(\"<a href=\\\"https://twitter.com/CodeCombat\\\" data-show-count=\\\"true\\\" data-show-screen-name=\\\"false\\\" data-dnt=\\\"true\\\" data-align=\\\"right\\\" data-i18n=\\\"nav.twitter_follow\\\" class=\\\"twitter-follow-button\\\"></a><iframe src=\\\"https://ghbtns.com/github-btn.html?user=codecombat&amp;repo=codecombat&amp;type=watch&amp;count=true\\\" allowtransparency=\\\"true\\\" frameborder=\\\"0\\\" scrolling=\\\"0\\\" width=\\\"110\\\" height=\\\"20\\\" class=\\\"github-star-button\\\"></iframe>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div><div id=\\\"footer-credits\\\"><span><span> All Rights Reserved</span><br/><span>CodeCombat 2015</span></span><img id=\\\"footer-logo\\\" src=\\\"/images/pages/base/logo.png\\\" alt=\\\"CodeCombat\\\"/><span><span>Site Design by</span><br/><a href=\\\"http://www.fullyillustrated.com/\\\">Fully Illustrated</a></span><!--a.firebase-bade(href=\\\"https://www.firebase.com/\\\")  // Not using right now--><!--  img(src=\\\"/images/pages/base/firebase.png\\\", alt=\\\"Powered by Firebase\\\")--></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents,moment = locals_.moment;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"3\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th data-i18n=\\\"polls.priority\\\">Priority</th><th data-i18n=\\\"general.date\\\">Date</th></tr>\");\n// iterate documents\n;(function(){\n  var $$obj = documents;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var data = $$obj[$index];\n\ndata = data.attributes;\nbuf.push(\"<tr><td><a\" + (jade.attrs({ 'href':(\"/editor/poll/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = data.description) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = data.priority) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = moment(data.created).fromNow()) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var data = $$obj[$index];\n\ndata = data.attributes;\nbuf.push(\"<tr><td><a\" + (jade.attrs({ 'href':(\"/editor/poll/\" + (data.slug || data._id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = data.name) == null ? '' : jade.interp)) + \"</a></td><td>\" + (jade.escape(null == (jade.interp = data.description) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = data.priority) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = moment(data.created).fromNow()) ? \"\" : jade.interp)) + \"</td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nbuf.push(\"<div id=\\\"color-groups-treema\\\"></div><div id=\\\"color-group-settings\\\" class=\\\"secret\\\"><div id=\\\"shape-buttons\\\"></div><canvas id=\\\"tinting-display\\\" width=\\\"400\\\" height=\\\"400\\\"></canvas><div id=\\\"controls\\\"><div class=\\\"slider-cell\\\">Hue:<span class=\\\"hue-label\\\"></span><div id=\\\"hue-slider\\\" class=\\\"selector\\\"></div></div><div class=\\\"slider-cell\\\">Saturation:<span class=\\\"saturation-label\\\"></span><div id=\\\"saturation-slider\\\" class=\\\"selector\\\"></div></div><div class=\\\"slider-cell\\\">Lightness:<span class=\\\"lightness-label\\\"></span><div id=\\\"lightness-slider\\\" class=\\\"selector\\\"></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,_ = locals_._;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h4 class=\\\"modal-title\\\">Export \" + (jade.escape((jade.interp = view.thangType.get('name')) == null ? '' : jade.interp)) + \" SpriteSheet</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-horizontal\\\"><div class=\\\"form-group\\\"><label class=\\\"col-sm-3 control-label\\\">Team Color</label><div class=\\\"col-sm-9\\\"><select id=\\\"color-config-select\\\" class=\\\"form-control\\\"><option value=\\\"\\\">None</option><option value=\\\"red\\\">Red</option><option value=\\\"blue\\\">Blue</option><option value=\\\"green\\\">Green</option></select></div></div><div class=\\\"form-group\\\"><label class=\\\"col-sm-3 control-label\\\">Resolution Factor</label><div class=\\\"col-sm-9\\\"><input id=\\\"resolution-input\\\" value=\\\"3\\\" class=\\\"form-control\\\"/></div></div><div class=\\\"form-group\\\"><label class=\\\"col-sm-3 control-label\\\">Sprite Type</label><div class=\\\"col-sm-9\\\">\");\nvar spriteType = view.thangType.get('spriteType') || 'segmented'\nbuf.push(\"<label class=\\\"radio-inline\\\"><input\" + (jade.attrs({ 'type':(\"radio\"), 'name':(\"sprite-type\"), 'value':(\"segmented\"), 'checked':(spriteType==='segmented') }, {\"type\":true,\"name\":true,\"value\":true,\"checked\":true})) + \"/>Segmented</label><label class=\\\"radio-inline\\\"><input\" + (jade.attrs({ 'type':(\"radio\"), 'name':(\"sprite-type\"), 'value':(\"singular\"), 'checked':(spriteType!=='segmented') }, {\"type\":true,\"name\":true,\"value\":true,\"checked\":true})) + \"/>Singular</label></div></div><div class=\\\"form-group\\\"><label class=\\\"col-sm-3 control-label\\\">Actions</label><div class=\\\"col-sm-9\\\">\");\nvar defaultActionNames = _.pluck(view.thangType.getDefaultActions(), 'name')\nvar actions = view.thangType.getActions()\n// iterate actions\n;(function(){\n  var $$obj = actions;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var action = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'name':(\"action\"), 'value':(action.name), 'checked':(_.contains(defaultActionNames, action.name)) }, {\"type\":true,\"name\":true,\"value\":true,\"checked\":true})) + \"/>\" + (jade.escape((jade.interp = action.name) == null ? '' : jade.interp)) + \"</label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var action = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox\\\"><label><input\" + (jade.attrs({ 'type':(\"checkbox\"), 'name':(\"action\"), 'value':(action.name), 'checked':(_.contains(defaultActionNames, action.name)) }, {\"type\":true,\"name\":true,\"value\":true,\"checked\":true})) + \"/>\" + (jade.escape((jade.interp = action.name) == null ? '' : jade.interp)) + \"</label></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button data-dismiss=\\\"modal\\\" class=\\\"btn btn-default\\\">Cancel</button><button id=\\\"save-btn\\\" class=\\\"btn btn-primary\\\">Save</button><div class=\\\"progress progress-striped active hide\\\"><div style=\\\"width: 100%\\\" class=\\\"progress-bar\\\"></div></div></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\n;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),documents = locals_.documents;buf.push(\"<table class=\\\"table\\\"><tr><th colspan=\\\"4\\\"><span data-i18n=\\\"general.results\\\">Results</span><span>: \" + (jade.escape((jade.interp = documents.length) == null ? '' : jade.interp)) + \"</span></th></tr><tr><th id=\\\"portrait-col\\\"></th><th data-i18n=\\\"general.name\\\">Name</th><th data-i18n=\\\"general.description\\\">Description</th><th data-i18n=\\\"general.version\\\">Version</th><th data-i18n=\\\"editor.tasks\\\">Tasks</th></tr>\");\n// iterate documents \n;(function(){\n  var $$obj = documents ;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var thang = $$obj[$index];\n\nbuf.push(\"<tr><td>\");\nvar name = thang.get('name');\nbuf.push(\"<img\" + (jade.attrs({ 'title':(\"Add \" + (name) + \"\"), 'src':(thang.getPortraitURL()), 'alt':(\"\"), \"class\": [('portrait')] }, {\"title\":true,\"src\":true,\"alt\":true})) + \"/></td><td\" + (jade.attrs({ 'title':(name), \"class\": [('small-name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/thang/\" + (thang.get('slug') || thang.id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = name) == null ? '' : jade.interp)) + \"</a></td>\");\nvar description = thang.get('description');\nbuf.push(\"<td\" + (jade.attrs({ 'title':(description), \"class\": [('body-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = description) == null ? '' : jade.interp)) + \"</td>\");\nvar version = thang.get('version')\nbuf.push(\"<td>\" + (jade.escape((jade.interp = version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = version.minor) == null ? '' : jade.interp)) + \"</td>\");\nvar tasks = thang.get('tasks');\nif ( tasks && tasks.length)\n{\nvar completed = tasks.filter(function(t) { return t.complete; });\nbuf.push(\"<td>\" + (jade.escape((jade.interp = completed.length) == null ? '' : jade.interp)) + \"/\" + (jade.escape((jade.interp = tasks.length) == null ? '' : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td></td>\");\n}\nbuf.push(\"</tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var thang = $$obj[$index];\n\nbuf.push(\"<tr><td>\");\nvar name = thang.get('name');\nbuf.push(\"<img\" + (jade.attrs({ 'title':(\"Add \" + (name) + \"\"), 'src':(thang.getPortraitURL()), 'alt':(\"\"), \"class\": [('portrait')] }, {\"title\":true,\"src\":true,\"alt\":true})) + \"/></td><td\" + (jade.attrs({ 'title':(name), \"class\": [('small-name-row')] }, {\"title\":true})) + \"><a\" + (jade.attrs({ 'href':(\"/editor/thang/\" + (thang.get('slug') || thang.id) + \"\") }, {\"href\":true})) + \">\" + (jade.escape((jade.interp = name) == null ? '' : jade.interp)) + \"</a></td>\");\nvar description = thang.get('description');\nbuf.push(\"<td\" + (jade.attrs({ 'title':(description), \"class\": [('body-row')] }, {\"title\":true})) + \">\" + (jade.escape((jade.interp = description) == null ? '' : jade.interp)) + \"</td>\");\nvar version = thang.get('version')\nbuf.push(\"<td>\" + (jade.escape((jade.interp = version.major) == null ? '' : jade.interp)) + \".\" + (jade.escape((jade.interp = version.minor) == null ? '' : jade.interp)) + \"</td>\");\nvar tasks = thang.get('tasks');\nif ( tasks && tasks.length)\n{\nvar completed = tasks.filter(function(t) { return t.complete; });\nbuf.push(\"<td>\" + (jade.escape((jade.interp = completed.length) == null ? '' : jade.interp)) + \"/\" + (jade.escape((jade.interp = tasks.length) == null ? '' : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td></td>\");\n}\nbuf.push(\"</tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</table>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),thangType = locals_.thangType,recentlyPlayedLevels = locals_.recentlyPlayedLevels,authorized = locals_.authorized,me = locals_.me,fileSizeString = locals_.fileSizeString,animations = locals_.animations;if ( thangType.loading)\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"thang-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><div class=\\\"container-fluid\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/editor/thang\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul></div></nav>\");\n}\nelse\n{\nbuf.push(\"<nav role=\\\"navigation\\\" id=\\\"thang-editor-top-nav\\\" class=\\\"navbar navbar-default\\\"><ul class=\\\"nav navbar-nav\\\"><li><a href=\\\"/editor/thang\\\"><span class=\\\"glyphicon-home glyphicon\\\"></span></a></li></ul><ul class=\\\"nav navbar-nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#editor-thang-main-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.thang_main\\\">Main</a></li><li><a href=\\\"#editor-thang-components-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.level_tab_components\\\">Components</a></li><li><a href=\\\"#editor-thang-spritesheets-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.thang_spritesheets\\\">Spritesheets</a></li><li><a href=\\\"#editor-thang-colors-tab-view\\\" data-toggle=\\\"tab\\\" data-i18n=\\\"editor.thang_colors\\\" id=\\\"color-tab\\\">Colors</a></li><li><a href=\\\"#editor-thang-patches-view\\\" data-toggle=\\\"tab\\\" id=\\\"patches-tab\\\"><span data-i18n=\\\"resources.patches\\\" class=\\\"spr\\\">Patches</span>\");\nvar patches = thangType.get('patches')\nif ( patches && patches.length)\n{\nbuf.push(\"<span class=\\\"badge\\\">\" + (jade.escape(null == (jade.interp = patches.length) ? \"\" : jade.interp)) + \"</span>\");\n}\nbuf.push(\"</a></li></ul><div class=\\\"navbar-header\\\"><span class=\\\"navbar-brand\\\">\" + (jade.escape((jade.interp = thangType.attributes.name) == null ? '' : jade.interp)) + \"</span></div><ul class=\\\"nav navbar-nav navbar-right\\\"><li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\" class=\\\"play-with-level-parent\\\"><span class=\\\"glyphicon-play glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li class=\\\"dropdown-header\\\">Play Which Level?</li><li>\");\n// iterate recentlyPlayedLevels\n;(function(){\n  var $$obj = recentlyPlayedLevels;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var level = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-level':(level), \"class\": [('play-with-level-button')] }, {\"data-level\":true})) + \">\" + (jade.escape(null == (jade.interp = level) ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var level = $$obj[$index];\n\nbuf.push(\"<a\" + (jade.attrs({ 'data-level':(level), \"class\": [('play-with-level-button')] }, {\"data-level\":true})) + \">\" + (jade.escape(null == (jade.interp = level) ? \"\" : jade.interp)) + \"</a>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<input placeholder=\\\"Type in a level name\\\" class=\\\"play-with-level-input\\\"/></li></ul></li>\");\nif ( authorized)\n{\nbuf.push(\"<li id=\\\"save-button\\\"><a><span class=\\\"glyphicon-floppy-disk glyphicon\\\"></span></a></li>\");\n}\nbuf.push(\"<li class=\\\"dropdown\\\"><a data-toggle=\\\"dropdown\\\"><span class=\\\"glyphicon-chevron-down glyphicon\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li data-i18n=\\\"common.actions\\\" class=\\\"dropdown-header\\\">Actions</li><li\" + (jade.attrs({ \"class\": [(!me.isAdmin() && !me.isArtisan() ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-i18n=\\\"common.fork\\\" id=\\\"fork-start-button\\\">Fork</a></li><li\" + (jade.attrs({ \"class\": [(!authorized ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a\" + (jade.attrs({ 'data-toggle':(\"coco-modal\"), 'data-target':(\"modal/RevertModal\"), 'data-i18n':(\"editor.revert\"), 'disabled':(!authorized), 'id':('revert-button') }, {\"data-toggle\":true,\"data-target\":true,\"data-i18n\":true,\"disabled\":true})) + \">Revert</a></li><li\" + (jade.attrs({ \"class\": [(!authorized ? \"disabled\": \"\")] }, {\"class\":true})) + \"><a data-i18n=\\\"editor.pop_i18n\\\" id=\\\"pop-level-i18n-button\\\">Populate i18n</a></li><li class=\\\"divider\\\"></li><li data-i18n=\\\"common.info\\\" class=\\\"dropdown-header\\\">Info</li><li id=\\\"history-button\\\"><a href=\\\"#\\\" data-i18n=\\\"general.version_history\\\">Version History</a></li><li class=\\\"divider\\\"></li><li data-i18n=\\\"common.help\\\" class=\\\"dropdown-header\\\">Help</li><li><a href=\\\"https://github.com/codecombat/codecombat/wiki/Artisan-Home\\\" data-i18n=\\\"editor.wiki\\\" target=\\\"_blank\\\">Wiki</a></li><li><a href=\\\"https://coco-slack-invite.herokuapp.com/\\\" data-i18n=\\\"editor.live_chat\\\" target=\\\"_blank\\\">Live Chat</a></li><li><a href=\\\"http://discourse.codecombat.com/category/artisan\\\" data-i18n=\\\"nav.forum\\\" target=\\\"_blank\\\">Forum</a></li>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<li><a data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a></li>\");\n}\nbuf.push(\"</ul></li></ul></nav>\");\n}\nbuf.push(\"<div class=\\\"outer-content\\\"><div class=\\\"tab-content\\\"><div id=\\\"editor-thang-colors-tab-view\\\" class=\\\"tab-pane\\\"></div><div id=\\\"editor-thang-main-tab-view\\\" class=\\\"tab-pane active\\\"><div id=\\\"settings-col\\\" class=\\\"well\\\"><div class=\\\"row\\\"><div class=\\\"col-sm-3\\\"><img id=\\\"portrait\\\" class=\\\"img-thumbnail\\\"/></div><div class=\\\"col-sm-9\\\"><div class=\\\"file-controls\\\"><button\" + (jade.attrs({ 'disabled':(authorized === true ? undefined : \"true\"), 'id':('upload-button'), \"class\": [('btn'),('btn-sm'),('btn-info')] }, {\"disabled\":true})) + \"><span class=\\\"glyphicon glyphicon-upload\\\"></span><span class=\\\"spl\\\">Upload Animation</span></button><button\" + (jade.attrs({ 'disabled':(authorized === true ? undefined : \"true\"), 'id':('clear-button'), \"class\": [('btn'),('btn-sm'),('btn-danger')] }, {\"disabled\":true})) + \"><span class=\\\"glyphicon glyphicon-remove\\\"></span><span class=\\\"spl\\\">Clear Data</span></button><button\" + (jade.attrs({ 'id':('set-vector-icon'), 'disabled':(authorized === true ? undefined : \"true\"), \"class\": [('btn'),('btn-sm')] }, {\"disabled\":true})) + \"><span class=\\\"glyphicon glyphicon-gbp\\\"></span><span class=\\\"spl\\\">Vector Icon Setup</span></button><button\" + (jade.attrs({ 'id':('export-sprite-sheet-btn'), 'disabled':(authorized === true ? undefined : \"true\"), \"class\": [('btn'),('btn-sm')] }, {\"disabled\":true})) + \"><span class=\\\"glyphicon glyphicon-export\\\"></span><span class=\\\"spl\\\">Export SpriteSheet</span></button><input id=\\\"real-upload-button\\\" type=\\\"file\\\"/></div><div id=\\\"thang-type-file-size\\\">\" + (jade.escape(null == (jade.interp = fileSizeString) ? \"\" : jade.interp)) + \"</div></div></div><div id=\\\"thang-type-treema\\\"></div><div class=\\\"clearfix\\\"></div></div><div id=\\\"display-col\\\" class=\\\"well\\\"><canvas id=\\\"canvas\\\" width=\\\"400\\\" height=\\\"600\\\"></canvas><select id=\\\"animations-select\\\" class=\\\"form-control\\\">\");\n// iterate animations\n;(function(){\n  var $$obj = animations;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var animation = $$obj[$index];\n\nbuf.push(\"<option>\" + (jade.escape((jade.interp = animation) == null ? '' : jade.interp)) + \"</option>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var animation = $$obj[$index];\n\nbuf.push(\"<option>\" + (jade.escape((jade.interp = animation) == null ? '' : jade.interp)) + \"</option>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</select><div><button id=\\\"marker-button\\\" class=\\\"btn btn-small btn-primary\\\"><i class=\\\"icon-map-marker\\\"></i><span class=\\\"spl\\\">Markers</span></button><button id=\\\"play-button\\\" class=\\\"btn btn-small btn-primary\\\"><i class=\\\"icon-play\\\"></i><span class=\\\"spl\\\">Play</span></button><button id=\\\"stop-button\\\" class=\\\"btn btn-small btn-primary\\\"><i class=\\\"icon-stop\\\"></i><span class=\\\"spl\\\">Stop</span></button></div><div class=\\\"slider-cell\\\">Rotation:<span class=\\\"rotation-label\\\"></span><div id=\\\"rotation-slider\\\" class=\\\"selector\\\"></div></div><div class=\\\"slider-cell\\\">Scale:<span class=\\\"scale-label\\\"></span><div id=\\\"scale-slider\\\" class=\\\"selector\\\"></div></div><div class=\\\"slider-cell\\\">Resolution:<span class=\\\"resolution-label\\\"> 4.0x</span><div id=\\\"resolution-slider\\\" class=\\\"selector\\\"></div></div><div class=\\\"slider-cell\\\">Health:<span class=\\\"health-label\\\"> 10hp</span><div id=\\\"health-slider\\\" class=\\\"selector\\\"></div></div></div></div><div id=\\\"editor-thang-components-tab-view\\\" class=\\\"tab-pane\\\"><div id=\\\"thang-components-edit-view\\\"></div></div><div id=\\\"editor-thang-spritesheets-view\\\" class=\\\"tab-pane\\\"><div id=\\\"spritesheets\\\"></div></div><div id=\\\"editor-thang-patches-view\\\" class=\\\"tab-pane\\\"><div class=\\\"patches-view\\\"></div></div></div><div class=\\\"clearfix\\\"></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3>Choose Container for Vector Icon</h3></div><div class=\\\"modal-body\\\">\");\nif ( view.container)\n{\nbuf.push(\"<form class=\\\"form\\\"><div class=\\\"form-group\\\"><select id=\\\"container-select\\\" class=\\\"form-control\\\">\");\n// iterate view.containers\n;(function(){\n  var $$obj = view.containers;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var container = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(container), 'selected':(container === view.container) }, {\"value\":true,\"selected\":true})) + \">\" + (jade.escape(null == (jade.interp = container) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var container = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(container), 'selected':(container === view.container) }, {\"value\":true,\"selected\":true})) + \">\" + (jade.escape(null == (jade.interp = container) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</select></div></form><canvas\" + (jade.attrs({ 'width':(view.demoSize), 'height':(view.demoSize), 'id':('resulting-icon') }, {\"width\":true,\"height\":true})) + \"></canvas><div class=\\\"alert alert-info\\\">Arrow keys to move, Shift-Plus/Minus to scale.</div>\");\n}\nelse\n{\nbuf.push(\"<div>forgetting something?</div>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button id=\\\"center\\\" class=\\\"btn pull-left btn-info\\\"><span class=\\\"glyphicon glyphicon-cutlery\\\"></span><span class=\\\"spl\\\">Center</span></button><button id=\\\"done-button\\\" class=\\\"btn btn-primary\\\">Done</button></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),me = locals_.me,serverConfig = locals_.serverConfig,view = locals_.view;var accountLinks_mixin = function(){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nbuf.push(\"<li><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\"), 'data-i18n':(\"nav.profile\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li><li><a href=\\\"/account/settings\\\" data-i18n=\\\"play.settings\\\"></a></li><li><a id=\\\"logout-button\\\" data-i18n=\\\"login.log_out\\\"></a></li>\");\n};\nbuf.push(\"<div class=\\\"style-flat\\\"><nav id=\\\"main-nav\\\" class=\\\"navbar navbar-default\\\"><div class=\\\"container-fluid container\\\"><div class=\\\"row\\\"><div class=\\\"col-md-12\\\"><div class=\\\"navbar-header\\\"><button data-toggle=\\\"collapse\\\" data-target=\\\"#navbar-collapse\\\" aria-expanded=\\\"false\\\" class=\\\"navbar-toggle collapsed\\\"><span data-i18n=\\\"nav.toggle_nav\\\" class=\\\"sr-only\\\"></span><span class=\\\"icon-bar\\\"></span><span class=\\\"icon-bar\\\"></span><span class=\\\"icon-bar\\\"></span></button><a href=\\\"/\\\" class=\\\"navbar-brand\\\">\");\nif ( serverConfig.codeNinjas)\n{\nbuf.push(\"<img id=\\\"logo-img\\\" src=\\\"/images/pages/base/logo.png\\\" class=\\\"code-ninjas-powered-by\\\"/><img src=\\\"/images/pages/base/code-ninjas-logo-right.png\\\" class=\\\"code-ninjas-logo\\\"/>\");\n}\nelse\n{\nbuf.push(\"<img id=\\\"logo-img\\\" src=\\\"/images/pages/base/logo.png\\\"/>\");\n}\nbuf.push(\"<span class=\\\"glyphicon glyphicon-home\\\"></span></a></div><div id=\\\"navbar-collapse\\\" class=\\\"collapse navbar-collapse\\\"><ul class=\\\"nav navbar-nav\\\">\");\nif ( (!me.isStudent() && !me.isTeacher()))\n{\nbuf.push(\"<li><a href=\\\"/play\\\" data-i18n=\\\"common.play\\\"></a></li>\");\n}\nbuf.push(\"<li><a href=\\\"play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a></li>\");\nif ( me.isStudent())\n{\nbuf.push(\"<li><a href=\\\"/students\\\" data-i18n=\\\"nav.my_courses\\\"></a></li>\");\n}\nif ( !me.isAnonymous() && me.isTeacher())\n{\nbuf.push(\"<li><a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a></li>\");\n}\nbuf.push(\"<li><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a></li><li><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li></ul>\");\nif ( me.isAnonymous())\n{\nbuf.push(\"<ul class=\\\"nav navbar-nav\\\"><li><a id=\\\"create-account-link\\\" data-i18n=\\\"login.sign_up\\\" class=\\\"signup-button\\\"></a></li><li><a id=\\\"login-link\\\" data-i18n=\\\"login.log_in\\\" class=\\\"login-button\\\"></a></li></ul>\");\n}\nelse\n{\nbuf.push(\"<ul class=\\\"nav navbar-nav hidden-md hidden-lg\\\"><li class=\\\"disabled\\\"><a><img\" + (jade.attrs({ 'src':(me.getPhotoURL()), \"class\": [('img-circle'),('img-circle-small'),('m-r-1'),((me.isTeacher() ? 'border-navy' : ''))] }, {\"class\":true,\"src\":true})) + \"/><span>\" + (jade.escape(null == (jade.interp = me.displayName()) ? \"\" : jade.interp)) + \"</span></a></li>\");\naccountLinks_mixin();\nbuf.push(\"</ul><ul class=\\\"nav navbar-nav\\\"><li class=\\\"dropdown hidden-xs hidden-sm\\\"><a href=\\\"#\\\" data-toggle=\\\"dropdown\\\" role=\\\"button\\\" aria-haspopup=\\\"true\\\" aria-expanded=\\\"false\\\" class=\\\"dropdown-toggle\\\"><img\" + (jade.attrs({ 'src':(me.getPhotoURL()), \"class\": [('img-circle'),('img-circle-small'),('m-r-1'),((me.isTeacher() ? 'border-navy' : ''))] }, {\"class\":true,\"src\":true})) + \"/><span data-i18n=\\\"nav.my_account\\\"></span></a><ul class=\\\"dropdown-menu\\\"><li class=\\\"user-dropdown-header text-center\\\"><span class=\\\"user-level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/user/\" + (me.getSlugOrID()) + \"\") }, {\"href\":true})) + \"><img\" + (jade.attrs({ 'src':(me.getPhotoURL()), \"class\": [('img-circle'),((me.isTeacher() ? 'border-navy' : ''))] }, {\"class\":true,\"src\":true})) + \"/></a><h5>\" + (jade.escape(null == (jade.interp = me.broadName()) ? \"\" : jade.interp)) + \"</h5></li>\");\naccountLinks_mixin();\nbuf.push(\"</ul></li></ul>\");\n}\nbuf.push(\"<ul class=\\\"nav navbar-nav\\\"><li><div id=\\\"language-dropdown-wrapper\\\"><select class=\\\"language-dropdown form-control\\\"></select></div></li></ul></div></div></div></div></nav><div id=\\\"site-content-area\\\"><div class=\\\"container\\\"><div class=\\\"row verifier-row\\\"><div class=\\\"col-sm-3\\\"><p class=\\\"alert alert-success\\\">Passed: \" + (jade.escape((jade.interp = view.passed) == null ? '' : jade.interp)) + \"</p></div><div class=\\\"col-sm-3\\\"><p class=\\\"alert alert-warning\\\">Test Problem: \" + (jade.escape((jade.interp = view.problem) == null ? '' : jade.interp)) + \"</p></div><div class=\\\"col-sm-3\\\"><p class=\\\"alert alert-danger\\\">Failed: \" + (jade.escape((jade.interp = view.failed) == null ? '' : jade.interp)) + \"</p></div><div class=\\\"col-sm-3\\\"><p class=\\\"alert alert-info\\\">To Run: \" + (jade.escape((jade.interp = view.testCount - view.passed - view.problem - view.failed) == null ? '' : jade.interp)) + \"</p></div></div><div class=\\\"form form-inline\\\"><div class=\\\"row lineUnder\\\"><div class=\\\"form-group campaign-mix\\\"><input\" + (jade.attrs({ 'id':(\"careAboutFrames\"), 'type':(\"checkbox\"), 'checked':(!!view.careAboutFrames), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"checked\":true,\"disabled\":true})) + \"/><label for=\\\"careAboutFrames\\\">Check frame counts</label></div><div class=\\\"form-group campaign-mix\\\"><label for=\\\"cores\\\">Threads:</label><input\" + (jade.attrs({ 'id':(\"cores\"), 'type':(\"number\"), 'min':(\"1\"), 'max':(\"16\"), 'value':(view.cores), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"min\":true,\"max\":true,\"value\":true,\"disabled\":true})) + \"/></div></div></div>\");\nif ( view.levelsByCampaign)\n{\nbuf.push(\"<div class=\\\"form form-inline\\\"><div class=\\\"row lineUnder\\\">\");\n// iterate view.levelsByCampaign\n;(function(){\n  var $$obj = view.levelsByCampaign;\n  if ('number' == typeof $$obj.length) {\n\n    for (var campaign = 0, $$l = $$obj.length; campaign < $$l; campaign++) {\n      var campaignInfo = $$obj[campaign];\n\nbuf.push(\"<div class=\\\"form-group campaign-mix\\\">\");\nvar campaignID = \"campaign-\" + campaign + \"-checkbox\";\nbuf.push(\"<input\" + (jade.attrs({ 'id':(campaignID), 'type':(\"checkbox\"), 'checked':(campaignInfo.checked), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"checked\":true,\"disabled\":true})) + \"/><label\" + (jade.attrs({ 'for':(campaignID) }, {\"for\":true})) + \">\" + (jade.escape(null == (jade.interp = campaign + ': ' + campaignInfo.levels.length) ? \"\" : jade.interp)) + \"</label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var campaign in $$obj) {\n      $$l++;      var campaignInfo = $$obj[campaign];\n\nbuf.push(\"<div class=\\\"form-group campaign-mix\\\">\");\nvar campaignID = \"campaign-\" + campaign + \"-checkbox\";\nbuf.push(\"<input\" + (jade.attrs({ 'id':(campaignID), 'type':(\"checkbox\"), 'checked':(campaignInfo.checked), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"checked\":true,\"disabled\":true})) + \"/><label\" + (jade.attrs({ 'for':(campaignID) }, {\"for\":true})) + \">\" + (jade.escape(null == (jade.interp = campaign + ': ' + campaignInfo.levels.length) ? \"\" : jade.interp)) + \"</label></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div><div class=\\\"row\\\">\");\n// iterate view.codeLanguages\n;(function(){\n  var $$obj = view.codeLanguages;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var codeLanguage = $$obj[$index];\n\nbuf.push(\"<div class=\\\"form-group code-language-mix\\\">\");\nvar codeLanguageID = \"code-language-\" + codeLanguage.id + \"-checkbox\";\nbuf.push(\"<input\" + (jade.attrs({ 'id':(codeLanguageID), 'type':(\"checkbox\"), 'checked':(codeLanguage.checked), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"checked\":true,\"disabled\":true})) + \"/><label\" + (jade.attrs({ 'for':(codeLanguageID) }, {\"for\":true})) + \">\" + (jade.escape(null == (jade.interp = codeLanguage.id) ? \"\" : jade.interp)) + \"</label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var codeLanguage = $$obj[$index];\n\nbuf.push(\"<div class=\\\"form-group code-language-mix\\\">\");\nvar codeLanguageID = \"code-language-\" + codeLanguage.id + \"-checkbox\";\nbuf.push(\"<input\" + (jade.attrs({ 'id':(codeLanguageID), 'type':(\"checkbox\"), 'checked':(codeLanguage.checked), 'disabled':(!!view.tests) }, {\"id\":true,\"type\":true,\"checked\":true,\"disabled\":true})) + \"/><label\" + (jade.attrs({ 'for':(codeLanguageID) }, {\"for\":true})) + \">\" + (jade.escape(null == (jade.interp = codeLanguage.id) ? \"\" : jade.interp)) + \"</label></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"pull-right\\\"><button\" + (jade.attrs({ 'id':('go-button'), 'disabled':(!!view.tests), \"class\": [('btn'),('btn-primary')] }, {\"disabled\":true})) + \">Start Tests</button></div></div></div>\");\n}\nif ( view.levelsToLoad && !view.tests)\n{\nbuf.push(\"<div class=\\\"progress\\\"><div\" + (jade.attrs({ 'role':(\"progressbar\"), 'style':(\"width: \" + (100*(1 - view.levelsToLoad/view.initialLevelsToLoad)) + \"%\"), \"class\": [('progress-bar'),('progress-bar-success')] }, {\"role\":true,\"style\":true})) + \"></div></div>\");\n}\nif ( view.tests)\n{\nif ( view.levelIDs)\n{\nbuf.push(\"<div class=\\\"progress\\\"><div\" + (jade.attrs({ 'role':(\"progressbar\"), 'style':(\"width: \" + (100*view.passed/view.testCount) + \"%\"), \"class\": [('progress-bar'),('progress-bar-success')] }, {\"role\":true,\"style\":true})) + \"></div><div\" + (jade.attrs({ 'role':(\"progressbar\"), 'style':(\"width: \" + (100*view.problem/view.testCount) + \"%\"), \"class\": [('progress-bar'),('progress-bar-warning')] }, {\"role\":true,\"style\":true})) + \"></div><div\" + (jade.attrs({ 'role':(\"progressbar\"), 'style':(\"width: \" + (100*view.failed/view.testCount) + \"%\"), \"class\": [('progress-bar'),('progress-bar-danger')] }, {\"role\":true,\"style\":true})) + \"></div></div>\");\n}\n// iterate view.tests\n;(function(){\n  var $$obj = view.tests;\n  if ('number' == typeof $$obj.length) {\n\n    for (var id = 0, $$l = $$obj.length; id < $$l; id++) {\n      var test = $$obj[id];\n\nif (test.state == 'no-solution')\ncontinue;\nif ( test.level)\n{\nbuf.push(\"<div class=\\\"pull-right\\\">\");\nvar last = test.level.get('slug') + view.linksQueryString\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"/editor/verifier/\" + last), \"class\": [('btn'),('btn-primary')] }, {\"href\":true})) + \">Focus</a><a\" + (jade.attrs({ 'href':(\"/play/level/\" + last), \"class\": [('btn'),('btn-success')] }, {\"href\":true})) + \">Play</a><a\" + (jade.attrs({ 'href':(\"/editor/level/\" + last), \"class\": [('btn'),('btn-warning')] }, {\"href\":true})) + \">Edit</a><a\" + (jade.attrs({ 'data-target':('#verifier-test-' + id), 'data-toggle':(\"collapse\"), \"class\": [('btn'),('btn-default')] }, {\"data-target\":true,\"data-toggle\":true})) + \">Toggle</a></div>\");\nif ( !test.goals)\n{\nbuf.push(\"<h2 class=\\\"test-running\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nelse if ( test.isSuccessful())\n{\nbuf.push(\"<h2 class=\\\"test-success\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nelse\n{\nbuf.push(\"<h2 class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'id':('verifier-test-' + id), \"class\": [('row'),((test.isSuccessful() && id > 1 ? 'collapse' : 'collapse in'))] }, {\"class\":true,\"id\":true})) + \"><div class=\\\"col-xs-8\\\">\");\nif ( test.solution)\n{\nbuf.push(\"<pre class=\\\"solution\\\">\" + (jade.escape((jade.interp = test.solution.source) == null ? '' : jade.interp)) + \"</pre>\");\n}\nelse\n{\nbuf.push(\"<h4>Error Loading Test</h4><pre>\" + (jade.escape((jade.interp = test.error) == null ? '' : jade.interp)) + \"</pre>\");\n}\nbuf.push(\"</div><div class=\\\"col-xs-4 well\\\">\");\nif ( test.goals)\n{\nif ( test.frames == test.solution.frameCount)\n{\nbuf.push(\"<div class=\\\"test-success\\\"> Frames: \" + (jade.escape((jade.interp = test.frames) == null ? '' : jade.interp)) + \"</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> Frames: \" + (jade.escape((jade.interp = test.frames) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.frameCount) == null ? '' : jade.interp)) + \"</div>\");\n}\n// iterate test.goals || []\n;(function(){\n  var $$obj = test.goals || [];\n  if ('number' == typeof $$obj.length) {\n\n    for (var k = 0, $$l = $$obj.length; k < $$l; k++) {\n      var v = $$obj[k];\n\nif ( !test.solution.goals)\n{\nbuf.push(\"<div class=\\\"test-running\\\">? \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse if ( v.status == test.solution.goals[k])\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.goals[k]) == null ? '' : jade.interp)) + \")</div>\");\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var k in $$obj) {\n      $$l++;      var v = $$obj[k];\n\nif ( !test.solution.goals)\n{\nbuf.push(\"<div class=\\\"test-running\\\">? \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse if ( v.status == test.solution.goals[k])\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.goals[k]) == null ? '' : jade.interp)) + \")</div>\");\n}\n    }\n\n  }\n}).call(this);\n\n}\nelse\n{\nbuf.push(\"<h3>Pending....</h3>\");\n}\nif ( test.error)\n{\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape((jade.interp = test.error) == null ? '' : jade.interp)) + \"</pre>\");\n}\nif ( test.testLogs && test.testLogs.length)\n{\n// iterate test.testLogs\n;(function(){\n  var $$obj = test.testLogs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var log = $$obj[$index];\n\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = log) ? \"\" : jade.interp)) + \"</pre>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var log = $$obj[$index];\n\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = log) ? \"\" : jade.interp)) + \"</pre>\");\n    }\n\n  }\n}).call(this);\n\n}\nif ( test.userCodeProblems.length)\n{\nbuf.push(\"<h4 class=\\\"test-failed\\\">User Code Problems</h4><pre class=\\\"test-failed\\\">\" + (jade.escape((jade.interp = JSON.stringify(test.userCodeProblems, null, 2)) == null ? '' : jade.interp)) + \"</pre>\");\n}\nif ( test.simulationFrameRate)\n{\nif ( test.simulationFrameRate > 90)\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\nelse if ( test.simulationFrameRate > 30)\n{\nbuf.push(\"<div class=\\\"test-running\\\">~ \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\n}\nbuf.push(\"</div></div>\");\n}\nelse\n{\nbuf.push(\"<h1>Loading Level...</h1>\");\n}\nbuf.push(\"<!-- TODO: show last frame hash-->\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var id in $$obj) {\n      $$l++;      var test = $$obj[id];\n\nif (test.state == 'no-solution')\ncontinue;\nif ( test.level)\n{\nbuf.push(\"<div class=\\\"pull-right\\\">\");\nvar last = test.level.get('slug') + view.linksQueryString\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"/editor/verifier/\" + last), \"class\": [('btn'),('btn-primary')] }, {\"href\":true})) + \">Focus</a><a\" + (jade.attrs({ 'href':(\"/play/level/\" + last), \"class\": [('btn'),('btn-success')] }, {\"href\":true})) + \">Play</a><a\" + (jade.attrs({ 'href':(\"/editor/level/\" + last), \"class\": [('btn'),('btn-warning')] }, {\"href\":true})) + \">Edit</a><a\" + (jade.attrs({ 'data-target':('#verifier-test-' + id), 'data-toggle':(\"collapse\"), \"class\": [('btn'),('btn-default')] }, {\"data-target\":true,\"data-toggle\":true})) + \">Toggle</a></div>\");\nif ( !test.goals)\n{\nbuf.push(\"<h2 class=\\\"test-running\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nelse if ( test.isSuccessful())\n{\nbuf.push(\"<h2 class=\\\"test-success\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nelse\n{\nbuf.push(\"<h2 class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = test.level.get('name')) ? \"\" : jade.interp)) + \"<small>\" + (jade.escape(null == (jade.interp = ' in ' + test.language + '') ? \"\" : jade.interp)) + \"</small></h2>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'id':('verifier-test-' + id), \"class\": [('row'),((test.isSuccessful() && id > 1 ? 'collapse' : 'collapse in'))] }, {\"class\":true,\"id\":true})) + \"><div class=\\\"col-xs-8\\\">\");\nif ( test.solution)\n{\nbuf.push(\"<pre class=\\\"solution\\\">\" + (jade.escape((jade.interp = test.solution.source) == null ? '' : jade.interp)) + \"</pre>\");\n}\nelse\n{\nbuf.push(\"<h4>Error Loading Test</h4><pre>\" + (jade.escape((jade.interp = test.error) == null ? '' : jade.interp)) + \"</pre>\");\n}\nbuf.push(\"</div><div class=\\\"col-xs-4 well\\\">\");\nif ( test.goals)\n{\nif ( test.frames == test.solution.frameCount)\n{\nbuf.push(\"<div class=\\\"test-success\\\"> Frames: \" + (jade.escape((jade.interp = test.frames) == null ? '' : jade.interp)) + \"</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> Frames: \" + (jade.escape((jade.interp = test.frames) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.frameCount) == null ? '' : jade.interp)) + \"</div>\");\n}\n// iterate test.goals || []\n;(function(){\n  var $$obj = test.goals || [];\n  if ('number' == typeof $$obj.length) {\n\n    for (var k = 0, $$l = $$obj.length; k < $$l; k++) {\n      var v = $$obj[k];\n\nif ( !test.solution.goals)\n{\nbuf.push(\"<div class=\\\"test-running\\\">? \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse if ( v.status == test.solution.goals[k])\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.goals[k]) == null ? '' : jade.interp)) + \")</div>\");\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var k in $$obj) {\n      $$l++;      var v = $$obj[k];\n\nif ( !test.solution.goals)\n{\nbuf.push(\"<div class=\\\"test-running\\\">? \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse if ( v.status == test.solution.goals[k])\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \")</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = k) == null ? '' : jade.interp)) + \" (\" + (jade.escape((jade.interp = v.status) == null ? '' : jade.interp)) + \" vs \" + (jade.escape((jade.interp = test.solution.goals[k]) == null ? '' : jade.interp)) + \")</div>\");\n}\n    }\n\n  }\n}).call(this);\n\n}\nelse\n{\nbuf.push(\"<h3>Pending....</h3>\");\n}\nif ( test.error)\n{\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape((jade.interp = test.error) == null ? '' : jade.interp)) + \"</pre>\");\n}\nif ( test.testLogs && test.testLogs.length)\n{\n// iterate test.testLogs\n;(function(){\n  var $$obj = test.testLogs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var log = $$obj[$index];\n\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = log) ? \"\" : jade.interp)) + \"</pre>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var log = $$obj[$index];\n\nbuf.push(\"<pre class=\\\"test-failed\\\">\" + (jade.escape(null == (jade.interp = log) ? \"\" : jade.interp)) + \"</pre>\");\n    }\n\n  }\n}).call(this);\n\n}\nif ( test.userCodeProblems.length)\n{\nbuf.push(\"<h4 class=\\\"test-failed\\\">User Code Problems</h4><pre class=\\\"test-failed\\\">\" + (jade.escape((jade.interp = JSON.stringify(test.userCodeProblems, null, 2)) == null ? '' : jade.interp)) + \"</pre>\");\n}\nif ( test.simulationFrameRate)\n{\nif ( test.simulationFrameRate > 90)\n{\nbuf.push(\"<div class=\\\"test-success\\\"> \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\nelse if ( test.simulationFrameRate > 30)\n{\nbuf.push(\"<div class=\\\"test-running\\\">~ \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"test-failed\\\"> \" + (jade.escape((jade.interp = test.simulationFrameRate.toFixed(1)) == null ? '' : jade.interp)) + \" FPS</div>\");\n}\n}\nbuf.push(\"</div></div>\");\n}\nelse\n{\nbuf.push(\"<h1>Loading Level...</h1>\");\n}\nbuf.push(\"<!-- TODO: show last frame hash-->\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div></div><div class=\\\"container-fluid\\\"><div id=\\\"footer\\\" class=\\\"small\\\"><div class=\\\"container\\\"><div class=\\\"row\\\"><div class=\\\"col-sm-3\\\"><ul class=\\\"list-unstyled\\\"><li><strong>CodeCombat</strong></li><li><a href=\\\"/about\\\" data-i18n=\\\"nav.about\\\"></a></li><li><a href=\\\"/about#jobs\\\" data-i18n=\\\"nav.jobs\\\"></a></li><li><a href=\\\"http://blog.codecombat.com/\\\" data-i18n=\\\"nav.blog\\\"></a></li><li><a href=\\\"/legal\\\" data-i18n=\\\"nav.legal\\\"></a></li><li><a href=\\\"/privacy\\\" data-i18n=\\\"nav.privacy\\\"></a></li></ul></div>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<div class=\\\"col-sm-3\\\"><ul class=\\\"list-unstyled\\\"><li><strong data-i18n=\\\"nav.schools\\\"></strong></li><li><a href=\\\"/teachers/resources/faq\\\" data-i18n=\\\"teacher.educator_faq\\\"></a></li><li><a href=\\\"/teachers/classes\\\" data-i18n=\\\"nav.my_classrooms\\\"></a></li><li><a href=\\\"/teachers/resources\\\" data-i18n=\\\"nav.resource_hub\\\"></a></li><li><a href=\\\"/teachers/demo\\\" data-i18n=\\\"new_home.request_demo\\\"></a></li></ul></div>\");\n}\nbuf.push(\"<div class=\\\"col-sm-3\\\"><ul class=\\\"list-unstyled\\\"><li><strong data-i18n=\\\"nav.get_involved\\\"></strong></li><li><a href=\\\"/community\\\" data-i18n=\\\"nav.community\\\"></a></li><li><a href=\\\"/contribute\\\" data-i18n=\\\"nav.contribute\\\"></a></li>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<li><a\" + (jade.attrs({ 'href':(view.forumLink()), 'data-i18n':(\"nav.forum\") }, {\"href\":true,\"data-i18n\":true})) + \"></a></li>\");\n}\nbuf.push(\"<li><a href=\\\"/play/ladder\\\" data-i18n=\\\"game_menu.multiplayer_tab\\\"></a></li><li><a href=\\\"https://github.com/codecombat/codecombat\\\" data-i18n=\\\"nav.open_source\\\"></a></li></ul></div><div class=\\\"col-sm-3\\\"><ul class=\\\"list-unstyled\\\"><li><strong data-i18n=\\\"nav.support\\\"></strong></li>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<li><a tabindex=\\\"-1\\\" data-i18n=\\\"nav.contact\\\" class=\\\"contact-modal\\\"></a></li>\");\n}\nbuf.push(\"<li><a href=\\\"https://www.facebook.com/codecombat\\\" data-i18n=\\\"nav.facebook\\\"></a></li><li><a href=\\\"https://twitter.com/codecombat\\\" data-i18n=\\\"nav.twitter\\\"></a></li></ul></div></div></div></div><div id=\\\"final-footer\\\" class=\\\"small text-center\\\">Copyright 2016 CodeCombat. All Rights Reserved.<br class=\\\"hidden-lg hidden-md\\\"/><img src=\\\"/images/pages/base/logo.png\\\" alt=\\\"CodeCombat\\\"/><br class=\\\"hidden-lg hidden-md\\\"/>\");\nif ( !me.isStudent())\n{\nbuf.push(\"<span data-i18n=\\\"nav.help_pref\\\" class=\\\"spr\\\"></span>\");\nvar supportEmail = (me.get('preferredLanguage', true) || 'en-US').split('-')[0] == 'nl' ? 'klantenservice@codecombat.nl' : 'team@codecombat.com';\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"mailto:\" + supportEmail) }, {\"href\":true})) + \">\" + (jade.escape(null == (jade.interp = supportEmail) ? \"\" : jade.interp)) + \"</a><span data-i18n=\\\"nav.help_suff\\\" class=\\\"spl\\\"></span>\");\n}\nbuf.push(\"</div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/delta'\r\ndeltasLib = require 'core/deltas'\r\nrequire 'vendor/diffview'\r\nrequire 'vendor/difflib'\r\nrequire 'vendor/treema'\r\n\r\nTEXTDIFF_OPTIONS =\r\n  baseTextName: \"Old\"\r\n  newTextName: \"New\"\r\n  contextSize: 5\r\n  viewType: 1\r\n\r\nmodule.exports = class DeltaView extends CocoView\r\n\r\n  ###\r\n  Takes a CocoModel instance (model) and displays changes since the\r\n  last save (attributes vs _revertAttributes).\r\n\r\n  * If headModel is included, will look for and display conflicts with the changes in model.\r\n  * If comparisonModel is included, will show deltas between model and comparisonModel instead\r\n    of changes within model itself.\r\n\r\n  ###\r\n\r\n  @deltaCounter: 0\r\n  className: 'delta-view'\r\n  template: template\r\n\r\n  constructor: (options) ->\r\n    super(options)\r\n    @expandedDeltas = []\r\n    @skipPaths = options.skipPaths\r\n\r\n    for modelName in ['model', 'headModel', 'comparisonModel']\r\n      @[modelName] = options[modelName]\r\n      continue unless @[modelName] and options.loadModels\r\n      if not @[modelName].isLoaded\r\n        @[modelName] = @supermodel.loadModel(@[modelName]).model\r\n\r\n    @buildDeltas() if @supermodel.finished()\r\n\r\n  onLoaded: ->\r\n    @buildDeltas()\r\n    super()\r\n\r\n  buildDeltas: ->\r\n    if @comparisonModel\r\n      @expandedDeltas = @model.getExpandedDeltaWith(@comparisonModel)\r\n      @deltas = @model.getDeltaWith(@comparisonModel)\r\n    else\r\n      @expandedDeltas = @model.getExpandedDelta()\r\n      @deltas = @model.getDelta()\r\n    [@expandedDeltas, @skippedDeltas] = @filterDeltas(@expandedDeltas)\r\n\r\n    if @headModel\r\n      @headDeltas = @headModel.getExpandedDelta()\r\n      @headDeltas = @filterDeltas(@headDeltas)[0]\r\n      @conflicts = deltasLib.getConflicts(@headDeltas, @expandedDeltas)\r\n\r\n  filterDeltas: (deltas) ->\r\n    return [deltas, []] unless @skipPaths\r\n    for path, i in @skipPaths\r\n      @skipPaths[i] = [path] if _.isString(path)\r\n    newDeltas = []\r\n    skippedDeltas = []\r\n    for delta in deltas\r\n      skip = false\r\n      for skipPath in @skipPaths\r\n        if _.isEqual _.first(delta.dataPath, skipPath.length), skipPath\r\n          skip = true\r\n          break\r\n      if skip then skippedDeltas.push delta else newDeltas.push delta\r\n    [newDeltas, skippedDeltas]\r\n\r\n  afterRender: ->\r\n    expertView = @$el.find('.expert-view')\r\n    if expertView\r\n      expertView.html jsondiffpatch.formatters.html.format(@deltas)\r\n\r\n    DeltaView.deltaCounter += @expandedDeltas.length\r\n    deltas = @$el.find('.details')\r\n    for delta, i in deltas\r\n      deltaEl = $(delta)\r\n      deltaData = @expandedDeltas[i]\r\n      @expandDetails(deltaEl, deltaData)\r\n\r\n    conflictDeltas = @$el.find('.conflict-details')\r\n    conflicts = (delta.conflict for delta in @expandedDeltas when delta.conflict)\r\n    for delta, i in conflictDeltas\r\n      deltaEl = $(delta)\r\n      deltaData = conflicts[i]\r\n      @expandDetails(deltaEl, deltaData)\r\n\r\n  expandDetails: (deltaEl, deltaData) ->\r\n    treemaOptions = { schema: deltaData.schema or {}, readOnly: true }\r\n\r\n    if _.isObject(deltaData.left) and leftEl = deltaEl.find('.old-value')\r\n      options = _.defaults {data: _.merge({}, deltaData.left)}, treemaOptions\r\n      try\r\n        TreemaNode.make(leftEl, options).build()\r\n      catch error\r\n        console.error \"Couldn't show left details Treema for\", deltaData.left, treemaOptions\r\n\r\n    if _.isObject(deltaData.right) and rightEl = deltaEl.find('.new-value')\r\n      options = _.defaults {data: _.merge({}, deltaData.right)}, treemaOptions\r\n      try\r\n        TreemaNode.make(rightEl, options).build()\r\n      catch error\r\n        console.error \"Couldn't show right details Treema for\", deltaData.right, treemaOptions\r\n\r\n    if deltaData.action is 'text-diff'\r\n      return console.error \"Couldn't show diff for left: #{deltaData.left}, right: #{deltaData.right} of delta:\", deltaData unless deltaData.left? and deltaData.right?\r\n      left = difflib.stringAsLines deltaData.left\r\n      right = difflib.stringAsLines deltaData.right\r\n      sm = new difflib.SequenceMatcher(left, right)\r\n      opcodes = sm.get_opcodes()\r\n      el = deltaEl.find('.text-diff')\r\n      options = {baseTextLines: left, newTextLines: right, opcodes: opcodes}\r\n      args = _.defaults options, TEXTDIFF_OPTIONS\r\n      el.append(diffview.buildView(args))\r\n\r\n  getApplicableDelta: ->\r\n    delta = @model.getDelta()\r\n    delta = deltasLib.pruneConflictsFromDelta delta, @conflicts if @conflicts\r\n    delta = deltasLib.pruneExpandedDeltasFromDelta delta, @skippedDeltas if @skippedDeltas\r\n    delta\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/fork-modal'\r\nforms = require 'core/forms'\r\n\r\nmodule.exports = class ForkModal extends ModalView\r\n  id: 'fork-modal'\r\n  template: template\r\n  instant: false\r\n\r\n  events:\r\n    'click #fork-model-confirm-button': 'forkModel'\r\n    'submit form': 'forkModel'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @editorPath = options.editorPath  # like 'level' or 'thang'\r\n    @model = options.model\r\n    @modelClass = @model.constructor\r\n\r\n  forkModel: (e) ->\r\n    e.preventDefault()\r\n    @showLoading()\r\n    forms.clearFormAlerts(@$el)\r\n    newModel = new @modelClass($.extend(true, {}, @model.attributes))\r\n    newModel.unset '_id'\r\n    newModel.unset 'version'\r\n    newModel.unset 'creator'\r\n    newModel.unset 'created'\r\n    newModel.unset 'original'\r\n    newModel.unset 'parent'\r\n    newModel.unset 'i18n'\r\n    newModel.unset 'i18nCoverage'\r\n    newModel.set 'commitMessage', \"Forked from #{@model.get('name')}\"\r\n    newModel.set 'name', @$el.find('#fork-model-name').val()\r\n    if @model.schema().properties.permissions\r\n      newModel.set 'permissions', [access: 'owner', target: me.id]\r\n    newPathPrefix = \"editor/#{@editorPath}/\"\r\n    res = newModel.save(null, {type: 'POST'})  # Override PUT so we can trigger postFirstVersion logic\r\n    return unless res\r\n    res.error =>\r\n      @hideLoading()\r\n      forms.applyErrorsToForm(@$el.find('form'), JSON.parse(res.responseText))\r\n    res.success =>\r\n      @hide()\r\n      application.router.navigate(newPathPrefix + newModel.get('slug'), {trigger: true})\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/patch_modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\nauth = require 'core/auth'\r\ndeltasLib = require 'core/deltas'\r\n\r\nmodule.exports = class PatchModal extends ModalView\r\n  id: 'patch-modal'\r\n  template: template\r\n  plain: true\r\n  modalWidthPercent: 60\r\n  instant: true\r\n\r\n  events:\r\n    'click #withdraw-button': 'withdrawPatch'\r\n    'click #reject-button': 'rejectPatch'\r\n    'click #accept-button': 'acceptPatch'\r\n\r\n  shortcuts:\r\n    'a, shift+a': 'acceptPatch'\r\n    'r': 'rejectPatch'\r\n\r\n  constructor: (@patch, @targetModel, options) ->\r\n    super(options)\r\n    targetID = @patch.get('target').id\r\n    if targetID is @targetModel.id\r\n      @originalSource = @targetModel.clone(false)\r\n    else\r\n      @originalSource = new @targetModel.constructor({_id:targetID})\r\n      @supermodel.loadModel @originalSource\r\n\r\n  applyDelta: ->\r\n    @headModel = null\r\n    if @targetModel.hasWriteAccess()\r\n      @headModel = @originalSource.clone(false)\r\n      @headModel.markToRevert true\r\n      @headModel.set(@targetModel.attributes)\r\n      @headModel.loaded = true\r\n\r\n    @pendingModel = @originalSource.clone(false)\r\n    @pendingModel.markToRevert true\r\n    @deltaWorked = @pendingModel.applyDelta(@patch.get('delta'))\r\n    @pendingModel.loaded = true\r\n\r\n  render: ->\r\n    @applyDelta() if @supermodel.finished()\r\n    super()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.isPatchCreator = @patch.get('creator') is auth.me.id\r\n    c.isPatchRecipient = @targetModel.hasWriteAccess()\r\n    c.status = @patch.get 'status'\r\n    c.patch = @patch\r\n    c.deltaWorked = @deltaWorked\r\n    c\r\n\r\n  afterRender: ->\r\n    return super() unless @supermodel.finished() and @deltaWorked\r\n    @deltaView = new DeltaView({model:@pendingModel, headModel:@headModel, skipPaths: deltasLib.DOC_SKIP_PATHS})\r\n    changeEl = @$el.find('.changes-stub')\r\n    @insertSubView(@deltaView, changeEl)\r\n    super()\r\n\r\n  acceptPatch: ->\r\n    delta = @deltaView.getApplicableDelta()\r\n    @targetModel.applyDelta(delta)\r\n    @targetModel.saveBackupNow()\r\n    @patch.setStatus('accepted')\r\n    @trigger 'accepted-patch'\r\n    @hide()\r\n\r\n  rejectPatch: ->\r\n    @patch.setStatus('rejected')\r\n    @hide()\r\n\r\n  withdrawPatch: ->\r\n    @patch.setStatus('withdrawn')\r\n    @hide()\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/patches'\r\nPatchesCollection = require 'collections/PatchesCollection'\r\nnameLoader = require 'core/NameLoader'\r\nPatchModal = require './PatchModal'\r\n\r\nmodule.exports = class PatchesView extends CocoView\r\n  template: template\r\n  className: 'patches-view'\r\n  status: 'pending'\r\n\r\n  events:\r\n    'change .status-buttons': 'onStatusButtonsChanged'\r\n    'click .patch-row': 'openPatchModal'\r\n\r\n  constructor: (@model, options) ->\r\n    super(options)\r\n    @initPatches()\r\n\r\n  initPatches: ->\r\n    @startedLoading = false\r\n    @patches = @model.fetchPatchesWithStatus()\r\n\r\n  load: ->\r\n    @initPatches()\r\n    @patches = @model.fetchPatchesWithStatus(@status, {cache: false})\r\n    @supermodel.trackCollection(@patches)\r\n    @listenTo @patches, 'sync', @onPatchesLoaded\r\n\r\n  onPatchesLoaded: ->\r\n    ids = (p.get('creator') for p in @patches.models)\r\n    jqxhrOptions = nameLoader.loadNames ids\r\n    @supermodel.addRequestResource('user_names', jqxhrOptions).load() if jqxhrOptions\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    patch.userName = nameLoader.getName(patch.get('creator')) for patch in @patches.models\r\n    c.patches = @patches.models\r\n    c.status\r\n    c\r\n\r\n  afterRender: ->\r\n    @$el.find(\".#{@status}\").addClass 'active'\r\n    super()\r\n\r\n  onStatusButtonsChanged: (e) ->\r\n    @status = $(e.target).val()\r\n    @reloadPatches()\r\n\r\n  reloadPatches: ->\r\n    @supermodel.resetProgress()\r\n    @load()\r\n    @render()\r\n\r\n  openPatchModal: (e) ->\r\n    row = $(e.target).closest '.patch-row'\r\n    patch = _.find @patches.models, {id: row.data('patch-id')}\r\n    modal = new PatchModal(patch, @model)\r\n    @openModalView(modal)\r\n    @listenTo modal, 'accepted-patch', -> @trigger 'accepted-patch'\r\n    @listenTo modal, 'hide', ->\r\n      f = => @reloadPatches()\r\n      setTimeout(f, 400)\r\n      @stopListening modal\r\n","RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/achievement/edit'\r\nAchievement = require 'models/Achievement'\r\nLevel = require 'models/Level'\r\nAchievementPopup = require 'views/core/AchievementPopup'\r\nConfirmModal = require 'views/core/ConfirmModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nerrors = require 'core/errors'\r\napp = require 'core/application'\r\nnodes = require 'views/editor/level/treema_nodes'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class AchievementEditView extends RootView\r\n  id: 'editor-achievement-edit-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #save-button': 'saveAchievement'\r\n    'click #recalculate-button': 'confirmRecalculation'\r\n    'click #recalculate-all-button': 'confirmAllRecalculation'\r\n    'click #delete-button': 'confirmDeletion'\r\n\r\n  constructor: (options, @achievementID) ->\r\n    super options\r\n    @achievement = new Achievement(_id: @achievementID)\r\n    @achievement.saveBackups = true\r\n    @supermodel.trackRequest @achievement.fetch()\r\n    \r\n    # load level names so they're available to treema nodes\r\n    @listenToOnce @achievement, 'sync', ->\r\n      for levelOriginal in @achievement.get('rewards')?.levels ? []\r\n        level = new Level()\r\n        @supermodel.trackRequest level.fetchLatestVersion(levelOriginal, {data: {project:'name,version,original'}})\r\n        level.once 'sync', (level) => @supermodel.registerModel(level)\r\n        \r\n    @pushChangesToPreview = _.throttle(@pushChangesToPreview, 500)\r\n\r\n  onLoaded: ->\r\n    super()\r\n    @buildTreema()\r\n    @listenTo @achievement, 'change', =>\r\n      @achievement.updateI18NCoverage()\r\n      @treema.set('/', @achievement.attributes)\r\n\r\n  buildTreema: ->\r\n    return if @treema? or (not @achievement.loaded)\r\n    data = $.extend(true, {}, @achievement.attributes)\r\n    options =\r\n      data: data\r\n      filePath: \"db/achievement/#{@achievement.get('_id')}\"\r\n      schema: Achievement.schema\r\n      readOnly: me.get('anonymous')\r\n      callbacks:\r\n        change: @pushChangesToPreview\r\n      nodeClasses:\r\n        'thang-type': nodes.ThangTypeNode\r\n        'item-thang-type': nodes.ItemThangTypeNode\r\n      supermodel: @supermodel\r\n    @treema = @$el.find('#achievement-treema').treema(options)\r\n    @treema.build()\r\n    @treema.childrenTreemas.rewards?.open(3)\r\n    @pushChangesToPreview()\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @showReadOnly() if me.get('anonymous')\r\n    @pushChangesToPreview()\r\n    @patchesView = @insertSubView(new PatchesView(@achievement), @$el.find('.patches-view'))\r\n    @patchesView.load()\r\n\r\n  pushChangesToPreview: =>\r\n    return unless @treema\r\n    @$el.find('#achievement-view').empty()\r\n    for key, value of @treema.data\r\n      @achievement.set key, value\r\n    earned = get: (key) => {earnedPoints: @achievement.get('worth'), previouslyAchievedAmount: 0}[key]\r\n    popup = new AchievementPopup achievement: @achievement, earnedAchievement: earned, popup: false, container: $('#achievement-view')\r\n\r\n  openSaveModal: ->\r\n    'Maybe later' # TODO patch patch patch\r\n\r\n  saveAchievement: (e) ->\r\n    @treema.endExistingEdits()\r\n    for key, value of @treema.data\r\n      @achievement.set(key, value)\r\n\r\n    res = @achievement.save()\r\n\r\n    res.error (collection, response, options) =>\r\n      console.error response\r\n\r\n    res.success =>\r\n      if window.achievementSavedCallback\r\n        # CampaignEditor is using this as a child, so let it know that we have changed something (and don't reload)\r\n        window.achievementSavedCallback achievement: @achievement\r\n      else\r\n        url = \"/editor/achievement/#{@achievement.get('slug') or @achievement.id}\"\r\n        document.location.href = url\r\n\r\n  confirmRecalculation: (e, all=false) ->\r\n    renderData =\r\n      title: 'Are you really sure?'\r\n      body: \"This will trigger recalculation of #{if all then 'all achievements' else 'the achievement'} for all users. Are you really sure you want to go down this path?\"\r\n      decline: 'Not really'\r\n      confirm: 'Definitely'\r\n\r\n    confirmModal = new ConfirmModal renderData\r\n    confirmModal.on 'confirm', @recalculateAchievement\r\n    @recalculatingAll = all\r\n    @openModalView confirmModal\r\n\r\n  confirmAllRecalculation: (e) ->\r\n    @confirmRecalculation e, true\r\n\r\n  confirmDeletion: ->\r\n    renderData =\r\n      title: 'Are you really sure?'\r\n      body: 'This will completely delete the achievement, potentially breaking a lot of stuff you don\\'t want breaking. Are you entirely sure?'\r\n      decline: 'Not really'\r\n      confirm: 'Definitely'\r\n\r\n    confirmModal = new ConfirmModal renderData\r\n    confirmModal.on 'confirm', @deleteAchievement\r\n    @openModalView confirmModal\r\n\r\n  recalculateAchievement: =>\r\n    data = if @recalculatingAll then {} else {achievements: [@achievement.get('slug') or @achievement.get('_id')]}\r\n    $.ajax\r\n      data: JSON.stringify data\r\n      success: (data, status, jqXHR) ->\r\n        noty\r\n          timeout: 5000\r\n          text: 'Recalculation process started'\r\n          type: 'success'\r\n          layout: 'topCenter'\r\n      error: (jqXHR, status, error) ->\r\n        console.error jqXHR\r\n        noty\r\n          timeout: 5000\r\n          text: \"Starting recalculation process failed with error code #{jqXHR.status}\"\r\n          type: 'error'\r\n          layout: 'topCenter'\r\n      url: '/admin/earned.achievement/recalculate'\r\n      type: 'POST'\r\n      contentType: 'application/json'\r\n\r\n  deleteAchievement: =>\r\n    console.debug 'deleting'\r\n    $.ajax\r\n      type: 'DELETE'\r\n      success: ->\r\n        noty\r\n          timeout: 5000\r\n          text: 'Aaaand it\\'s gone.'\r\n          type: 'success'\r\n          layout: 'topCenter'\r\n        _.delay ->\r\n          app.router.navigate '/editor/achievement', trigger: true\r\n        , 500\r\n      error: (jqXHR, status, error) ->\r\n        console.error jqXHR\r\n        timeout: 5000\r\n        text: \"Deleting achievement failed with error code #{jqXHR.status}\"\r\n        type: 'error'\r\n        layout: 'topCenter'\r\n      url: \"/db/achievement/#{@achievement.id}\"\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class AchievementSearchView extends SearchView\r\n  id: 'editor-achievement-home-view'\r\n  modelLabel: 'Achievement'\r\n  model: require 'models/Achievement'\r\n  modelURL: '/db/achievement'\r\n  tableTemplate: require 'templates/editor/achievement/table'\r\n  projection: ['name', 'description', 'collection', 'slug']\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.achievement_title'\r\n    context.currentNew = 'editor.new_achievement_title'\r\n    context.currentNewSignup = 'editor.new_achievement_title_login'\r\n    context.currentSearch = 'editor.achievement_search_title'\r\n    context.newModelsAdminOnly = true\r\n    context.unauthorized = true unless me.isAdmin() or me.isArtisan()\r\n    context\r\n","RootView = require 'views/core/RootView'\r\nVersionHistoryView = require './ArticleVersionsModal'\r\ntemplate = require 'templates/editor/article/edit'\r\nArticle = require 'models/Article'\r\nSaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nrequire 'views/modal/RevertModal'\r\nrequire 'vendor/treema'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class ArticleEditView extends RootView\r\n  id: 'editor-article-edit-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #preview-button': 'openPreview'\r\n    'click #history-button': 'showVersionHistory'\r\n    'click #save-button': 'openSaveModal'\r\n\r\n  constructor: (options, @articleID) ->\r\n    super options\r\n    @article = new Article({_id: @articleID})\r\n    @article.saveBackups = true\r\n    @supermodel.loadModel @article\r\n    @pushChangesToPreview = _.throttle(@pushChangesToPreview, 500)\r\n\r\n  onLoaded: ->\r\n    super()\r\n    @buildTreema()\r\n    @listenTo @article, 'change', =>\r\n      @article.updateI18NCoverage()\r\n      @treema.set('/', @article.attributes)\r\n\r\n  buildTreema: ->\r\n    return if @treema? or (not @article.loaded)\r\n    unless @article.attributes.body\r\n      @article.set('body', '')\r\n    data = $.extend(true, {}, @article.attributes)\r\n    options =\r\n      data: data\r\n      filePath: \"db/thang.type/#{@article.get('original')}\"\r\n      schema: Article.schema\r\n      readOnly: me.get('anonymous')\r\n      callbacks:\r\n        change: @pushChangesToPreview\r\n    @treema = @$el.find('#article-treema').treema(options)\r\n    @treema.build()\r\n\r\n  pushChangesToPreview: =>\r\n    for key, value of @treema.data\r\n      @article.set(key, value)\r\n    return unless @treema and @preview\r\n    m = marked(@treema.data.body)\r\n    b = $(@preview.document.body)\r\n    onLoadHandler = =>\r\n      if b.find('#insert').length == 1\r\n        b.find('#insert').html(m)\r\n        b.find('#title').text(@treema.data.name)\r\n        clearInterval(id)\r\n    id = setInterval(onLoadHandler, 100)\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @showReadOnly() if me.get('anonymous')\r\n    @patchesView = @insertSubView(new PatchesView(@article), @$el.find('.patches-view'))\r\n    @patchesView.load()\r\n\r\n  openPreview: ->\r\n    if not @preview or @preview.closed\r\n      @preview = window.open('/editor/article/preview', 'preview', 'height=800,width=600')\r\n    @preview.focus() if window.focus\r\n    @preview.onload = => @pushChangesToPreview()\r\n    return false\r\n\r\n  openSaveModal: ->\r\n    modal = new SaveVersionModal({model: @article, noNewMajorVersions: true})\r\n    @openModalView(modal)\r\n    @listenToOnce modal, 'save-new-version', @saveNewArticle\r\n    @listenToOnce modal, 'hidden', -> @stopListening(modal)\r\n\r\n  saveNewArticle: (e) ->\r\n    @treema.endExistingEdits()\r\n    for key, value of @treema.data\r\n      @article.set(key, value)\r\n\r\n    @article.set('commitMessage', e.commitMessage)\r\n    res = @article.saveNewMinorVersion()\r\n    return unless res\r\n    modal = @$el.find('#save-version-modal')\r\n    @enableModalInProgress(modal)\r\n\r\n    res.error =>\r\n      @disableModalInProgress(modal)\r\n\r\n    res.success =>\r\n      @article.clearBackup()\r\n      modal.modal('hide')\r\n      url = \"/editor/article/#{@article.get('slug') or @article.id}\"\r\n      document.location.href = url\r\n\r\n  showVersionHistory: (e) ->\r\n    versionHistoryView = new VersionHistoryView article: @article, @articleID\r\n    @openModalView versionHistoryView\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n","RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/article/preview'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class ArticlePreviewView extends RootView\r\n  id: 'editor-article-preview-view'\r\n  template: template\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class ArticleSearchView extends SearchView\r\n  id: 'editor-article-home-view'\r\n  modelLabel: 'Article'\r\n  model: require 'models/Article'\r\n  modelURL: '/db/article'\r\n  tableTemplate: require 'templates/editor/article/table'\r\n  page: 'article'\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.article_title'\r\n    context.currentNew = 'editor.new_article_title'\r\n    context.currentNewSignup = 'editor.new_article_title_login'\r\n    context.currentSearch = 'editor.article_search_title'\r\n    context.newModelsAdminOnly = true\r\n    @$el.i18n()\r\n    context\r\n","VersionsModal = require 'views/editor/modal/VersionsModal'\r\n\r\nmodule.exports = class ArticleVersionsModal extends VersionsModal\r\n  id: 'editor-article-versions-view'\r\n  url: '/db/article/'\r\n  page: 'article'\r\n\r\n  constructor: (options, @ID) ->\r\n    super options, @ID, require 'models/Article'\r\n","template = require 'templates/editor/campaign/campaign-analytics-modal'\r\nutils = require 'core/utils'\r\nrequire 'vendor/d3'\r\nModalView = require 'views/core/ModalView'\r\n\r\n# TODO: jquery-ui datepicker doesn't work well in this view\r\n# TODO: the date format handling is confusing (yyyy-mm-dd <=> yyyymmdd)\r\n\r\nmodule.exports = class CampaignAnalyticsModal extends ModalView\r\n  id: 'campaign-analytics-modal'\r\n  template: template\r\n  plain: true\r\n\r\n  events:\r\n    'click #reload-button': 'onClickReloadButton'\r\n    'dblclick .level': 'onDblClickLevel'\r\n    'change #option-show-left-game': 'updateShowLeftGame'\r\n    'change #option-show-subscriptions': 'updateShowSubscriptions'\r\n\r\n  constructor: (options, @campaignHandle, @campaignCompletions) ->\r\n    super options\r\n    @showLeftGame = true\r\n    @showSubscriptions = true\r\n    @getCampaignAnalytics() if me.isAdmin()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.showLeftGame = @showLeftGame\r\n    c.showSubscriptions = @showSubscriptions\r\n    c.campaignCompletions = @campaignCompletions\r\n    c\r\n\r\n  afterRender: ->\r\n    super()\r\n    $(\"#input-startday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    $(\"#input-endday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    @addCompletionLineGraphs()\r\n\r\n  updateShowLeftGame: ->\r\n    @showLeftGame = @$el.find('#option-show-left-game').prop('checked')\r\n    @render()\r\n\r\n  updateShowSubscriptions: ->\r\n    @showSubscriptions = @$el.find('#option-show-subscriptions').prop('checked')\r\n    @render()\r\n\r\n  onClickReloadButton: () =>\r\n    startDay = $('#input-startday').val()\r\n    endDay = $('#input-endday').val()\r\n    delete @campaignCompletions.levels\r\n    @campaignCompletions.startDay = startDay\r\n    @campaignCompletions.endDay = endDay\r\n    @render()\r\n    @getCampaignAnalytics startDay, endDay\r\n\r\n  onDblClickLevel: (e) ->\r\n    row = $(e.target).parents('.level')\r\n    Backbone.Mediator.publish 'editor:campaign-analytics-modal-closed', targetLevelSlug: row.data 'level-slug'\r\n    @hide()\r\n\r\n  addCompletionLineGraphs: ->\r\n    # TODO: no line graphs if some levels without completion rates?\r\n    return unless @campaignCompletions.levels\r\n    for level in @campaignCompletions.levels\r\n      days = []\r\n      for day of level['days']\r\n        continue unless level['days'][day].started > 0\r\n        days.push\r\n          day: day\r\n          rate: level['days'][day].finished / level['days'][day].started\r\n          count: level['days'][day].started\r\n      days.sort (a, b) -> a.day - b.day\r\n      data = []\r\n      for i in [0...days.length]\r\n        data.push\r\n          x: i\r\n          y: days[i].rate\r\n          c: days[i].count\r\n      @addLineGraph '#background' + level.level, data\r\n\r\n  addLineGraph: (containerSelector, lineData, lineColor='green', min=0, max=1.0) ->\r\n    # Add a line chart to the given container\r\n    # Adjust stroke-weight based on segment count: width 0.3 to 3.0 for counts roughly 100 to 10000\r\n    # TODO: Move this to a utility library\r\n    vis = d3.select(containerSelector)\r\n    width = $(containerSelector).width()\r\n    height = $(containerSelector).height()\r\n    xRange = d3.scale.linear().range([0, width]).domain([d3.min(lineData, (d) -> d.x), d3.max(lineData, (d) -> d.x)])\r\n    yRange = d3.scale.linear().range([height, 0]).domain([min, max])\r\n    lines = []\r\n    for i in [0...lineData.length-1]\r\n      lines.push \r\n        x1: xRange(lineData[i].x)\r\n        y1: yRange(lineData[i].y)\r\n        x2: xRange(lineData[i + 1].x)\r\n        y2: yRange(lineData[i + 1].y)\r\n        strokeWidth: Math.min(3, Math.max(0.3, Math.log(lineData[i].c/10)/2))\r\n    vis.selectAll('.line')\r\n      .data(lines)\r\n      .enter()\r\n      .append(\"line\")\r\n      .attr(\"x1\", (d) -> d.x1)\r\n      .attr(\"y1\", (d) -> d.y1)\r\n      .attr(\"x2\", (d) -> d.x2)\r\n      .attr(\"y2\", (d) -> d.y2)\r\n      .style(\"stroke-width\", (d) -> d.strokeWidth)\r\n      .style(\"stroke\", lineColor)\r\n\r\n  getCampaignAnalytics: (startDay, endDay) =>\r\n    if startDay?\r\n      startDayDashed = startDay\r\n      startDay = startDay.replace(/-/g, '')\r\n    else\r\n      startDay = utils.getUTCDay -14\r\n      startDayDashed = \"#{startDay[0..3]}-#{startDay[4..5]}-#{startDay[6..7]}\"\r\n    if endDay?\r\n      endDayDashed = endDay\r\n      endDay = endDay.replace(/-/g, '')\r\n    else \r\n      endDay = utils.getUTCDay -1\r\n      endDayDashed = \"#{endDay[0..3]}-#{endDay[4..5]}-#{endDay[6..7]}\"\r\n    @campaignCompletions.startDay = startDayDashed\r\n    @campaignCompletions.endDay = endDayDashed\r\n\r\n    # Chain these together so we can calculate relative metrics (e.g. left game per second)\r\n    @getCampaignLevelCompletions startDay, endDay, () =>\r\n      @render?()\r\n      @getCompaignLevelDrops startDay, endDay, () =>\r\n        @render?()\r\n        @getCampaignAveragePlaytimes startDayDashed, endDayDashed, () =>\r\n          @render?()\r\n          @getCampaignLevelSubscriptions startDay, endDay, () =>\r\n            @render?()\r\n\r\n  getCampaignAveragePlaytimes: (startDay, endDay, doneCallback) =>\r\n    # Fetch level average playtimes\r\n    # Needs date format yyyy-mm-dd\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getCampaignAveragePlaytimes success', data\r\n      levelAverages = {}\r\n      maxPlaytime = 0\r\n      for item in data\r\n        levelAverages[item.level] ?= []\r\n        levelAverages[item.level].push item.average\r\n      for level in @campaignCompletions.levels\r\n        if levelAverages[level.level]\r\n          if levelAverages[level.level].length > 0\r\n            total = _.reduce levelAverages[level.level], ((sum, num) -> sum + num)\r\n            level.averagePlaytime = total / levelAverages[level.level].length\r\n            maxPlaytime = level.averagePlaytime if maxPlaytime < level.averagePlaytime\r\n            if level.averagePlaytime > 0 and level.dropped > 0\r\n              level.droppedPerSecond = level.dropped / level.averagePlaytime\r\n          else\r\n            level.averagePlaytime = 0.0\r\n\r\n      addPlaytimePercentage = (item) ->\r\n        item.playtimePercentage = Math.round(item.averagePlaytime / maxPlaytime * 100.0) unless maxPlaytime is 0\r\n        item\r\n      @campaignCompletions.levels = _.map @campaignCompletions.levels, addPlaytimePercentage, @\r\n\r\n      sortedLevels = _.cloneDeep @campaignCompletions.levels\r\n      sortedLevels = _.filter sortedLevels, ((a) -> a.droppedPerSecond > 0), @\r\n      sortedLevels.sort (a, b) -> b.droppedPerSecond - a.droppedPerSecond\r\n      @campaignCompletions.top3DropPerSecond = _.pluck sortedLevels[0..2], 'level'\r\n      doneCallback()\r\n\r\n    levelSlugs = _.pluck @campaignCompletions.levels, 'level'\r\n\r\n    request = @supermodel.addRequestResource 'playtime_averages', {\r\n      url: '/db/level/-/playtime_averages'\r\n      data: {startDay: startDay, endDay: endDay, slugs: levelSlugs}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getCampaignLevelCompletions: (startDay, endDay, doneCallback) =>\r\n    # Needs date format yyyymmdd\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getCampaignLevelCompletions success', data\r\n      countCompletions = (item) ->\r\n        item.started = _.reduce item.days, ((result, current) -> result + current.started), 0\r\n        item.finished = _.reduce item.days, ((result, current) -> result + current.finished), 0\r\n        item.completionRate = if item.started > 0 then item.finished / item.started * 100 else 0.0\r\n        item\r\n      addUserRemaining = (item) ->\r\n        item.usersRemaining = Math.round(item.started / maxStarted * 100.0) unless maxStarted is 0\r\n        item\r\n\r\n      @campaignCompletions.levels = _.map data, countCompletions, @\r\n      if @campaignCompletions.levels.length > 0 \r\n        maxStarted = (_.max @campaignCompletions.levels, ((a) -> a.started)).started\r\n      else\r\n        maxStarted = 0\r\n      @campaignCompletions.levels = _.map @campaignCompletions.levels, addUserRemaining, @\r\n\r\n      sortedLevels = _.cloneDeep @campaignCompletions.levels\r\n      sortedLevels = _.filter sortedLevels, ((a) -> a.finished >= 10), @\r\n      if sortedLevels.length >= 3\r\n        sortedLevels.sort (a, b) -> b.completionRate - a.completionRate\r\n        @campaignCompletions.top3 = _.pluck sortedLevels[0..2], 'level'\r\n        @campaignCompletions.bottom3 = _.pluck sortedLevels[sortedLevels.length - 4...sortedLevels.length - 1], 'level'\r\n\r\n      doneCallback()\r\n\r\n    # TODO: Why do we need this url dash?\r\n    request = @supermodel.addRequestResource 'campaign_completions', {\r\n      url: '/db/analytics_perday/-/campaign_completions'\r\n      data: {startDay: startDay, endDay: endDay, slug: @campaignHandle}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getCompaignLevelDrops: (startDay, endDay, doneCallback) =>\r\n    # Fetch level drops\r\n    # Needs date format yyyymmdd\r\n    success = (data) =>\r\n      return if @destroyed\r\n      # console.log 'getCompaignLevelDrops success', data\r\n      levelDrops = {}\r\n      for item in data\r\n        levelDrops[item.level] ?= item.dropped\r\n      for level in @campaignCompletions.levels\r\n        level.dropped = levelDrops[level.level] ? 0\r\n        level.dropPercentage = if level.started > 0 then level.dropped / level.started * 100 else 0.0\r\n\r\n      sortedLevels = _.cloneDeep @campaignCompletions.levels\r\n      sortedLevels = _.filter sortedLevels, ((a) -> a.dropPercentage > 0), @\r\n      if sortedLevels.length >= 3\r\n        sortedLevels.sort (a, b) -> b.dropPercentage - a.dropPercentage\r\n        @campaignCompletions.top3DropPercentage = _.pluck sortedLevels[0..2], 'level'\r\n      doneCallback()\r\n\r\n    return doneCallback() unless @campaignCompletions?.levels?\r\n    levelSlugs = _.pluck @campaignCompletions.levels, 'level'\r\n\r\n    request = @supermodel.addRequestResource 'level_drops', {\r\n      url: '/db/analytics_perday/-/level_drops'\r\n      data: {startDay: startDay, endDay: endDay, slugs: levelSlugs}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n    \r\n  getCampaignLevelSubscriptions: (startDay, endDay, doneCallback) =>\r\n    # Fetch level subscriptions\r\n    # Needs date format yyyymmdd\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getCampaignLevelSubscriptions success', data\r\n      levelSubs = {}\r\n      for item in data\r\n        levelSubs[item.level] = shown: item.shown, purchased: item.purchased\r\n      for level in @campaignCompletions.levels\r\n        level.subsShown = levelSubs[level.level]?.shown\r\n        level.subsPurchased = levelSubs[level.level]?.purchased\r\n      doneCallback()\r\n\r\n    return doneCallback() unless @campaignCompletions?.levels?\r\n    levelSlugs = _.pluck @campaignCompletions.levels, 'level'\r\n\r\n    request = @supermodel.addRequestResource 'campaign_subscriptions', {\r\n      url: '/db/analytics_perday/-/level_subscriptions'\r\n      data: {startDay: startDay, endDay: endDay, slugs: levelSlugs}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n","RootView = require 'views/core/RootView'\r\nCampaign = require 'models/Campaign'\r\nLevel = require 'models/Level'\r\nAchievement = require 'models/Achievement'\r\nThangType = require 'models/ThangType'\r\nCampaignView = require 'views/play/CampaignView'\r\nCocoCollection = require 'collections/CocoCollection'\r\ntreemaExt = require 'core/treema-ext'\r\nutils = require 'core/utils'\r\nRelatedAchievementsCollection = require 'collections/RelatedAchievementsCollection'\r\nCampaignAnalyticsModal = require './CampaignAnalyticsModal'\r\nCampaignLevelView = require './CampaignLevelView'\r\nSaveCampaignModal = require './SaveCampaignModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\n\r\nrequire 'game-libraries'\r\n\r\nachievementProject = ['related', 'rewards', 'name', 'slug']\r\nthangTypeProject = ['name', 'original']\r\n\r\nmodule.exports = class CampaignEditorView extends RootView\r\n  id: \"campaign-editor-view\"\r\n  template: require 'templates/editor/campaign/campaign-editor-view'\r\n  className: 'editor'\r\n\r\n  events:\r\n    'click #analytics-button': 'onClickAnalyticsButton'\r\n    'click #save-button': 'onClickSaveButton'\r\n    'click #patches-button': 'onClickPatches'\r\n\r\n  subscriptions:\r\n    'editor:campaign-analytics-modal-closed' : 'onAnalyticsModalClosed'\r\n\r\n  constructor: (options, @campaignHandle) ->\r\n    super(options)\r\n    @campaign = new Campaign({_id:@campaignHandle})\r\n    @supermodel.loadModel(@campaign)\r\n    @listenToOnce @campaign, 'sync', (model, response, jqXHR) ->\r\n      @campaign.set '_id', response._id\r\n      @campaign.url = -> '/db/campaign/' + @id\r\n\r\n    # Save reference to data used by anlytics modal so it persists across modal open/closes.\r\n    @campaignAnalytics = {}\r\n\r\n    @levels = new CocoCollection([], {\r\n      model: Level\r\n      url: \"/db/campaign/#{@campaignHandle}/levels\"\r\n      project: Campaign.denormalizedLevelProperties\r\n    })\r\n    @supermodel.loadCollection(@levels, 'levels')\r\n\r\n    @achievements = new CocoCollection([], {\r\n      model: Achievement\r\n      url: \"/db/campaign/#{@campaignHandle}/achievements\"\r\n      project: achievementProject\r\n    })\r\n    @supermodel.loadCollection(@achievements, 'achievements')\r\n\r\n    @toSave = new Backbone.Collection()\r\n    @listenToOnce @campaign ,'sync', @loadThangTypeNames\r\n    @listenToOnce @campaign, 'sync', @onFundamentalLoaded\r\n    @listenToOnce @levels, 'sync', @onFundamentalLoaded\r\n    @listenToOnce @achievements, 'sync', @onFundamentalLoaded\r\n\r\n  onLeaveMessage: ->\r\n    for model in @toSave.models\r\n      diff = model.getDelta()\r\n      if _.size(diff)\r\n        console.log 'model, diff', model, diff\r\n        return 'You have changes!'\r\n\r\n  loadThangTypeNames: ->\r\n    # Load the names of the ThangTypes that this level's Treema nodes might want to display.\r\n    originals = []\r\n    for level in _.values(@campaign.get('levels'))\r\n      originals = originals.concat(_.values(level.requiredGear)) if level.requiredGear\r\n      originals = originals.concat(_.values(level.restrictedGear)) if level.restrictedGear\r\n    originals = _.uniq _.flatten originals\r\n    for original in originals\r\n      thangType = new ThangType()\r\n      thangType.setProjection(thangTypeProject)\r\n      thangType.setURL(\"/db/thang.type/#{original}/version\")\r\n      @supermodel.loadModel(thangType)\r\n\r\n  onFundamentalLoaded: ->\r\n    # Load any levels which haven't been denormalized into our campaign.\r\n    return unless @campaign.loaded and @levels.loaded and @achievements.loaded\r\n    @loadMissingLevelsAndRelatedModels()\r\n    \r\n  loadMissingLevelsAndRelatedModels: ->\r\n    promises = []\r\n    for level in _.values(@campaign.get('levels'))\r\n      continue if model = @levels.findWhere(original: level.original)\r\n      model = new Level({})\r\n      model.setProjection Campaign.denormalizedLevelProperties\r\n      model.setURL(\"/db/level/#{level.original}/version\")\r\n      levelResource = @supermodel.loadModel(model)\r\n      @levels.add levelResource.model\r\n      # Handle SuperModel's caching, and make sure loaded levels save and notice changes properly\r\n      if levelResource.jqxhr\r\n        levelResource.model.once('sync', ->\r\n          @setURL(\"/db/level/#{@id}\")\r\n          @markToRevert()\r\n        )\r\n        promises.push(levelResource.jqxhr)\r\n      achievements = new RelatedAchievementsCollection level.original\r\n      achievements.setProjection achievementProject\r\n      achievementsResource = @supermodel.loadCollection(achievements)\r\n      promises.push(achievementsResource.jqxhr)\r\n      @listenToOnce achievements, 'sync', (achievementsLoaded) ->\r\n        @achievements.add(achievementsLoaded.models)\r\n    return Promise.resolve($.when(promises...))\r\n\r\n  onLoaded: ->\r\n    @updateCampaignLevels()\r\n    @campaignView.render()\r\n    super()\r\n\r\n  updateCampaignLevels: ->\r\n    @toSave.add @campaign if @campaign.hasLocalChanges()\r\n    campaignLevels = $.extend({}, @campaign.get('levels'))\r\n    for level, levelIndex in @levels.models\r\n      levelOriginal = level.get('original')\r\n      campaignLevel = campaignLevels[levelOriginal]\r\n      continue if not campaignLevel\r\n      $.extend campaignLevel, _.pick(level.attributes, Campaign.denormalizedLevelProperties)\r\n      # TODO: better way for it to remember when we intend to not specifically require/restrict gear any more\r\n      delete campaignLevel.requiredGear if not level.attributes.requiredGear\r\n      delete campaignLevel.restrictedGear if not level.attributes.restrictedGear\r\n      campaignLevel.rewards = @formatRewards level\r\n      # Save campaign to level if it's a main 'hero' campaign so HeroVictoryModal knows where to return.\r\n      # (Not if it's a defaulted, typeless campaign like game-dev-hoc or auditions.)\r\n      campaignLevel.campaign = @campaign.get 'slug' if @campaign.get('type') is 'hero'\r\n      # Save campaign index to level if it's a course campaign, since we show linear level order numbers for course levels.\r\n      campaignLevel.campaignIndex = (@levels.models.length - levelIndex - 1) if @campaign.get('type', true) is 'course'\r\n      campaignLevels[levelOriginal] = campaignLevel\r\n\r\n    @campaign.set('levels', campaignLevels)\r\n\r\n    for level in _.values campaignLevels\r\n      continue if /test/.test @campaign.get('slug')  # Don't overwrite level stuff for testing Campaigns\r\n      model = @levels.findWhere {original: level.original}\r\n      # do not propagate campaignIndex for non-course campaigns\r\n      propsToPropagate = Campaign.denormalizedLevelProperties\r\n      if @campaign.get('type') isnt 'course'\r\n        propsToPropagate = _.without(propsToPropagate, 'campaignIndex')\r\n      for key in propsToPropagate\r\n        model.set key, level[key] if model.get(key) isnt level[key]\r\n      @toSave.add model if model.hasLocalChanges()\r\n\r\n  formatRewards: (level) ->\r\n    achievements = @achievements.where related: level.get('original')\r\n    rewards = []\r\n    for achievement in achievements\r\n      for rewardType, rewardArray of achievement.get('rewards')\r\n        for reward in rewardArray\r\n          rewardObject = { achievement: achievement.id }\r\n\r\n          if rewardType is 'heroes'\r\n            rewardObject.hero = reward\r\n            thangType = new ThangType({}, {project: thangTypeProject})\r\n            thangType.setURL(\"/db/thang.type/#{reward}/version\")\r\n            @supermodel.loadModel(thangType)\r\n\r\n          if rewardType is 'levels'\r\n            rewardObject.level = reward\r\n            if not @levels.findWhere({original: reward})\r\n              level = new Level({}, {project: Campaign.denormalizedLevelProperties})\r\n              level.setURL(\"/db/level/#{reward}/version\")\r\n              @supermodel.loadModel(level)\r\n\r\n          if rewardType is 'items'\r\n            rewardObject.item = reward\r\n            thangType = new ThangType({}, {project: thangTypeProject})\r\n            thangType.setURL(\"/db/thang.type/#{reward}/version\")\r\n            @supermodel.loadModel(thangType)\r\n\r\n          rewards.push rewardObject\r\n    rewards\r\n\r\n  propagateCampaignIndexes: ->\r\n    campaignLevels = $.extend({}, @campaign.get('levels'))\r\n    index = 0\r\n    for levelOriginal, campaignLevel of campaignLevels\r\n      if @campaign.get('type') is 'course'\r\n        level = @levels.findWhere({original: levelOriginal})\r\n        if level and level.get('campaignIndex') isnt index\r\n          level.set('campaignIndex', index)\r\n      campaignLevel.campaignIndex = index\r\n      index += 1\r\n      @campaign.set('levels', campaignLevels)\r\n\r\n  onClickPatches: (e) ->\r\n    @patchesView = @insertSubView(new PatchesView(@campaign), @$el.find('.patches-view'))\r\n    @patchesView.load()\r\n    @patchesView.$el.removeClass 'hidden'\r\n\r\n  onClickAnalyticsButton: ->\r\n    @openModalView new CampaignAnalyticsModal {}, @campaignHandle, @campaignAnalytics\r\n\r\n  onAnalyticsModalClosed: (options) ->\r\n    if options.targetLevelSlug? and @treema.childrenTreemas?.levels?.childrenTreemas?\r\n      for original, level of @treema.childrenTreemas.levels.childrenTreemas\r\n        if level.data?.slug is options.targetLevelSlug\r\n          @openCampaignLevelView @supermodel.getModelByOriginal Level, original\r\n          break\r\n\r\n  onClickSaveButton: (e) ->\r\n    return if @openingModal\r\n    @openingModal = true\r\n    @loadMissingLevelsAndRelatedModels().then(=>\r\n      @openingModal = false\r\n      @propagateCampaignIndexes()\r\n      @updateCampaignLevels()\r\n      @toSave.set @toSave.filter (m) -> m.hasLocalChanges()\r\n      @openModalView new SaveCampaignModal({}, @toSave)\r\n    )\r\n\r\n  afterRender: ->\r\n    super()\r\n    treemaOptions =\r\n      schema: Campaign.schema\r\n      data: $.extend({}, @campaign.attributes)\r\n      filePath: \"db/campaign/#{@campaign.get('_id')}\"\r\n      callbacks:\r\n        change: @onTreemaChanged\r\n        select: @onTreemaSelectionChanged\r\n        dblclick: @onTreemaDoubleClicked\r\n        achievementUpdated: @onAchievementUpdated\r\n      nodeClasses:\r\n        levels: LevelsNode\r\n        level: LevelNode\r\n        campaigns: CampaignsNode\r\n        campaign: CampaignNode\r\n        achievement: AchievementNode\r\n        rewards: RewardsNode\r\n      supermodel: @supermodel\r\n\r\n    @treema = @$el.find('#campaign-treema').treema treemaOptions\r\n    @treema.build()\r\n    @treema.open()\r\n    @treema.childrenTreemas.levels?.open()\r\n\r\n    @campaignView = new CampaignView({editorMode: true, supermodel: @supermodel}, @campaignHandle)\r\n    @campaignView.highlightElement = _.noop # make it stop\r\n    @listenTo @campaignView, 'level-moved', @onCampaignLevelMoved\r\n    @listenTo @campaignView, 'adjacent-campaign-moved', @onAdjacentCampaignMoved\r\n    @listenTo @campaignView, 'level-clicked', @onCampaignLevelClicked\r\n    @listenTo @campaignView, 'level-double-clicked', @onCampaignLevelDoubleClicked\r\n    @listenTo @campaign, 'change:i18n', =>\r\n      @campaign.updateI18NCoverage()\r\n      @treema.set('/i18n', @campaign.get('i18n'))\r\n      @treema.set('/i18nCoverage', @campaign.get('i18nCoverage'))\r\n\r\n    @insertSubView @campaignView\r\n\r\n  onTreemaChanged: (e, nodes) =>\r\n    unless /test/.test @campaign.get('slug')  # Don't overwrite level stuff for testing Campaigns\r\n      for node in nodes\r\n        path = node.getPath()\r\n        if _.string.startsWith path, '/levels/'\r\n          parts = path.split('/')\r\n          original = parts[2]\r\n          level = @supermodel.getModelByOriginal Level, original\r\n          campaignLevel = @treema.get \"/levels/#{original}\"\r\n          level.set key, campaignLevel[key] for key in Campaign.denormalizedLevelProperties\r\n          @toSave.add level if level.hasLocalChanges()\r\n\r\n    @toSave.add @campaign\r\n    @campaign.set key, value for key, value of @treema.data\r\n    @campaignView.setCampaign(@campaign)\r\n\r\n  onTreemaSelectionChanged: (e, node) =>\r\n    return unless node[0]?.data?.original?\r\n    elem = @$(\"div[data-level-original='#{node[0].data.original}']\")\r\n    elem.toggle('pulsate')\r\n    setTimeout ()->\r\n      elem.toggle('pulsate')\r\n    , 1000\r\n\r\n  onTreemaDoubleClicked: (e, node) =>\r\n    path = node.getPath()\r\n    return unless _.string.startsWith path, '/levels/'\r\n    original = path.split('/')[2]\r\n    @openCampaignLevelView @supermodel.getModelByOriginal Level, original\r\n\r\n  onAchievementUpdated: (e, node) =>\r\n    @supermodel.registerModel e.achievement\r\n    @achievements.findWhere({_id: e.achievement.id}).set('rewards', e.achievement.get('rewards'))\r\n    @updateCampaignLevels()  # TODO: only change the rewards for the one we had, don't wipe anything else\r\n    levelOriginal = node.getPath().split('/')[2]\r\n    level = @levels.findWhere original: levelOriginal\r\n    rewardsPath = \"/levels/#{levelOriginal}/rewards\"\r\n    @treema.set rewardsPath, @formatRewards level\r\n    @campaignView.setCampaign @campaign\r\n\r\n  onCampaignLevelMoved: (e) ->\r\n    path = \"levels/#{e.levelOriginal}/position\"\r\n    @treema.set path, e.position\r\n\r\n  onAdjacentCampaignMoved: (e) ->\r\n    path = \"adjacentCampaigns/#{e.campaignID}/position\"\r\n    @treema.set path, e.position\r\n\r\n  onCampaignLevelClicked: (levelOriginal) ->\r\n    return unless levelTreema = @treema.childrenTreemas?.levels?.childrenTreemas?[levelOriginal]\r\n    if key.ctrl or key.command\r\n      url = \"/editor/level/#{levelTreema.data.slug}\"\r\n      window.open url, '_blank'\r\n    levelTreema.select()\r\n    #levelTreema.open()\r\n\r\n  onCampaignLevelDoubleClicked: (levelOriginal) ->\r\n    @openCampaignLevelView @supermodel.getModelByOriginal Level, levelOriginal\r\n\r\n  openCampaignLevelView: (level) ->\r\n    @insertSubView campaignLevelView = new CampaignLevelView({}, level)\r\n    @listenToOnce campaignLevelView, 'hidden', => @$el.find('#campaign-view').show()\r\n    @$el.find('#campaign-view').hide()\r\n\r\n  onClickLoginButton: ->\r\n    # Do Nothing\r\n    # This is a override method to RootView, so that only CampaignView is listenting to login button click\r\n\r\n  onClickSignupButton: ->\r\n    # Do Nothing\r\n    # This is a override method to RootView, so that only CampaignView is listenting to signup button click\r\n\r\nclass LevelsNode extends TreemaObjectNode\r\n  valueClass: 'treema-levels'\r\n  @levels: {}\r\n  ordered: true\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    @buildValueForDisplaySimply valEl, ''+_.size(data)\r\n\r\n  childPropertiesAvailable: -> @childSource\r\n\r\n  childSource: (req, res) =>\r\n    s = new Backbone.Collection([], {model:Level})\r\n    s.url = '/db/level'\r\n    s.fetch({data: {term:req.term, project: Campaign.denormalizedLevelProperties.join(',')}})\r\n    s.once 'sync', (collection) =>\r\n      for level in collection.models\r\n        LevelsNode.levels[level.get('original')] = level\r\n        @settings.supermodel.registerModel level\r\n      mapped = ({label: r.get('name'), value: r.get('original')} for r in collection.models)\r\n\r\n      # Sort the results. Prioritize names that start with the search term, then contain the search term.\r\n      lowerPriority = _.clone(mapped)\r\n      lowerTerm = req.term.toLowerCase()\r\n      startsWithTerm = _.filter(lowerPriority, (item) -> _.string.startsWith(item.label.toLowerCase(), lowerTerm))\r\n      _.pull(lowerPriority, startsWithTerm...)\r\n      hasTerm = _.filter(lowerPriority, (item) -> _.string.contains(item.label.toLowerCase(), lowerTerm))\r\n      _.pull(lowerPriority, hasTerm...)\r\n      sorted = _.flatten([startsWithTerm, hasTerm, lowerPriority])\r\n      res(sorted)\r\n\r\nclass LevelNode extends TreemaObjectNode\r\n  valueClass: 'treema-level'\r\n  buildValueForDisplay: (valEl, data) ->\r\n    name = data.name\r\n    if data.requiresSubscription\r\n      name = \"[P] \" + name\r\n\r\n    status = ''\r\n    el = 'strong'\r\n    if data.adminOnly\r\n      status += \" (disabled)\"\r\n      el = 'span'\r\n    else if data.adventurer\r\n      status += \" (adventurer)\"\r\n\r\n    completion = ''\r\n\r\n    valEl.append $(\"<a href='/editor/level/#{_.string.slugify(data.name)}' class='spr'>(e)</a>\")\r\n    valEl.append $(\"<#{el}></#{el}>\").addClass('treema-shortened').text name\r\n    if status\r\n      valEl.append $('<em class=\"spl\"></em>').text status\r\n    if completion\r\n      valEl.append $('<span class=\"completion\"></span>').text completion\r\n\r\n  populateData: ->\r\n    return if @data.name?\r\n    data = _.pick LevelsNode.levels[@keyForParent].attributes, Campaign.denormalizedLevelProperties\r\n    _.extend @data, data\r\n\r\nclass CampaignsNode extends TreemaObjectNode\r\n  valueClass: 'treema-campaigns'\r\n  @campaigns: {}\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    @buildValueForDisplaySimply valEl, ''+_.size(data)\r\n\r\n  childPropertiesAvailable: -> @childSource\r\n\r\n  childSource: (req, res) =>\r\n    s = new Backbone.Collection([], {model:Campaign})\r\n    s.url = '/db/campaign'\r\n    s.fetch({data: {term:req.term, project: Campaign.denormalizedCampaignProperties}})\r\n    s.once 'sync', (collection) ->\r\n      CampaignsNode.campaigns[campaign.id] = campaign for campaign in collection.models\r\n      mapped = ({label: r.get('name'), value: r.id} for r in collection.models)\r\n      res(mapped)\r\n\r\n\r\nclass CampaignNode extends TreemaObjectNode\r\n  valueClass: 'treema-campaign'\r\n  buildValueForDisplay: (valEl, data) ->\r\n    @buildValueForDisplaySimply valEl, data.name\r\n\r\n  populateData: ->\r\n    return if @data.name?\r\n    # TODO: Need to be able to update i18n links to other campaigns\r\n    data = _.pick CampaignsNode.campaigns[@keyForParent].attributes, Campaign.denormalizedCampaignProperties\r\n    _.extend @data, data\r\n\r\nclass AchievementNode extends treemaExt.IDReferenceNode\r\n  buildSearchURL: (term) -> \"#{@url}?term=#{term}&project=#{achievementProject.join(',')}\"\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super valEl, data\r\n    addAchievementEditorLink @, valEl, data\r\n\r\nclass RewardsNode extends TreemaArrayNode\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super valEl, data\r\n    achievements = window.currentView.achievements.where related: @parent.data.original\r\n    achievements = _.sortBy achievements, (a) -> a.get('rewards')?.levels?.length ? 0\r\n    mainAchievement = achievements[0]\r\n    return unless mainAchievement\r\n    addAchievementEditorLink @, valEl, mainAchievement.id\r\n\r\naddAchievementEditorLink = (node, valEl, achievementId) ->\r\n  anchor = $('<a class=\"spl\">(e)</a>')\r\n  anchor.on 'click', (event) ->\r\n    childWindow = window.open(\"/editor/achievement/#{achievementId}\", achievementId, 'width=1040,height=900,left=1600,top=0,location=1,menubar=1,scrollbars=1,status=0,titlebar=1,toolbar=1', true)\r\n    childWindow.achievementSavedCallback = (event) ->\r\n      node.callbacks.achievementUpdated {achievement: event.achievement}, node\r\n    childWindow.focus()\r\n    event.stopPropagation()\r\n  valEl.find('.treema-shortened').append anchor\r\n","CocoView = require 'views/core/CocoView'\r\nLevel = require 'models/Level'\r\nLevelSession = require 'models/LevelSession'\r\nModelModal = require 'views/modal/ModelModal'\r\nUser = require 'models/User'\r\nutils = require 'core/utils'\r\n\r\nmodule.exports = class CampaignLevelView extends CocoView\r\n  id: 'campaign-level-view'\r\n  template: require 'templates/editor/campaign/campaign-level-view'\r\n\r\n  events:\r\n    'change .line-graph-checkbox': 'updateGraphCheckbox'\r\n    'click .close': 'onClickClose'\r\n    'click #reload-button': 'onClickReloadButton'\r\n    'dblclick .recent-session': 'onDblClickRecentSession'\r\n    'mouseenter .graph-point': 'onMouseEnterPoint'\r\n    'mouseleave .graph-point': 'onMouseLeavePoint'\r\n    'click .replay-button': 'onClickReplay'\r\n\r\n  constructor: (options, @level) ->\r\n    super(options)\r\n    @fullLevel = new Level _id: @level.id\r\n    @fullLevel.fetch()\r\n    @listenToOnce @fullLevel, 'sync', => @render?()\r\n    @levelSlug = @level.get('slug')\r\n    @getAnalytics()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.level = if @fullLevel.loaded then @fullLevel else @level\r\n    c.analytics = @analytics\r\n    c\r\n\r\n  afterRender: ->\r\n    super()\r\n    $(\"#input-startday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    $(\"#input-endday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    # TODO: Why does this have to be called from afterRender() instead of getRenderData()?\r\n    @updateAnalyticsGraphs()\r\n\r\n  updateGraphCheckbox: (e) ->\r\n    lineID = $(e.target).data('lineid')\r\n    checked = $(e.target).prop('checked')\r\n    for graph in @analytics.graphs\r\n      for line in graph.lines\r\n        if line.lineID is lineID\r\n          line.enabled = checked\r\n          return @render()\r\n\r\n  onClickClose: ->\r\n    @$el.addClass('hidden')\r\n    @trigger 'hidden'\r\n\r\n  onClickReloadButton: () =>\r\n    startDay = $('#input-startday').val()\r\n    endDay = $('#input-endday').val()\r\n    @getAnalytics startDay, endDay\r\n\r\n  onDblClickRecentSession: (e) ->\r\n    # Admin view of players' code\r\n    return unless me.isAdmin()\r\n    row = $(e.target).parent()\r\n    player = new User _id: row.data 'player-id'\r\n    session = new LevelSession _id: row.data 'session-id'\r\n    @openModalView new ModelModal models: [session, player]\r\n\r\n  onMouseEnterPoint: (e) ->\r\n    pointID = $(e.target).data('pointid')\r\n    container = @$el.find(\".graph-point-info-container[data-pointid=#{pointID}]\").show()\r\n    margin = 20\r\n    width = container.outerWidth()\r\n    height = container.outerHeight()\r\n    container.css('left', e.offsetX - width / 2)\r\n    container.css('top', e.offsetY - height - margin)\r\n\r\n  onMouseLeavePoint: (e) ->\r\n    pointID = $(e.target).data('pointid')\r\n    @$el.find(\".graph-point-info-container[data-pointid=#{pointID}]\").hide()\r\n\r\n  onClickReplay: (e) ->\r\n    sessionID = $(e.target).closest('tr').data 'session-id'\r\n    url = \"/play/level/#{@level.get('slug')}?session=#{sessionID}&observing=true\"\r\n    window.open url, '_blank'\r\n\r\n  updateAnalyticsGraphData: ->\r\n    # console.log 'updateAnalyticsGraphData'\r\n    # Build graphs based on available @analytics data\r\n    # Currently only one graph\r\n    @analytics.graphs = [graphID: 'level-completions', lines: []]\r\n\r\n    # TODO: Where should this metadata live?\r\n    # TODO: lineIDs assumed to be unique across graphs\r\n    completionLineID = 'level-completions'\r\n    playtimeLineID = 'level-playtime'\r\n    helpsLineID = 'helps-clicked'\r\n    videosLineID = 'help-videos'\r\n    lineMetadata = {}\r\n    lineMetadata[completionLineID] =\r\n      description: 'Level Completion (%)'\r\n      color: 'red'\r\n    lineMetadata[playtimeLineID] =\r\n      description: 'Average Playtime (s)'\r\n      color: 'green'\r\n    lineMetadata[helpsLineID] =\r\n      description: 'Help click rate (%)'\r\n      color: 'blue'\r\n    lineMetadata[videosLineID] =\r\n      description: 'Help video rate (%)'\r\n      color: 'purple'\r\n\r\n    # Use this days aggregate to fill in missing days from the analytics data\r\n    days = {}\r\n    days[\"#{day.created[0..3]}-#{day.created[4..5]}-#{day.created[6..7]}\"] = true for day in @analytics.levelCompletions.data if @analytics?.levelCompletions?.data?\r\n    days[day.created] = true for day in @analytics.levelPlaytimes.data if @analytics?.levelPlaytimes?.data?\r\n    days[\"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"] = true for day in @analytics.levelHelps.data if @analytics?.levelHelps?.data?\r\n    days = Object.keys(days).sort (a, b) -> if a < b then -1 else 1\r\n    if days.length > 0\r\n      currentIndex = 0\r\n      currentDay = days[currentIndex]\r\n      currentDate = new Date(currentDay + \"T00:00:00.000Z\")\r\n      lastDay = days[days.length - 1]\r\n      while currentDay isnt lastDay\r\n        days.splice currentIndex, 0, currentDay if days[currentIndex] isnt currentDay\r\n        currentIndex++\r\n        currentDate.setUTCDate(currentDate.getUTCDate() + 1)\r\n        currentDay = currentDate.toISOString().substr(0, 10)\r\n\r\n    # Update level completion graph data\r\n    dayStartedMap = {}\r\n    if @analytics?.levelCompletions?.data?.length > 0\r\n      # Build line data\r\n      levelPoints = []\r\n      for day, i in @analytics.levelCompletions.data\r\n        dayStartedMap[day.created] = day.started\r\n        rate = parseFloat(day.rate)\r\n        levelPoints.push\r\n          x: i\r\n          y: rate\r\n          started: day.started\r\n          day: \"#{day.created[0..3]}-#{day.created[4..5]}-#{day.created[6..7]}\"\r\n          pointID: \"#{completionLineID}#{i}\"\r\n          values: [\"Started: #{day.started}\", \"Finished: #{day.finished}\", \"Completion rate: #{rate.toFixed(2)}%\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if levelPoints.length <= i or levelPoints[i].day isnt day\r\n          levelPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        levelPoints[i].x = i\r\n        levelPoints[i].pointID = \"#{completionLineID}#{i}\"\r\n      @analytics.graphs[0].lines.push\r\n        lineID: completionLineID\r\n        enabled: true\r\n        points: levelPoints\r\n        description: lineMetadata[completionLineID].description\r\n        lineColor: lineMetadata[completionLineID].color\r\n        min: 0\r\n        max: 100.0\r\n\r\n    # Update average playtime graph data\r\n    if @analytics?.levelPlaytimes?.data?.length > 0\r\n      # Build line data\r\n      playtimePoints = []\r\n      for day, i in @analytics.levelPlaytimes.data\r\n        avg = parseFloat(day.average)\r\n        playtimePoints.push\r\n          x: i\r\n          y: avg\r\n          day: day.created\r\n          pointID: \"#{playtimeLineID}#{i}\"\r\n          values: [\"Average playtime: #{avg.toFixed(2)}s\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if playtimePoints.length <= i or playtimePoints[i].day isnt day\r\n          playtimePoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        playtimePoints[i].x = i\r\n        playtimePoints[i].pointID = \"#{playtimeLineID}#{i}\"\r\n      @analytics.graphs[0].lines.push\r\n        lineID: playtimeLineID\r\n        enabled: true\r\n        points: playtimePoints\r\n        description: lineMetadata[playtimeLineID].description\r\n        lineColor: lineMetadata[playtimeLineID].color\r\n        min: 0\r\n        max: d3.max(playtimePoints, (d) -> d.y)\r\n\r\n    # Update help graph data\r\n    if @analytics?.levelHelps?.data?.length > 0\r\n      # Build line data\r\n      helpPoints = []\r\n      videoPoints = []\r\n      for day, i in @analytics.levelHelps.data\r\n        helpCount = day.alertHelps + day.paletteHelps\r\n        started = dayStartedMap[day.day] ? 0\r\n        clickRate = if started > 0 then helpCount / started * 100 else 0\r\n        videoRate = day.videoStarts / helpCount * 100\r\n        helpPoints.push\r\n          x: i\r\n          y: clickRate\r\n          day: \"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"\r\n          pointID: \"#{helpsLineID}#{i}\"\r\n          values: [\"Helps clicked: #{helpCount}\", \"Helps click clickRate: #{clickRate.toFixed(2)}%\"]\r\n        videoPoints.push\r\n          x: i\r\n          y: videoRate\r\n          day: \"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"\r\n          pointID: \"#{videosLineID}#{i}\"\r\n          values: [\"Help videos started: #{day.videoStarts}\", \"Help videos start rate: #{videoRate.toFixed(2)}%\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if helpPoints.length <= i or helpPoints[i].day isnt day\r\n          helpPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        helpPoints[i].x = i\r\n        helpPoints[i].pointID = \"#{helpsLineID}#{i}\"\r\n        if videoPoints.length <= i or videoPoints[i].day isnt day\r\n          videoPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        videoPoints[i].x = i\r\n        videoPoints[i].pointID = \"#{videosLineID}#{i}\"\r\n      if d3.max(helpPoints, (d) -> d.y) > 0\r\n        @analytics.graphs[0].lines.push\r\n          lineID: helpsLineID\r\n          enabled: true\r\n          points: helpPoints\r\n          description: lineMetadata[helpsLineID].description\r\n          lineColor: lineMetadata[helpsLineID].color\r\n          min: 0\r\n          max: 100.0\r\n      if d3.max(videoPoints, (d) -> d.y) > 0\r\n        @analytics.graphs[0].lines.push\r\n          lineID: videosLineID\r\n          enabled: true\r\n          points: videoPoints\r\n          description: lineMetadata[videosLineID].description\r\n          lineColor: lineMetadata[videosLineID].color\r\n          min: 0\r\n          max: 100.0\r\n\r\n  updateAnalyticsGraphs: ->\r\n    # Build d3 graphs\r\n    return unless @analytics?.graphs?.length > 0\r\n    containerSelector = '.line-graph-container'\r\n    # console.log 'updateAnalyticsGraphs', containerSelector, @analytics.graphs\r\n\r\n    margin = 20\r\n    keyHeight = 20\r\n    xAxisHeight = 20\r\n    yAxisWidth = 40\r\n    containerWidth = $(containerSelector).width()\r\n    containerHeight = $(containerSelector).height()\r\n\r\n    for graph in @analytics.graphs\r\n      graphLineCount = _.reduce graph.lines, ((sum, item) -> if item.enabled then sum + 1 else sum), 0\r\n      svg = d3.select(containerSelector).append(\"svg\")\r\n        .attr(\"width\", containerWidth)\r\n        .attr(\"height\", containerHeight)\r\n      width = containerWidth - margin * 2 - yAxisWidth * graphLineCount\r\n      height = containerHeight - margin * 2 - xAxisHeight - keyHeight * graphLineCount\r\n      currentLine = 0\r\n      for line in graph.lines\r\n        continue unless line.enabled\r\n        xRange = d3.scale.linear().range([0, width]).domain([d3.min(line.points, (d) -> d.x), d3.max(line.points, (d) -> d.x)])\r\n        yRange = d3.scale.linear().range([height, 0]).domain([line.min, line.max])\r\n\r\n        # x-Axis and guideline once\r\n        if currentLine is 0\r\n          startDay = new Date(line.points[0].day)\r\n          endDay = new Date(line.points[line.points.length - 1].day)\r\n          xAxisRange = d3.time.scale()\r\n            .domain([startDay, endDay])\r\n            .range([0, width])\r\n          xAxis = d3.svg.axis()\r\n            .scale(xAxisRange)\r\n          svg.append(\"g\")\r\n            .attr(\"class\", \"x axis\")\r\n            .call(xAxis)\r\n            .selectAll(\"text\")\r\n            .attr(\"dy\", \".35em\")\r\n            .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * (graphLineCount - 1)) + \",\" + (height + margin) + \")\")\r\n            .style(\"text-anchor\", \"start\")\r\n\r\n          # Horizontal guidelines\r\n          svg.selectAll(\".line\")\r\n            .data([10, 30, 50, 70, 90])\r\n            .enter()\r\n            .append(\"line\")\r\n            .attr(\"x1\", margin + yAxisWidth * graphLineCount)\r\n            .attr(\"y1\", (d) -> margin + yRange(d))\r\n            .attr(\"x2\", margin + yAxisWidth * graphLineCount + width)\r\n            .attr(\"y2\", (d) -> margin + yRange(d))\r\n            .attr(\"stroke\", line.lineColor)\r\n            .style(\"opacity\", \"0.5\")\r\n\r\n        # y-Axis\r\n        yAxisRange = d3.scale.linear().range([height, 0]).domain([line.min, line.max])\r\n        yAxis = d3.svg.axis()\r\n          .scale(yRange)\r\n          .orient(\"left\")\r\n        svg.append(\"g\")\r\n          .attr(\"class\", \"y axis\")\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * currentLine) + \",\" + margin + \")\")\r\n          .style(\"color\", line.lineColor)\r\n          .call(yAxis)\r\n          .selectAll(\"text\")\r\n          .attr(\"y\", 0)\r\n          .attr(\"x\", 0)\r\n          .attr(\"fill\", line.lineColor)\r\n          .style(\"text-anchor\", \"start\")\r\n\r\n        # Key\r\n        svg.append(\"line\")\r\n          .attr(\"x1\", margin)\r\n          .attr(\"y1\", margin + height + xAxisHeight + keyHeight * currentLine + keyHeight / 2)\r\n          .attr(\"x2\", margin + 40)\r\n          .attr(\"y2\", margin + height + xAxisHeight + keyHeight * currentLine + keyHeight / 2)\r\n          .attr(\"stroke\", line.lineColor)\r\n          .attr(\"class\", \"key-line\")\r\n        svg.append(\"text\")\r\n          .attr(\"x\", margin + 40 + 10)\r\n          .attr(\"y\", margin + height + xAxisHeight + keyHeight * currentLine + (keyHeight + 10) / 2)\r\n          .attr(\"fill\", line.lineColor)\r\n          .attr(\"class\", \"key-text\")\r\n          .text(line.description)\r\n\r\n        # Path and points\r\n        svg.selectAll(\".circle\")\r\n          .data(line.points)\r\n          .enter()\r\n          .append(\"circle\")\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * graphLineCount) + \",\" + margin + \")\")\r\n          .attr(\"cx\", (d) -> xRange(d.x))\r\n          .attr(\"cy\", (d) -> yRange(d.y))\r\n          .attr(\"r\", (d) -> if d.started then Math.max(3, Math.min(10, Math.log(parseInt(d.started)))) + 2 else 6)\r\n          .attr(\"fill\", line.lineColor)\r\n          .attr(\"stroke-width\", 1)\r\n          .attr(\"class\", \"graph-point\")\r\n          .attr(\"data-pointid\", (d) -> \"#{line.lineID}#{d.x}\")\r\n        d3line = d3.svg.line()\r\n          .x((d) -> xRange(d.x))\r\n          .y((d) -> yRange(d.y))\r\n          .interpolate(\"linear\")\r\n        svg.append(\"path\")\r\n          .attr(\"d\", d3line(line.points))\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * graphLineCount) + \",\" + margin + \")\")\r\n          .style(\"stroke-width\", 1)\r\n          .style(\"stroke\", line.lineColor)\r\n          .style(\"fill\", \"none\")\r\n        currentLine++\r\n\r\n  getAnalytics: (startDay, endDay) =>\r\n    # Analytics APIs use 2 different day formats\r\n    if startDay?\r\n      startDayDashed = startDay\r\n      startDay = startDay.replace(/-/g, '')\r\n    else\r\n      startDay = utils.getUTCDay -14\r\n      startDayDashed = \"#{startDay[0..3]}-#{startDay[4..5]}-#{startDay[6..7]}\"\r\n    if endDay?\r\n      endDayDashed = endDay\r\n      endDay = endDay.replace(/-/g, '')\r\n    else\r\n      endDay = utils.getUTCDay -1\r\n      endDayDashed = \"#{endDay[0..3]}-#{endDay[4..5]}-#{endDay[6..7]}\"\r\n\r\n    # Initialize\r\n    @analytics =\r\n      startDay: startDayDashed\r\n      endDay: endDayDashed\r\n      commonProblems: {data: [], loading: true}\r\n      levelCompletions: {data: [], loading: true}\r\n      levelHelps: {data: [], loading: true}\r\n      levelPlaytimes: {data: [], loading: true}\r\n      recentSessions: {data: [], loading: true}\r\n      graphs: []\r\n    @render() # Hide old analytics data while we fetch new data\r\n\r\n    makeFinishDataFetch = (data) =>\r\n      return =>\r\n        return if @destroyed\r\n        @updateAnalyticsGraphData()\r\n        data.loading = false\r\n        @render()\r\n    @getCommonLevelProblems startDayDashed, endDayDashed, makeFinishDataFetch(@analytics.commonProblems)\r\n    @getLevelCompletions startDay, endDay, makeFinishDataFetch(@analytics.levelCompletions)\r\n    @getLevelHelps startDay, endDay, makeFinishDataFetch(@analytics.levelHelps)\r\n    @getLevelPlaytimes startDayDashed, endDayDashed, makeFinishDataFetch(@analytics.levelPlaytimes)\r\n    @getRecentSessions makeFinishDataFetch(@analytics.recentSessions)\r\n\r\n  getCommonLevelProblems: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getCommonLevelProblems', data\r\n      @analytics.commonProblems.data = data\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'common_problems', {\r\n      url: '/db/user.code.problem/-/common_problems'\r\n      data: {startDay: startDay, endDay: endDay, slug: @levelSlug}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelCompletions: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelCompletions', data\r\n      data.sort (a, b) -> if a.created < b.created then -1 else 1\r\n      mapFn = (item) ->\r\n        item.rate = if item.started > 0 then item.finished / item.started * 100 else 0\r\n        item\r\n      @analytics.levelCompletions.data = _.map data, mapFn, @\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_completions', {\r\n      url: '/db/analytics_perday/-/level_completions'\r\n      data: {startDay: startDay, endDay: endDay, slug: @levelSlug}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelHelps: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelHelps', data\r\n      @analytics.levelHelps.data = data.sort (a, b) -> if a.day < b.day then -1 else 1\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_helps', {\r\n      url: '/db/analytics_perday/-/level_helps'\r\n      data: {startDay: startDay, endDay: endDay, slugs: [@levelSlug]}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelPlaytimes: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelPlaytimes', data\r\n      @analytics.levelPlaytimes.data = data.sort (a, b) -> if a.created < b.created then -1 else 1\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'playtime_averages', {\r\n      url: '/db/level/-/playtime_averages'\r\n      data: {startDay: startDay, endDay: endDay, slugs: [@levelSlug]}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getRecentSessions: (doneCallback) ->\r\n    limit = 100\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getRecentSessions', data\r\n      @analytics.recentSessions.data = data\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_sessions_recent', {\r\n      url: \"/db/level.session/-/recent\"\r\n      data: {slug: @levelSlug, limit: limit}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/campaign/save-campaign-modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\n\r\nmodule.exports = class SaveCampaignModal extends ModalView\r\n  id: 'save-campaign-modal'\r\n  template: template\r\n  plain: true\r\n\r\n  events:\r\n    'click #save-button': 'onClickSaveButton'\r\n\r\n  constructor: (options, @modelsToSave) ->\r\n    super(options)\r\n\r\n  afterRender: ->\r\n    @$el.find('.delta-view').each((i, el) =>\r\n      $el = $(el)\r\n      model = @modelsToSave.find( id: $el.data('model-id'))\r\n      deltaView = new DeltaView({model: model})\r\n      @insertSubView(deltaView, $el)\r\n    )\r\n    super()\r\n\r\n  onClickSaveButton: ->\r\n    @showLoading()\r\n    @reverseLevelsBeforeSave()\r\n    modelsBeingSaved = (model.patch() for model in @modelsToSave.models)\r\n    $.when(_.compact(modelsBeingSaved)...).done(-> document.location.reload())\r\n\r\n  reverseLevelsBeforeSave: ->\r\n    # For some unfathomable reason, not in our code anywhere, the levels get reversed during the save somehow.\r\n    # Since we want to maintain their orders, we reverse them first, so that when they're reversed again, it's right.\r\n    # Yaaaay!\r\n    return unless campaign = _.find @modelsToSave.models, (m) -> m.constructor.className is 'Campaign'\r\n    levelsReversed = {}\r\n    levels = campaign.get 'levels'\r\n    levelIDs = _.keys(levels).reverse()\r\n    for levelID in levelIDs\r\n      levelsReversed[levelID] = levels[levelID]\r\n      campaign.set 'levels', levelsReversed\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/component/add-thang-components-modal'\r\nCocoCollection = require 'collections/CocoCollection'\r\nLevelComponent = require 'models/LevelComponent'\r\n\r\nmodule.exports = class UnnamedView extends ModalView\r\n  id: 'add-thang-components-modal'\r\n  template: template\r\n  plain: true\r\n  modalWidthPercent: 80\r\n  \r\n  events:\r\n    'click .footer button': 'onDonePressed'\r\n  \r\n  initialize: (options) ->\r\n    super()\r\n    @skipOriginals = options.skipOriginals or []\r\n    @components = new CocoCollection([], model: LevelComponent)\r\n    @components.url = \"/db/level.component?term=&project=name,system,original,version,description\"\r\n    @supermodel.loadCollection(@components, 'components')\r\n    \r\n  getRenderData: ->\r\n    c = super()\r\n    c.components = (comp for comp in @components.models when not (comp.get('original') in @skipOriginals))\r\n    c.components = _.groupBy(c.components, (comp) -> comp.get('system'))\r\n    c.nameLists = {}\r\n    for system, componentList of c.components\r\n      c.components[system] = _.sortBy(componentList, (comp) -> comp.get('name'))\r\n      c.nameLists[system] = (comp.get('name') for comp in c.components[system]).join(', ')\r\n    c.systems = _.keys(c.components)\r\n    c.systems.sort()\r\n    c\r\n    \r\n  getSelectedComponents: ->\r\n    selected = @$el.find('input[type=\"checkbox\"]:checked')\r\n    vals = ($(el).val() for el in selected)\r\n    components = (c for c in @components.models when c.id in vals)\r\n    return components\r\n#    sparseComponents = ({original: c.get('original'), majorVersion: c.get('version').major} for c in components)\r\n#    return sparseComponents","VersionsModal = require 'views/editor/modal/VersionsModal'\r\n\r\nmodule.exports = class ComponentVersionsModal extends VersionsModal\r\n  id: 'editor-component-versions-view'\r\n  url: '/db/level.component/'\r\n  page: 'component'\r\n\r\n  constructor: (options, @ID) ->\r\n    super options, @ID, require 'models/LevelComponent'\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/component/thang-component-config-view'\r\n\r\nLevel = require 'models/Level'\r\nLevelComponent = require 'models/LevelComponent'\r\nnodes = require '../level/treema_nodes'\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class ThangComponentConfigView extends CocoView\r\n  className: 'thang-component-config-view'\r\n  template: template\r\n  changed: false\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @component = options.component\r\n    @config = options.config or {}\r\n    @additionalDefaults = options.additionalDefaults\r\n    @isDefaultComponent = false\r\n    @world = options.world\r\n    @level = options.level\r\n    @callback = options.callback\r\n\r\n  afterRender: ->\r\n    super()\r\n    @buildTreema()\r\n\r\n  setConfig: (config) ->\r\n    @handlingChange = true\r\n    @editThangTreema.set('/', config)\r\n    @handlingChange = false\r\n\r\n  setIsDefaultComponent: (isDefaultComponent) ->\r\n    changed = @isDefaultComponent isnt isDefaultComponent\r\n    if isDefaultComponent then @config = undefined\r\n    @isDefaultComponent = isDefaultComponent\r\n    @render() if changed\r\n\r\n  buildTreema: ->\r\n    thangs = if @level? then @level.get('thangs') else []\r\n    thangIDs = _.filter(_.pluck(thangs, 'id'))\r\n    teams = _.filter(_.pluck(thangs, 'team'))\r\n    superteams = _.filter(_.pluck(thangs, 'superteam'))\r\n    superteams = _.union(teams, superteams)\r\n    schema = $.extend true, {}, @component.get('configSchema')\r\n    schema.default ?= {}\r\n    _.merge schema.default, @additionalDefaults if @additionalDefaults\r\n\r\n    if @level?.isType('hero', 'hero-ladder', 'hero-coop', 'course', 'course-ladder', 'game-dev', 'web-dev')\r\n      schema.required = []\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: schema\r\n      data: @config\r\n      callbacks: {change: @onConfigEdited}\r\n      world: @world\r\n      view: @\r\n      thangIDs: thangIDs\r\n      teams: teams\r\n      superteams: superteams\r\n      nodeClasses:\r\n        object: ComponentConfigNode\r\n        'point2d': nodes.WorldPointNode\r\n        'viewport': nodes.WorldViewportNode\r\n        'bounds': nodes.WorldBoundsNode\r\n        'radians': nodes.RadiansNode\r\n        'team': nodes.TeamNode\r\n        'superteam': nodes.SuperteamNode\r\n        'meters': nodes.MetersNode\r\n        'kilograms': nodes.KilogramsNode\r\n        'seconds': nodes.SecondsNode\r\n        'speed': nodes.SpeedNode\r\n        'acceleration': nodes.AccelerationNode\r\n        'thang-type': nodes.ThangTypeNode\r\n        'item-thang-type': nodes.ItemThangTypeNode\r\n        'solutions': SolutionsNode\r\n\r\n    @editThangTreema = @$el.find('.treema').treema treemaOptions\r\n    @editThangTreema.build()\r\n    @editThangTreema.open(2)\r\n    if _.isEqual(@editThangTreema.data, {}) and not @editThangTreema.canAddChild()\r\n      @$el.find('.panel-body').hide()\r\n\r\n  onConfigEdited: =>\r\n    return if @destroyed or @handlingChange\r\n    @config = @data()\r\n    @changed = true\r\n    @trigger 'changed', { component: @component, config: @config }\r\n\r\n  data: -> @editThangTreema.data\r\n\r\n  destroy: ->\r\n    @editThangTreema?.destroy()\r\n    super()\r\n\r\nclass ComponentConfigNode extends TreemaObjectNode\r\n  nodeDescription: 'Component Property'\r\n\r\nclass SolutionsNode extends TreemaArrayNode\r\n  buildValueForDisplay: (valEl, data) ->\r\n    btn = $('<button class=\"btn btn-default btn-xs\">Fill defaults</button>')\r\n    btn.on('click', @onClickFillDefaults)\r\n    valEl.append(btn)\r\n\r\n  onClickFillDefaults: (e) =>\r\n    e.preventDefault()\r\n\r\n    sources = { javascript: @parent.data.source }\r\n    _.extend sources, @parent.data.languages or {}\r\n    solutions = _.clone(@data)\r\n    solutions = _.filter(solutions, (solution) -> not _.isEmpty(solution) )\r\n    for language in _.keys(sources)\r\n      source = sources[language]\r\n      solution = _.findWhere(solutions, {language: language})\r\n      continue if solution\r\n      solutions.push({\r\n        source: source\r\n        language: language\r\n        succeeds: true\r\n      })\r\n\r\n    @set('/', solutions)\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/component/thang-components-edit-view'\r\n\r\nLevel = require 'models/Level'\r\nLevelComponent = require 'models/LevelComponent'\r\nLevelSystem = require 'models/LevelSystem'\r\nLevelComponents = require 'collections/LevelComponents'\r\nThangComponentConfigView = require './ThangComponentConfigView'\r\nAddThangComponentsModal = require './AddThangComponentsModal'\r\nnodes = require '../level/treema_nodes'\r\nrequire 'vendor/treema'\r\n\r\nThangType = require 'models/ThangType'\r\nCocoCollection = require 'collections/CocoCollection'\r\n\r\nLC = (componentName, config) -> original: LevelComponent[componentName + 'ID'], majorVersion: 0, config: config\r\nDEFAULT_COMPONENTS =\r\n  Unit: [LC('Equips'), LC('FindsPaths')]\r\n  Hero: [LC('Equips'), LC('FindsPaths')]\r\n  Floor: [\r\n    LC('Exists', stateless: true)\r\n    LC('Physical', width: 20, height: 17, depth: 2, shape: 'sheet', pos: {x: 10, y: 8.5, z: 1})\r\n    LC('Land')\r\n  ]\r\n  Wall: [\r\n    LC('Exists', stateless: true)\r\n    LC('Physical', width: 4, height: 4, depth: 12, shape: 'box', pos: {x: 2, y: 2, z: 6})\r\n    LC('Collides', collisionType: 'static', collisionCategory: 'obstacles', mass: 1000, fixedRotation: true, restitution: 1)\r\n  ]\r\n  Doodad: [\r\n    LC('Exists', stateless: true)\r\n    LC('Physical')\r\n    LC('Collides', collisionType: 'static', fixedRotation: true)\r\n  ]\r\n  Misc: [LC('Exists'), LC('Physical')]\r\n  Mark: []\r\n  Item: [LC('Item')]\r\n  Missile: [LC('Missile')]\r\n\r\nmodule.exports = class ThangComponentsEditView extends CocoView\r\n  id: 'thang-components-edit-view'\r\n  template: template\r\n\r\n  subscriptions:\r\n    'editor:thang-type-kind-changed': 'onThangTypeKindChanged'\r\n\r\n  events:\r\n    'click #add-components-button': 'onAddComponentsButtonClicked'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @originalsLoaded = {}\r\n    @components = options.components or []\r\n    @components = $.extend true, [], @components # just to be sure\r\n    @setThangType options.thangType\r\n    @lastComponentLength = @components.length\r\n    @world = options.world\r\n    @level = options.level\r\n    @loadComponents(@components)\r\n\r\n  setThangType: (@thangType) ->\r\n    return unless componentRefs = @thangType?.get('components')\r\n    @loadComponents(componentRefs)\r\n\r\n  loadComponents: (components) ->\r\n    for componentRef in components\r\n      # just to handle if ever somehow the same component is loaded twice, through bad data and alike\r\n      continue if @originalsLoaded[componentRef.original]\r\n      @originalsLoaded[componentRef.original] = componentRef.original\r\n\r\n      levelComponent = new LevelComponent(componentRef)\r\n      url = \"/db/level.component/#{componentRef.original}/version/#{componentRef.majorVersion}\"\r\n      levelComponent.setURL(url)\r\n      resource = @supermodel.loadModel levelComponent\r\n      continue unless resource.isLoading\r\n      @listenToOnce resource, 'loaded', ->\r\n        return if @handlingChange\r\n        @handlingChange = true\r\n        @onComponentsAdded()\r\n        @handlingChange = false\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @buildComponentsTreema()\r\n    @addThangComponentConfigViews()\r\n\r\n  buildComponentsTreema: ->\r\n    components = _.zipObject((c.original for c in @components), @components)\r\n    defaultValue = undefined\r\n    if thangTypeComponents = @thangType?.get('components', true)\r\n      defaultValue = _.zipObject((c.original for c in thangTypeComponents), thangTypeComponents)\r\n\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: {\r\n        type: 'object'\r\n        default: defaultValue\r\n        additionalProperties: Level.schema.properties.thangs.items.properties.components.items\r\n      },\r\n      data: $.extend true, {}, components\r\n      callbacks: {select: @onSelectComponent, change: @onComponentsTreemaChanged}\r\n      nodeClasses:\r\n        'object': ThangComponentsObjectNode\r\n\r\n    @componentsTreema = @$el.find('#thang-components-column .treema').treema treemaOptions\r\n    @componentsTreema.build()\r\n\r\n  onComponentsTreemaChanged: =>\r\n    return if @handlingChange\r\n    @handlingChange = true\r\n    componentMap = {}\r\n    for component in @components\r\n      componentMap[component.original] = component\r\n\r\n    newComponentsList = []\r\n    for component in _.values(@componentsTreema.data)\r\n      newComponentsList.push(componentMap[component.original] or component)\r\n    @components = newComponentsList\r\n\r\n    # update the components list here\r\n    @onComponentsChanged()\r\n    @handlingChange = false\r\n\r\n  onComponentsChanged: =>\r\n    # happens whenever the list of components changed, one way or another\r\n    # * if the treema gets changed\r\n    # * if components are added externally, like by a modal\r\n    # * if a dependency loads and is added to the list\r\n\r\n    if @components.length < @lastComponentLength\r\n      @onComponentsRemoved()\r\n    @onComponentsAdded()\r\n\r\n  onComponentsRemoved: ->\r\n    componentMap = {}\r\n    for component in @components\r\n      componentMap[component.original] = component\r\n\r\n    thangComponentMap = {}\r\n    if thangTypeComponents = @thangType?.get('components')\r\n      for thangTypeComponent in thangTypeComponents\r\n        thangComponentMap[thangTypeComponent.original] = thangTypeComponent\r\n\r\n    # Deleting components missing dependencies.\r\n    while true\r\n      removedSomething = false\r\n      for componentRef in _.values(componentMap)\r\n        componentModel = @supermodel.getModelByOriginalAndMajorVersion(\r\n          LevelComponent, componentRef.original, componentRef.majorVersion)\r\n        for dependency in componentModel.get('dependencies') or []\r\n          unless (componentMap[dependency.original] or thangComponentMap[dependency.original])\r\n            delete componentMap[componentRef.original]\r\n            component = @supermodel.getModelByOriginal(\r\n              LevelComponent, componentRef.original)\r\n            noty {\r\n              text: \"Removed dependent component: #{component.get('name')}\"\r\n              layout: 'topCenter'\r\n              timeout: 5000\r\n              type: 'information'\r\n            }\r\n            removedSomething = true\r\n        break if removedSomething\r\n      break unless removedSomething\r\n\r\n    @components = _.values(componentMap)\r\n\r\n    # Delete individual component config views that are no longer included.\r\n    for subview in _.values(@subviews)\r\n      continue unless subview instanceof ThangComponentConfigView\r\n      unless (componentMap[subview.component.get('original')] or thangComponentMap[subview.component.get('original')])\r\n        @removeSubView(subview)\r\n\r\n    @updateComponentsList()\r\n    @reportChanges()\r\n\r\n  updateComponentsList: ->\r\n    # Before I was setting the data to the existing treema but then we had some\r\n    # nasty sorting/callback bugs. This is less efficient, but it's also less bug prone.\r\n    @buildComponentsTreema()\r\n\r\n  onComponentsAdded: ->\r\n    return unless @componentsTreema\r\n    componentMap = {}\r\n    for component in @components\r\n      componentMap[component.original] = component\r\n\r\n    if thangTypeComponents = @thangType?.get('components')\r\n      for thangTypeComponent in thangTypeComponents\r\n        componentMap[thangTypeComponent.original] = thangTypeComponent\r\n\r\n    # Go through the map, adding missing dependencies.\r\n    while true\r\n      addedSomething = false\r\n      for componentRef in _.values(componentMap)\r\n        componentModel = @supermodel.getModelByOriginalAndMajorVersion(\r\n          LevelComponent, componentRef.original, componentRef.majorVersion)\r\n        if not componentModel?.loaded\r\n          @loadComponents([componentRef])\r\n          continue\r\n        for dependency in componentModel?.get('dependencies') or []\r\n          if not componentMap[dependency.original]\r\n            component = @supermodel.getModelByOriginalAndMajorVersion(\r\n              LevelComponent, dependency.original, dependency.majorVersion)\r\n            if not component?.loaded\r\n              @loadComponents([dependency])\r\n              # will run onComponentsAdded once more when the model loads\r\n            else\r\n              addedSomething = true\r\n              noty {\r\n                text: \"Added dependency: #{component.get('name')}\"\r\n                layout: 'topCenter'\r\n                timeout: 5000\r\n                type: 'information'\r\n              }\r\n              componentMap[dependency.original] = dependency\r\n              @components.push dependency\r\n      break unless addedSomething\r\n\r\n\r\n    # Sort the component list, reorder the component config views\r\n    @updateComponentsList()\r\n    @addThangComponentConfigViews()\r\n    @checkForMissingSystems()\r\n    @reportChanges()\r\n\r\n  addThangComponentConfigViews: ->\r\n    # Detach all component config views temporarily.\r\n    componentConfigViews = {}\r\n    for subview in _.values(@subviews)\r\n      continue unless subview instanceof ThangComponentConfigView\r\n      componentConfigViews[subview.component.get('original')] = subview\r\n      subview.$el.detach()\r\n\r\n    # Put back config views into the DOM based on the component list ordering,\r\n    # adding and registering new ones as needed.\r\n    configsEl = @$el.find('#thang-component-configs')\r\n\r\n    componentRefs = _.merge {}, @componentsTreema.data\r\n    if thangTypeComponents = @thangType?.get('components')\r\n      thangComponentRefs = _.zipObject((c.original for c in thangTypeComponents), thangTypeComponents)\r\n      for thangTypeComponent in thangTypeComponents\r\n        if componentRef = componentRefs[thangTypeComponent.original]\r\n          componentRef.additionalDefaults = thangTypeComponent.config\r\n        else\r\n          modifiedRef = _.merge {}, thangTypeComponent\r\n          modifiedRef.additionalDefaults = modifiedRef.config\r\n          delete modifiedRef.config\r\n          componentRefs[thangTypeComponent.original] = modifiedRef\r\n\r\n    for componentRef in _.values(componentRefs)\r\n      subview = componentConfigViews[componentRef.original]\r\n      if not subview\r\n        subview = @makeThangComponentConfigView(componentRef)\r\n        continue unless subview\r\n        @registerSubView(subview)\r\n      subview.setIsDefaultComponent(not @componentsTreema.data[componentRef.original])\r\n      configsEl.append(subview.$el)\r\n\r\n  makeThangComponentConfigView: (thangComponent) ->\r\n    component = @supermodel.getModelByOriginal(LevelComponent, thangComponent.original)\r\n    return unless component?.loaded\r\n    config = thangComponent.config ? {}\r\n    configView = new ThangComponentConfigView({\r\n      supermodel: @supermodel\r\n      level: @level\r\n      world: @world\r\n      config: config\r\n      component: component\r\n      additionalDefaults: thangComponent.additionalDefaults\r\n    })\r\n    configView.render()\r\n    @listenTo configView, 'changed', @onConfigChanged\r\n    configView\r\n\r\n  onConfigChanged: (e) ->\r\n    foundComponent = false\r\n    for thangComponent in @components\r\n      if thangComponent.original is e.component.get('original')\r\n        thangComponent.config = e.config\r\n        foundComponent = true\r\n        break\r\n\r\n    if not foundComponent\r\n      @components.push({\r\n        original: e.component.get('original')\r\n        majorVersion: e.component.get('version').major\r\n        config: e.config\r\n      })\r\n\r\n      for subview in _.values(@subviews)\r\n        continue unless subview instanceof ThangComponentConfigView\r\n        if subview.component.get('original') is e.component.get('original')\r\n          _.defer -> subview.setIsDefaultComponent(false)\r\n          break\r\n\r\n    @updateComponentsList()\r\n    @reportChanges()\r\n\r\n  onSelectComponent: (e, nodes) =>\r\n    @componentsTreema.$el.find('.dependent').removeClass('dependent')\r\n    @$el.find('.selected-component').removeClass('selected-component')\r\n    return unless nodes.length is 1\r\n\r\n    # find dependent components\r\n    dependents = {}\r\n    dependents[nodes[0].getData().original] = true\r\n    componentsToCheck = [nodes[0].getData().original]\r\n    while componentsToCheck.length\r\n      componentOriginal = componentsToCheck.pop()\r\n      for otherComponentRef in @components\r\n        continue if otherComponentRef.original is componentOriginal\r\n        continue if dependents[otherComponentRef.original]\r\n        otherComponent = @supermodel.getModelByOriginal(LevelComponent, otherComponentRef.original)\r\n        for dependency in otherComponent.get('dependencies', true)\r\n          if dependents[dependency.original]\r\n            dependents[otherComponentRef.original] = true\r\n            componentsToCheck.push otherComponentRef.original\r\n\r\n    # highlight them\r\n    for child in _.values(@componentsTreema.childrenTreemas)\r\n      if dependents[child.getData().original]\r\n        child.$el.addClass('dependent')\r\n\r\n    # scroll to the config\r\n    for subview in _.values(@subviews)\r\n      continue unless subview instanceof ThangComponentConfigView\r\n      if subview.component.get('original') is nodes[0].getData().original\r\n        subview.$el[0].scrollIntoView()\r\n        subview.$el.addClass('selected-component')\r\n        break\r\n\r\n  onChangeExtantComponents: =>\r\n    @buildAddComponentTreema()\r\n    @reportChanges()\r\n\r\n  checkForMissingSystems: ->\r\n    return unless @level\r\n    extantSystems =\r\n      (@supermodel.getModelByOriginalAndMajorVersion LevelSystem, sn.original, sn.majorVersion).attributes.name.toLowerCase() for idx, sn of @level.get('systems')\r\n\r\n    componentModels = (@supermodel.getModelByOriginal(LevelComponent, c.original) for c in @components)\r\n    componentSystems = (c.get('system') for c in componentModels when c)\r\n\r\n    for system in componentSystems\r\n      if system isnt 'misc' and system not in extantSystems\r\n        s = \"Component requires system <strong>#{system}</strong> which is currently not included in this level.\"\r\n        noty({\r\n          text: s,\r\n          layout: 'bottomLeft',\r\n          type: 'warning'\r\n        })\r\n\r\n  reportChanges: ->\r\n    @lastComponentLength = @components.length\r\n    @trigger 'components-changed', $.extend(true, [], @components)\r\n\r\n  undo: -> @componentsTreema.undo()\r\n\r\n  redo: -> @componentsTreema.redo()\r\n\r\n  onAddComponentsButtonClicked: ->\r\n    modal = new AddThangComponentsModal({skipOriginals: (c.original for c in @components)})\r\n    @openModalView modal\r\n    @listenToOnce modal, 'hidden', ->\r\n      componentsToAdd = modal.getSelectedComponents()\r\n      sparseComponents = ({original: c.get('original'), majorVersion: c.get('version').major} for c in componentsToAdd)\r\n      @loadComponents(sparseComponents)\r\n      @components = @components.concat(sparseComponents)\r\n      @onComponentsChanged()\r\n\r\n  onThangTypeKindChanged: (e) ->\r\n    return unless defaultComponents = DEFAULT_COMPONENTS[e.kind]\r\n    for component in defaultComponents when not _.find(@components, original: component.original)\r\n      @components.push component\r\n      @onComponentsAdded()\r\n\r\n  destroy: ->\r\n    @componentsTreema?.destroy()\r\n    super()\r\n\r\nclass ThangComponentsObjectNode extends TreemaObjectNode\r\n  addNewChild: -> @addNewChildForKey('') # HACK to get the object adding to act more like adding to an array\r\n\r\n  getChildren: ->\r\n    children = super(arguments...)\r\n    children.sort(@sortFunction)\r\n\r\n  sortFunction: (a, b) =>\r\n    a = a.value ? a.defaultData\r\n    b = b.value ? b.defaultData\r\n    a = @settings.supermodel.getModelByOriginalAndMajorVersion(LevelComponent, a.original, a.majorVersion)\r\n    b = @settings.supermodel.getModelByOriginalAndMajorVersion(LevelComponent, b.original, b.majorVersion)\r\n    return 0 if not (a or b)\r\n    return 1 if not b\r\n    return -1 if not a\r\n    return 1 if a.get('system') > b.get('system')\r\n    return -1 if a.get('system') < b.get('system')\r\n    return 1 if a.get('name') > b.get('name')\r\n    return -1 if a.get('name') < b.get('name')\r\n    return 0\r\n","RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/course/edit'\r\nCourse = require 'models/Course'\r\nConfirmModal = require 'views/core/ConfirmModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nerrors = require 'core/errors'\r\napp = require 'core/application'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class CourseEditView extends RootView\r\n  id: 'editor-course-edit-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #save-button': 'onClickSaveButton'\r\n\r\n  constructor: (options, @courseID) ->\r\n    super options\r\n    @course = new Course(_id: @courseID)\r\n    @course.saveBackups = true\r\n    @supermodel.loadModel @course\r\n\r\n  onLoaded: ->\r\n    super()\r\n    @buildTreema()\r\n    @listenTo @course, 'change', =>\r\n      @course.updateI18NCoverage()\r\n      @treema.set('/', @course.attributes)\r\n\r\n  buildTreema: ->\r\n    return if @treema? or (not @course.loaded)\r\n    data = $.extend(true, {}, @course.attributes)\r\n    options =\r\n      data: data\r\n      filePath: \"db/course/#{@course.get('_id')}\"\r\n      schema: Course.schema\r\n      readOnly: me.get('anonymous')\r\n      supermodel: @supermodel\r\n    @treema = @$el.find('#course-treema').treema(options)\r\n    @treema.build()\r\n    @treema.childrenTreemas.rewards?.open(3)\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @showReadOnly() if me.get('anonymous')\r\n    @patchesView = @insertSubView(new PatchesView(@course), @$el.find('.patches-view'))\r\n    @patchesView.load()\r\n\r\n  onClickSaveButton: (e) ->\r\n    @treema.endExistingEdits()\r\n    for key, value of @treema.data\r\n      @course.set(key, value)\r\n    @course.updateI18NCoverage()\r\n\r\n    res = @course.save()\r\n\r\n    res.error (collection, response, options) =>\r\n      console.error response\r\n\r\n    res.success =>\r\n      url = \"/editor/course/#{@course.get('slug') or @course.id}\"\r\n      document.location.href = url\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class LevelSearchView extends SearchView\r\n  id: 'editor-course-home-view'\r\n  modelLabel: 'Course'\r\n  model: require 'models/Course'\r\n  modelURL: '/db/course'\r\n  tableTemplate: require 'templates/editor/course/table'\r\n  projection: ['slug', 'name', 'description', 'watchers', 'creator']\r\n  page: 'course'\r\n  canMakeNew: false\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.course_title'\r\n    context.currentNew = 'editor.new_course_title'\r\n    context.currentNewSignup = 'editor.new_course_title_login'\r\n    context.currentSearch = 'editor.course_search_title'\r\n    @$el.i18n()\r\n    context\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/docs/components-documentation-view'\r\nCocoCollection = require 'collections/CocoCollection'\r\nLevelComponent = require 'models/LevelComponent'\r\n\r\nclass ComponentDocsCollection extends CocoCollection\r\n  url: '/db/level.component?project=system,name,description,dependencies,propertyDocumentation,code'\r\n  model: LevelComponent\r\n  comparator: 'system'\r\n\r\nmodule.exports = class ComponentsDocumentationView extends CocoView\r\n  id: 'components-documentation-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n  collapsed: true\r\n\r\n  events:\r\n    'click #toggle-all-component-code': 'onToggleAllCode'\r\n\r\n  subscriptions:\r\n    'editor:view-switched': 'onViewSwitched'\r\n\r\n  constructor: (options) ->\r\n    super(options)\r\n    @componentDocs = new ComponentDocsCollection()\r\n    @loadDocs() unless options.lazy\r\n\r\n  loadDocs: ->\r\n    return if @loadingDocs\r\n    @supermodel.loadCollection @componentDocs, 'components'\r\n    @loadingDocs = true\r\n    @render()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.components = @componentDocs.models\r\n    c.marked = marked\r\n    c.codeLanguage = me.get('aceConfig')?.language ? 'python'\r\n    c\r\n\r\n  onToggleAllCode: (e) ->\r\n    @collapsed = not @collapsed\r\n    @$el.find('.collapse').collapse(if @collapsed then 'hide' else 'show')\r\n    @$el.find('#toggle-all-component-code').toggleClass 'active', not @collapsed\r\n\r\n  onViewSwitched: (e) ->\r\n    return unless e.targetURL is '#editor-level-documentation'\r\n    @loadDocs()\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/docs/systems-documentation-view'\r\nCocoCollection = require 'collections/CocoCollection'\r\nLevelSystem = require 'models/LevelSystem'\r\n\r\nclass SystemDocsCollection extends CocoCollection\r\n  url: '/db/level.system?project=name,description,code'\r\n  model: LevelSystem\r\n  comparator: 'name'\r\n\r\nmodule.exports = class SystemsDocumentationView extends CocoView\r\n  id: 'systems-documentation-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n  collapsed: true\r\n\r\n  events:\r\n    'click #toggle-all-system-code': 'onToggleAllCode'\r\n\r\n  subscriptions:\r\n    'editor:view-switched': 'onViewSwitched'\r\n\r\n  constructor: (options) ->\r\n    super(options)\r\n    @systemDocs = new SystemDocsCollection()\r\n    @loadDocs() unless options.lazy\r\n\r\n  loadDocs: ->\r\n    return if @loadingDocs\r\n    @supermodel.loadCollection @systemDocs, 'systems'\r\n    @loadingDocs = true\r\n    @render()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.systems = @systemDocs.models\r\n    c.marked = marked\r\n    c.codeLanguage = me.get('aceConfig')?.language ? 'python'\r\n    c\r\n\r\n  onToggleAllCode: (e) ->\r\n    @collapsed = not @collapsed\r\n    @$el.find('.collapse').collapse(if @collapsed then 'hide' else 'show')\r\n    @$el.find('#toggle-all-system-code').toggleClass 'active', not @collapsed\r\n\r\n  onViewSwitched: (e) ->\r\n    return unless e.targetURL is '#editor-level-documentation'\r\n    @loadDocs()\r\n","RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/level/level-edit-view'\r\nLevel = require 'models/Level'\r\nLevelSystem = require 'models/LevelSystem'\r\nLevelComponent = require 'models/LevelComponent'\r\nLevelSystems = require 'collections/LevelSystems'\r\nLevelComponents = require 'collections/LevelComponents'\r\nWorld = require 'lib/world/world'\r\nDocumentFiles = require 'collections/DocumentFiles'\r\nLevelLoader = require 'lib/LevelLoader'\r\n\r\nCampaigns = require 'collections/Campaigns'\r\nCocoCollection = require 'collections/CocoCollection'\r\nCourse = require 'models/Course'\r\n\r\n# in the template, but need to require them to load them\r\nrequire 'views/modal/RevertModal'\r\nrequire 'views/editor/level/modals/GenerateTerrainModal'\r\n\r\nThangsTabView = require './thangs/ThangsTabView'\r\nSettingsTabView = require './settings/SettingsTabView'\r\nScriptsTabView = require './scripts/ScriptsTabView'\r\nComponentsTabView = require './components/ComponentsTabView'\r\nSystemsTabView = require './systems/SystemsTabView'\r\nTasksTabView = require './tasks/TasksTabView'\r\nSaveLevelModal = require './modals/SaveLevelModal'\r\nArtisanGuideModal = require './modals/ArtisanGuideModal'\r\nForkModal = require 'views/editor/ForkModal'\r\nSaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\nSaveBranchModal = require 'views/editor/level/modals/SaveBranchModal'\r\nLoadBranchModal = require 'views/editor/level/modals/LoadBranchModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nRelatedAchievementsView = require 'views/editor/level/RelatedAchievementsView'\r\nVersionHistoryView = require './modals/LevelVersionsModal'\r\nComponentsDocumentationView = require 'views/editor/docs/ComponentsDocumentationView'\r\nSystemsDocumentationView = require 'views/editor/docs/SystemsDocumentationView'\r\nLevelFeedbackView = require 'views/editor/level/LevelFeedbackView'\r\nstorage = require 'core/storage'\r\nutils = require 'core/utils'\r\n\r\nrequire 'vendor/coffeescript' # this is tenuous, since the LevelSession and LevelComponent models are what compile the code\r\nrequire 'vendor/treema'\r\n\r\n# Make sure that all of our Aethers are loaded, so that if we try to preview the level, it will work.\r\nrequire 'vendor/aether-javascript'\r\nrequire 'vendor/aether-python'\r\nrequire 'vendor/aether-coffeescript'\r\nrequire 'vendor/aether-lua'\r\nrequire 'vendor/aether-java'\r\nrequire 'vendor/aether-html'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class LevelEditView extends RootView\r\n  id: 'editor-level-view'\r\n  className: 'editor'\r\n  template: template\r\n  cache: false\r\n\r\n  events:\r\n    'click #play-button': 'onPlayLevel'\r\n    'click .play-with-team-button': 'onPlayLevel'\r\n    'click .play-with-team-parent': 'onPlayLevelTeamSelect'\r\n    'click .play-classroom-level': 'onPlayLevel'\r\n    'click #commit-level-start-button': 'startCommittingLevel'\r\n    'click li:not(.disabled) > #fork-start-button': 'startForking'\r\n    'click #level-history-button': 'showVersionHistory'\r\n    'click #undo-button': 'onUndo'\r\n    'mouseenter #undo-button': 'showUndoDescription'\r\n    'click #redo-button': 'onRedo'\r\n    'mouseenter #redo-button': 'showRedoDescription'\r\n    'click #patches-tab': -> @patchesView.load()\r\n    'click #components-tab': -> @subviews.editor_level_components_tab_view.refreshLevelThangsTreema @level.get('thangs')\r\n    'click #artisan-guide-button': 'showArtisanGuide'\r\n    'click #level-patch-button': 'startPatchingLevel'\r\n    'click #level-watch-button': 'toggleWatchLevel'\r\n    'click li:not(.disabled) > #pop-level-i18n-button': 'onPopulateI18N'\r\n    'click a[href=\"#editor-level-documentation\"]': 'onClickDocumentationTab'\r\n    'click #save-branch': 'onClickSaveBranch'\r\n    'click #load-branch': 'onClickLoadBranch'\r\n    'mouseup .nav-tabs > li a': 'toggleTab'\r\n\r\n  constructor: (options, @levelID) ->\r\n    super options\r\n    @supermodel.shouldSaveBackups = (model) ->\r\n      model.constructor.className in ['Level', 'LevelComponent', 'LevelSystem', 'ThangType']\r\n    @levelLoader = new LevelLoader supermodel: @supermodel, levelID: @levelID, headless: true, sessionless: true, loadArticles: true\r\n    @level = @levelLoader.level\r\n    @files = new DocumentFiles(@levelLoader.level)\r\n    @supermodel.loadCollection(@files, 'file_names')\r\n    @campaigns = new Campaigns()\r\n    @supermodel.trackRequest @campaigns.fetchByType('course', { data: { project: 'levels' } })\r\n    @courses = new CocoCollection([], { url: \"/db/course\", model: Course})\r\n    @supermodel.loadCollection(@courses, 'courses')\r\n\r\n  destroy: ->\r\n    clearInterval @timerIntervalID\r\n    super()\r\n\r\n  showLoading: ($el) ->\r\n    $el ?= @$el.find('.outer-content')\r\n    super($el)\r\n\r\n  getTitle: -> \"LevelEditor - \" + (@level.get('name') or '...')\r\n\r\n  onLoaded: ->\r\n    _.defer =>\r\n      @world = @levelLoader.world\r\n      @render()\r\n      @timerIntervalID = setInterval @incrementBuildTime, 1000\r\n    campaignCourseMap = {}\r\n    campaignCourseMap[course.get('campaignID')] = course.id for course in @courses.models\r\n    for campaign in @campaigns.models\r\n      for levelID, level of campaign.get('levels') when levelID is @level.get('original')\r\n        @courseID = campaignCourseMap[campaign.id]\r\n      break if @courseID\r\n    if not @courseID and me.isAdmin()\r\n      # Give it a fake course ID so we can test it in course mode before it's in a course.\r\n      @courseID = '560f1a9f22961295f9427742'\r\n    @getLevelCompletionRate()\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.level = @level\r\n    context.authorized = me.isAdmin() or @level.hasWriteAccess(me)\r\n    context.anonymous = me.get('anonymous')\r\n    context.recentlyPlayedOpponents = storage.load('recently-played-matches')?[@levelID] ? []\r\n    context\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @$el.find('a[data-toggle=\"tab\"]').on 'shown.bs.tab', (e) =>\r\n      Backbone.Mediator.publish 'editor:view-switched', {targetURL: $(e.target).attr('href')}\r\n    @listenTo @level, 'change:tasks', => @renderSelectors '#tasks-tab'\r\n    @insertSubView new ThangsTabView world: @world, supermodel: @supermodel, level: @level\r\n    @insertSubView new SettingsTabView supermodel: @supermodel\r\n    @insertSubView new ScriptsTabView world: @world, supermodel: @supermodel, files: @files\r\n    @insertSubView new ComponentsTabView supermodel: @supermodel\r\n    @insertSubView new SystemsTabView supermodel: @supermodel, world: @world\r\n    @insertSubView new TasksTabView world: @world, supermodel: @supermodel, level: @level\r\n    @insertSubView new RelatedAchievementsView supermodel: @supermodel, level: @level\r\n    @insertSubView new ComponentsDocumentationView lazy: true  # Don't give it the supermodel, it'll pollute it!\r\n    @insertSubView new SystemsDocumentationView lazy: true  # Don't give it the supermodel, it'll pollute it!\r\n    @insertSubView new LevelFeedbackView level: @level\r\n\r\n    Backbone.Mediator.publish 'editor:level-loaded', level: @level\r\n    @showReadOnly() if me.get('anonymous')\r\n    @patchesView = @insertSubView(new PatchesView(@level), @$el.find('.patches-view'))\r\n    @listenTo @patchesView, 'accepted-patch', -> location.reload() unless key.shift  # Reload to make sure changes propagate, unless secret shift shortcut\r\n    @$el.find('#level-watch-button').find('> span').toggleClass('secret') if @level.watching()\r\n\r\n  onPlayLevelTeamSelect: (e) ->\r\n    if @childWindow and not @childWindow.closed\r\n      # We already have a child window open, so we don't need to ask for a team; we'll use its existing team.\r\n      e.stopImmediatePropagation()\r\n      @onPlayLevel e\r\n\r\n  onPlayLevel: (e) ->\r\n    team = $(e.target).data('team')\r\n    opponentSessionID = $(e.target).data('opponent')\r\n    if $(e.target).data('classroom') is 'home'\r\n      newClassMode = @lastNewClassMode = undefined\r\n    else if $(e.target).data('classroom')\r\n      newClassMode = @lastNewClassMode = true\r\n    else\r\n      newClassMode = @lastNewClassMode\r\n    newClassLanguage = @lastNewClassLanguage = ($(e.target).data('code-language') ? @lastNewClassLanguage) or undefined\r\n    sendLevel = =>\r\n      @childWindow.Backbone.Mediator.publish 'level:reload-from-data', level: @level, supermodel: @supermodel\r\n    if @childWindow and not @childWindow.closed and @playClassMode is newClassMode and @playClassLanguage is newClassLanguage\r\n      # Reset the LevelView's world, but leave the rest of the state alone\r\n      sendLevel()\r\n    else\r\n      # Create a new Window with a blank LevelView\r\n      scratchLevelID = @level.get('slug') + '?dev=true'\r\n      scratchLevelID += \"&team=#{team}\" if team\r\n      scratchLevelID += \"&opponent=#{opponentSessionID}\" if opponentSessionID\r\n      @playClassMode = newClassMode\r\n      @playClassLanguage = newClassLanguage\r\n      if @playClassMode\r\n        scratchLevelID += \"&course=#{@courseID}\"\r\n        scratchLevelID += \"&codeLanguage=#{@playClassLanguage}\"\r\n      if me.get('name') is 'Nick'\r\n        @childWindow = window.open(\"/play/level/#{scratchLevelID}\", 'child_window', 'width=2560,height=1080,left=0,top=-1600,location=1,menubar=1,scrollbars=1,status=0,titlebar=1,toolbar=1', true)\r\n      else\r\n        @childWindow = window.open(\"/play/level/#{scratchLevelID}\", 'child_window', 'width=1280,height=640,left=10,top=10,location=0,menubar=0,scrollbars=0,status=0,titlebar=0,toolbar=0', true)\r\n      @childWindow.onPlayLevelViewLoaded = (e) => sendLevel()  # still a hack\r\n    @childWindow.focus()\r\n\r\n  onUndo: ->\r\n    TreemaNode.getLastTreemaWithFocus()?.undo()\r\n\r\n  onRedo: ->\r\n    TreemaNode.getLastTreemaWithFocus()?.redo()\r\n\r\n  showUndoDescription: ->\r\n    undoDescription = TreemaNode.getLastTreemaWithFocus().getUndoDescription()\r\n    @$el.find('#undo-button').attr('title', $.i18n.t(\"general.undo_prefix\") + \" \" + undoDescription + \" \" + $.i18n.t(\"general.undo_shortcut\"))\r\n\r\n  showRedoDescription: ->\r\n    redoDescription = TreemaNode.getLastTreemaWithFocus().getRedoDescription()\r\n    @$el.find('#redo-button').attr('title', $.i18n.t(\"general.redo_prefix\") + \" \" + redoDescription + \" \" + $.i18n.t(\"general.redo_shortcut\"))\r\n\r\n  getCurrentView: ->\r\n    currentViewID = @$el.find('.tab-pane.active').attr('id')\r\n    return @patchesView if currentViewID is 'editor-level-patches'\r\n    currentViewID = 'components-documentation-view' if currentViewID is 'editor-level-documentation'\r\n    return @subviews[_.string.underscored(currentViewID)]\r\n\r\n  startPatchingLevel: (e) ->\r\n    @openModalView new SaveVersionModal({model: @level})\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  startCommittingLevel: (e) ->\r\n    @openModalView new SaveLevelModal level: @level, supermodel: @supermodel, buildTime: @levelBuildTime\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  showArtisanGuide: (e) ->\r\n    @openModalView new ArtisanGuideModal level: @level\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  startForking: (e) ->\r\n    @openModalView new ForkModal model: @level, editorPath: 'level'\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  showVersionHistory: (e) ->\r\n    versionHistoryView = new VersionHistoryView level: @level, @levelID\r\n    @openModalView versionHistoryView\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  toggleWatchLevel: ->\r\n    button = @$el.find('#level-watch-button')\r\n    @level.watch(button.find('.watch').is(':visible'))\r\n    button.find('> span').toggleClass('secret')\r\n\r\n  onPopulateI18N: ->\r\n    totalChanges = @level.populateI18N()\r\n\r\n    levelComponentMap = _(currentView.supermodel.getModels(LevelComponent))\r\n      .map((c) -> [c.get('original'), c])\r\n      .object()\r\n      .value()\r\n\r\n    for thang, thangIndex in @level.get('thangs')\r\n      for thangComponent, thangComponentIndex in thang.components\r\n        component = levelComponentMap[thangComponent.original]\r\n        configSchema = component.get('configSchema')\r\n        path = \"/thangs/#{thangIndex}/components/#{thangComponentIndex}/config\"\r\n        totalChanges += @level.populateI18N(thangComponent.config, configSchema, path)\r\n\r\n    if totalChanges\r\n      f = -> document.location.reload()\r\n      setTimeout(f, 500)\r\n    else\r\n      noty timeout: 2000, text: 'No changes.', type: 'information', layout: 'topRight'\r\n\r\n  onClickSaveBranch: ->\r\n    components = new LevelComponents(@supermodel.getModels(LevelComponent))\r\n    systems = new LevelSystems(@supermodel.getModels(LevelSystem))\r\n    @openModalView new SaveBranchModal({components, systems})\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  onClickLoadBranch: ->\r\n    components = new LevelComponents(@supermodel.getModels(LevelComponent))\r\n    systems = new LevelSystems(@supermodel.getModels(LevelSystem))\r\n    @openModalView new LoadBranchModal({components, systems})\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  toggleTab: (e) ->\r\n    @renderScrollbar()\r\n    return unless $(document).width() <= 800\r\n    li = $(e.target).closest('li')\r\n    if li.hasClass('active')\r\n      li.parent().find('li').show()\r\n    else\r\n      li.parent().find('li').hide()\r\n      li.show()\r\n    console.log li.hasClass('active')\r\n\r\n  onClickDocumentationTab: (e) ->\r\n    # It's either too late at night or something is going on with Bootstrap nested tabs, so we do the click instead of using .active.\r\n    return if @initializedDocs\r\n    @initializedDocs = true\r\n    @$el.find('a[href=\"#components-documentation-view\"]').click()\r\n\r\n  incrementBuildTime: =>\r\n    return if application.userIsIdle\r\n    @levelBuildTime ?= @level.get('buildTime') ? 0\r\n    ++@levelBuildTime\r\n\r\n  getTaskCompletionRatio: ->\r\n    if not @level.get('tasks')?\r\n      return '0/0'\r\n    else\r\n      return _.filter(@level.get('tasks'), (_elem) -> return _elem.complete).length + '/' + @level.get('tasks').length\r\n\r\n  getLevelCompletionRate: ->\r\n    return unless me.isAdmin()\r\n    startDay = utils.getUTCDay -14\r\n    startDayDashed = \"#{startDay[0..3]}-#{startDay[4..5]}-#{startDay[6..7]}\"\r\n    endDay = utils.getUTCDay -1\r\n    endDayDashed = \"#{endDay[0..3]}-#{endDay[4..5]}-#{endDay[6..7]}\"\r\n    success = (data) =>\r\n      return if @destroyed\r\n      started = 0\r\n      finished = 0\r\n      for day in data\r\n        started += day.started ? 0\r\n        finished += day.finished ? 0\r\n      rate = finished / started\r\n      rateDisplay = (rate * 100).toFixed(1) + '%'\r\n      @$('#completion-rate').text rateDisplay\r\n    request = @supermodel.addRequestResource 'level_completions', {\r\n      url: '/db/analytics_perday/-/level_completions'\r\n      data: {startDay: startDay, endDay: endDay, slug: @level.get('slug')}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n","CocoView = require 'views/core/CocoView'\r\nCocoCollection = require 'collections/CocoCollection'\r\ntemplate = require 'templates/editor/level/level-feedback-view'\r\nLevel = require 'models/Level'\r\nLevelFeedback = require 'models/LevelFeedback'\r\n\r\nclass LevelFeedbackCollection extends CocoCollection\r\n  model: LevelFeedback\r\n  initialize: (models, options) ->\r\n    super models, options\r\n    @url = \"/db/level/#{options.level.get('slug')}/all_feedback\"\r\n\r\n  comparator: (a, b) ->\r\n    score = 0\r\n    score -= 9001900190019001 if a.get('creator') is me.id\r\n    score += 9001900190019001 if b.get('creator') is me.id\r\n    score -= new Date(a.get 'created')\r\n    score -= -(new Date(b.get 'created'))\r\n    score -= 900190019001 if a.get('review')\r\n    score += 900190019001 if b.get('review')\r\n    if score < 0 then -1 else (if score > 0 then 1 else 0)\r\n\r\nmodule.exports = class LevelFeedbackView extends CocoView\r\n  id: 'level-feedback-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  subscriptions:\r\n    'editor:view-switched': 'onViewSwitched'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.moment = moment\r\n    context.allFeedback = []\r\n    context.averageRating = 0\r\n    context.totalRatings = 0\r\n    if @allFeedback?.models.length\r\n      context.allFeedback = (m.attributes for m in @allFeedback.models when @allFeedback.models.length < 20 or m.get('review'))\r\n      context.averageRating = _.reduce((m.get('rating') for m in @allFeedback.models), (acc, x) -> acc + (x ? 5)) / (@allFeedback.models.length)\r\n      context.totalRatings = @allFeedback.models.length\r\n    else\r\n      context.loading = true\r\n    context\r\n\r\n  onViewSwitched: (e) ->\r\n    # Lazily load.\r\n    return unless e.targetURL is '#level-feedback-view'\r\n    unless @allFeedback\r\n      @allFeedback = @supermodel.loadCollection(new LevelFeedbackCollection(null, level: @options.level), 'feedback').model\r\n      @render()\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class LevelSearchView extends SearchView\r\n  id: 'editor-level-home-view'\r\n  modelLabel: 'Level'\r\n  model: require 'models/Level'\r\n  modelURL: '/db/level'\r\n  tableTemplate: require 'templates/editor/level/table'\r\n  projection: ['slug', 'name', 'description', 'version', 'watchers', 'creator']\r\n  page: 'level'\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.level_title'\r\n    context.currentNew = 'editor.new_level_title'\r\n    context.currentNewSignup = 'editor.new_level_title_login'\r\n    context.currentSearch = 'editor.level_search_title'\r\n    @$el.i18n()\r\n    context\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/related-achievements'\r\nRelatedAchievementsCollection = require 'collections/RelatedAchievementsCollection'\r\nAchievement = require 'models/Achievement'\r\nNewAchievementModal = require './modals/NewAchievementModal'\r\napp = require 'core/application'\r\n\r\nmodule.exports = class RelatedAchievementsView extends CocoView\r\n  id: 'related-achievements-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  events:\r\n    'click #new-achievement-button': 'makeNewAchievement'\r\n\r\n  subscriptions:\r\n    'editor:view-switched': 'onViewSwitched'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @level = options.level\r\n    @relatedID = @level.get('original')\r\n    @achievements = new RelatedAchievementsCollection @relatedID\r\n\r\n  loadAchievements: ->\r\n    return if @loadingAchievements\r\n    @supermodel.loadCollection @achievements, 'achievements'\r\n    @loadingAchievements = true\r\n    @render()\r\n\r\n  onNewAchievementSaved: (achievement) ->\r\n    # We actually open the new tab in NewAchievementModal, so we don't replace this window.\r\n    #url = '/editor/achievement/' + (achievement.get('slug') or achievement.id)\r\n    #app.router.navigate(, {trigger: true})  # Let's open a new tab instead.\r\n\r\n  makeNewAchievement: ->\r\n    modal = new NewAchievementModal model: Achievement, modelLabel: 'Achievement', level: @level\r\n    modal.once 'model-created', @onNewAchievementSaved\r\n    @openModalView modal\r\n\r\n  onViewSwitched: (e) ->\r\n    # Lazily load.\r\n    return unless e.targetURL is '#related-achievements-view'\r\n    @loadAchievements()\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/components_tab'\r\nThangType = require 'models/ThangType'\r\nLevelComponent = require 'models/LevelComponent'\r\nLevelComponentEditView = require './LevelComponentEditView'\r\nLevelComponentNewView = require './NewLevelComponentModal'\r\nrequire 'vendor/treema'\r\n\r\nclass LevelComponentCollection extends Backbone.Collection\r\n  url: '/db/level.component'\r\n  model: LevelComponent\r\n\r\nmodule.exports = class ComponentsTabView extends CocoView\r\n  id: 'editor-level-components-tab-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  subscriptions:\r\n    'editor:level-component-editing-ended': 'onLevelComponentEditingEnded'\r\n\r\n  events:\r\n    'click #create-new-component-button': 'createNewLevelComponent'\r\n    'click #create-new-component-button-no-select': 'createNewLevelComponent'\r\n\r\n  onLoaded: ->\r\n\r\n  refreshLevelThangsTreema: (thangsData) ->\r\n    presentComponents = {}\r\n    for thang in thangsData\r\n      componentMap = {}\r\n      thangType = @supermodel.getModelByOriginal ThangType, thang.thangType\r\n      for component in thangType.get('components') ? []\r\n        componentMap[component.original] = component\r\n\r\n      for component in thang.components\r\n        componentMap[component.original] = component\r\n\r\n      for component in _.values(componentMap)\r\n        haveThisComponent = (presentComponents[component.original + '.' + (component.majorVersion ? 0)] ?= [])\r\n        haveThisComponent.push thang.id if haveThisComponent.length < 100  # for performance when adding many Thangs\r\n    return if _.isEqual presentComponents, @presentComponents\r\n    @presentComponents = presentComponents\r\n\r\n    componentModels = @supermodel.getModels LevelComponent\r\n    componentModelMap = {}\r\n    componentModelMap[comp.get('original')] = comp for comp in componentModels\r\n    components = ({original: key.split('.')[0], majorVersion: parseInt(key.split('.')[1], 10), thangs: value, count: value.length} for key, value of @presentComponents)\r\n    components = components.concat ({original: c.get('original'), majorVersion: c.get('version').major, thangs: [], count: 0} for c in componentModels when not @presentComponents[c.get('original') + '.' + c.get('version').major])\r\n    treemaData = _.sortBy components, (comp) =>\r\n      component = componentModelMap[comp.original]\r\n      res = [(if comp.count then 0 else 1), component.get('system'), component.get('name')]\r\n      return res\r\n\r\n    res = {}\r\n    res[treemaData[key].original] = treemaData[key] for key in [0 ... treemaData.length]\r\n    treemaData = (value for key, value of res)  # Removing duplicates from treemaData\r\n\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: {type: 'array', items: {type: 'object', format: 'level-component'}}\r\n      data: treemaData\r\n      callbacks:\r\n        select: @onTreemaComponentSelected\r\n      readOnly: true\r\n      nodeClasses: {'level-component': LevelComponentNode}\r\n    @componentsTreema = @$el.find('#components-treema').treema treemaOptions\r\n    @componentsTreema.build()\r\n    @componentsTreema.open()\r\n\r\n  onTreemaComponentSelected: (e, selected) =>\r\n    selected = if selected.length > 1 then selected[0].getLastSelectedTreema() else selected[0]\r\n    unless selected\r\n      @removeSubView @levelComponentEditView\r\n      @levelComponentEditView = null\r\n      return\r\n\r\n    @editLevelComponent original: selected.data.original, majorVersion: selected.data.majorVersion\r\n\r\n  createNewLevelComponent: (e) ->\r\n    levelComponentNewView = new LevelComponentNewView supermodel: @supermodel\r\n    @openModalView levelComponentNewView\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  editLevelComponent: (e) ->\r\n    @levelComponentEditView = @insertSubView new LevelComponentEditView(original: e.original, majorVersion: e.majorVersion, supermodel: @supermodel)\r\n\r\n  onLevelComponentEditingEnded: (e) ->\r\n    @removeSubView @levelComponentEditView\r\n    @levelComponentEditView = null\r\n\r\n  destroy: ->\r\n    @componentsTreema?.destroy()\r\n    super()\r\n\r\nclass LevelComponentNode extends TreemaObjectNode\r\n  valueClass: 'treema-level-component'\r\n  collection: false\r\n  buildValueForDisplay: (valEl, data) ->\r\n    count = if data.count is 1 then data.thangs[0] else ((if data.count >= 100 then '100+' else data.count) + ' Thangs')\r\n    if data.original.match ':'\r\n      name = 'Old: ' + data.original.replace('systems/', '')\r\n    else\r\n      comp = _.find @settings.supermodel.getModels(LevelComponent), (m) =>\r\n        m.get('original') is data.original and m.get('version').major is data.majorVersion\r\n      name = \"#{comp.get('system')}.#{comp.get('name')} v#{comp.get('version').major}\"\r\n    result = @buildValueForDisplaySimply valEl, \"#{name} (#{count})\"\r\n    result.addClass 'not-present' unless data.count\r\n    result\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/component/level-component-edit-view'\r\nLevelComponent = require 'models/LevelComponent'\r\nComponentVersionsModal = require 'views/editor/component/ComponentVersionsModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nSaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\nace = require 'ace'\r\n\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class LevelComponentEditView extends CocoView\r\n  id: 'level-component-edit-view'\r\n  template: template\r\n  editableSettings: ['name', 'description', 'system', 'codeLanguage', 'dependencies', 'propertyDocumentation', 'i18n']\r\n\r\n  events:\r\n    'click #done-editing-component-button': 'endEditing'\r\n    'click .nav a': (e) -> $(e.target).tab('show')\r\n    'click #component-patches-tab': -> @patchesView.load()\r\n    'click #component-code-tab': 'buildCodeEditor'\r\n    'click #component-config-schema-tab': 'buildConfigSchemaTreema'\r\n    'click #component-settings-tab': 'buildSettingsTreema'\r\n    'click #component-history-button': 'showVersionHistory'\r\n    'click #patch-component-button': 'startPatchingComponent'\r\n    'click #component-watch-button': 'toggleWatchComponent'\r\n    'click #pop-component-i18n-button': 'onPopulateI18N' \r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @levelComponent = @supermodel.getModelByOriginalAndMajorVersion LevelComponent, options.original, options.majorVersion or 0\r\n    console.log 'Couldn\\'t get levelComponent for', options, 'from', @supermodel.models unless @levelComponent\r\n    @onEditorChange = _.debounce @onEditorChange, 1000\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.editTitle = \"#{@levelComponent.get('system')}.#{@levelComponent.get('name')}\"\r\n    context.component = @levelComponent\r\n    context\r\n\r\n  onLoaded: -> @render()\r\n\r\n  afterRender: ->\r\n    super()\r\n    @buildSettingsTreema()\r\n    @buildConfigSchemaTreema()\r\n    @buildCodeEditor()\r\n    @patchesView = @insertSubView(new PatchesView(@levelComponent), @$el.find('.patches-view'))\r\n    @$el.find('#component-watch-button').find('> span').toggleClass('secret') if @levelComponent.watching()\r\n    @updatePatchButton()\r\n\r\n  buildSettingsTreema: ->\r\n    data = _.pick @levelComponent.attributes, (value, key) => key in @editableSettings\r\n    data = $.extend(true, {}, data)\r\n    schema = _.cloneDeep LevelComponent.schema\r\n    schema.properties = _.pick schema.properties, (value, key) => key in @editableSettings\r\n    schema.required = _.intersection schema.required, @editableSettings\r\n    schema.default = _.pick schema.default, (value, key) => key in @editableSettings\r\n\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: schema\r\n      data: data\r\n      readonly: me.get('anonymous')\r\n      callbacks: {change: @onComponentSettingsEdited}\r\n    @componentSettingsTreema = @$el.find('#edit-component-treema').treema treemaOptions\r\n    @componentSettingsTreema.build()\r\n    @componentSettingsTreema.open()\r\n\r\n  onComponentSettingsEdited: =>\r\n    # Make sure it validates first?\r\n    for key, value of @componentSettingsTreema.data\r\n      @levelComponent.set key, value unless key is 'js' # will compile code if needed\r\n    @updatePatchButton()\r\n\r\n  buildConfigSchemaTreema: ->\r\n    configSchema = $.extend true, {}, @levelComponent.get 'configSchema'\r\n    if configSchema.properties\r\n      # Alphabetize (#1297)\r\n      propertyNames = _.keys configSchema.properties\r\n      propertyNames.sort()\r\n      orderedProperties = {}\r\n      for prop in propertyNames\r\n        orderedProperties[prop] = configSchema.properties[prop]\r\n      configSchema.properties = orderedProperties\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: LevelComponent.schema.properties.configSchema\r\n      data: configSchema\r\n      readOnly: me.get('anonymous')\r\n      callbacks: {change: @onConfigSchemaEdited}\r\n    @configSchemaTreema = @$el.find('#config-schema-treema').treema treemaOptions\r\n    @configSchemaTreema.build()\r\n    @configSchemaTreema.open()\r\n    # TODO: schema is not loaded for the first one here?\r\n    @configSchemaTreema.tv4.addSchema('metaschema', LevelComponent.schema.properties.configSchema)\r\n\r\n  onConfigSchemaEdited: =>\r\n    @levelComponent.set 'configSchema', @configSchemaTreema.data\r\n    @updatePatchButton()\r\n\r\n  buildCodeEditor: ->\r\n    @destroyAceEditor(@editor)\r\n    editorEl = $('<div></div>').text(@levelComponent.get('code')).addClass('inner-editor')\r\n    @$el.find('#component-code-editor').empty().append(editorEl)\r\n    @editor = ace.edit(editorEl[0])\r\n    @editor.setReadOnly(me.get('anonymous'))\r\n    session = @editor.getSession()\r\n    session.setMode 'ace/mode/coffee'\r\n    session.setTabSize 2\r\n    session.setNewLineMode = 'unix'\r\n    session.setUseSoftTabs true\r\n    @editor.on('change', @onEditorChange)\r\n\r\n  onEditorChange: =>\r\n    return if @destroyed\r\n    @levelComponent.set 'code', @editor.getValue()\r\n    @updatePatchButton()\r\n\r\n  updatePatchButton: ->\r\n    @$el.find('#patch-component-button').toggle Boolean @levelComponent.hasLocalChanges()\r\n\r\n  endEditing: (e) ->\r\n    Backbone.Mediator.publish 'editor:level-component-editing-ended', component: @levelComponent\r\n    null\r\n\r\n  showVersionHistory: (e) ->\r\n    componentVersionsModal = new ComponentVersionsModal {}, @levelComponent.id\r\n    @openModalView componentVersionsModal\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  startPatchingComponent: (e) ->\r\n    @openModalView new SaveVersionModal({model: @levelComponent})\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  toggleWatchComponent: ->\r\n    button = @$el.find('#component-watch-button')\r\n    @levelComponent.watch(button.find('.watch').is(':visible'))\r\n    button.find('> span').toggleClass('secret')\r\n\r\n  onPopulateI18N: ->\r\n    @levelComponent.populateI18N()\r\n    @render()\r\n\r\n  destroy: ->\r\n    @destroyAceEditor(@editor)\r\n    @componentSettingsTreema?.destroy()\r\n    @configSchemaTreema?.destroy()\r\n    super()\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/component/new'\r\nLevelComponent = require 'models/LevelComponent'\r\nforms = require 'core/forms'\r\n{me} = require 'core/auth'\r\n\r\nmodule.exports = class NewLevelComponentModal extends ModalView\r\n  id: 'editor-level-component-new-modal'\r\n  template: template\r\n  instant: false\r\n  modalWidthPercent: 60\r\n\r\n  events:\r\n    'click #new-level-component-submit': 'makeNewLevelComponent'\r\n    'submit form': 'makeNewLevelComponent'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @systems = LevelComponent.schema.properties.system.enum\r\n\r\n  makeNewLevelComponent: (e) ->\r\n    e.preventDefault()\r\n    system = @$el.find('#level-component-system').val()\r\n    name = @$el.find('#level-component-name').val()\r\n    component = new LevelComponent()\r\n    component.set 'system', system\r\n    component.set 'name', name\r\n    component.set 'code', component.get('code', true).replace(/AttacksSelf/g, name)\r\n    component.set 'permissions', [{access: 'owner', target: me.id}]  # Private until saved in a published Level\r\n    res = component.save(null, {type: 'POST'})  # Override PUT so we can trigger postFirstVersion logic\r\n    return unless res\r\n\r\n    @showLoading()\r\n    res.error =>\r\n      @hideLoading()\r\n      console.log 'Got errors:', JSON.parse(res.responseText)\r\n      forms.applyErrorsToForm(@$el, JSON.parse(res.responseText))\r\n    res.success =>\r\n      @supermodel.registerModel component\r\n      @hide()\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/artisan-guide-modal'\r\n\r\nforms = require 'core/forms'\r\n{sendContactMessage} = require 'core/contact'\r\n\r\ncontactSchema =\r\n  additionalProperties: false\r\n  required: ['creditName', 'levelPurpose', 'levelInspiration', 'levelLocation']\r\n  properties:\r\n    creditName:\r\n      type: 'string'\r\n    levelPurpose:\r\n      type: 'string'\r\n    levelInspiration:\r\n      type: 'string'\r\n    levelLocation:\r\n      type: 'string'\r\n\r\nmodule.exports = class ArtisanGuideModal extends ModalView\r\n  id: 'artisan-guide-modal'\r\n  template: template\r\n  events:\r\n    'click #level-submit': 'levelSubmit'\r\n\r\n  initialize: (options) ->\r\n    @level = options.level\r\n    @options = \r\n      level:@level.get('name')\r\n      levelSlug:@level.get('slug')\r\n\r\n  levelSubmit: ->\r\n    @playSound 'menu-button-click'\r\n    forms.clearFormAlerts @$el\r\n    results = forms.formToObject @$el\r\n    res = tv4.validateMultiple results, contactSchema\r\n    return forms.applyErrorsToForm @$el, res.errors unless res.valid\r\n    contactMessage = {message:\"\"\"User Name: #{results.creditName}\r\n      Level: <a href=\"http://codecombat.com/editor/level/#{@options.levelSlug}\">#{@options.level}</a>\r\n      Purpose: #{results.levelPurpose}\r\n      Inspiration: #{results.levelInspiration}\r\n      Location: #{results.levelLocation}\"\"\"}\r\n    @populateBrowserData contactMessage\r\n    contactMessage = _.merge contactMessage, @options\r\n    contactMessage.country = me.get('country')\r\n    sendContactMessage contactMessage, @$el\r\n    $.post \"/db/user/#{me.id}/track/contact_codecombat\"\r\n\r\n  populateBrowserData: (context) ->\r\n    if $.browser\r\n      context.browser = \"#{$.browser.platform} #{$.browser.name} #{$.browser.versionNumber}\"\r\n    context.screenSize = \"#{screen?.width ? $(window).width()} x #{screen?.height ? $(window).height()}\"\r\n    context.screenshotURL = @screenshotURL\r\n\r\n  hasOwnership: ->\r\n    if @level.getOwner() is me.id\r\n      return true\r\n    return false","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/generate-terrain-modal'\r\nCocoModel = require 'models/CocoModel'\r\n\r\nclusters = {\r\n  'hero': {\r\n    'thangs': ['Hero Placeholder']\r\n    'margin': 1\r\n  }\r\n  'rocks': {\r\n    'thangs': ['Rock 1', 'Rock 2', 'Rock 3', 'Rock 4', 'Rock 5', 'Rock Cluster 1', 'Rock Cluster 2', 'Rock Cluster 3']\r\n    'margin': 1\r\n  }\r\n  'trees': {\r\n    'thangs': ['Tree 1', 'Tree 2', 'Tree 3', 'Tree 4']\r\n    'margin': 0.5\r\n    }\r\n  'tree_stands': {\r\n    'thangs': ['Tree Stand 1', 'Tree Stand 2', 'Tree Stand 3', 'Tree Stand 4', 'Tree Stand 5', 'Tree Stand 6']\r\n    'margin': 3\r\n  }\r\n  'shrubs': {\r\n    'thangs': ['Shrub 1', 'Shrub 2', 'Shrub 3']\r\n    'margin': 0.5\r\n    }\r\n  'houses': {\r\n    'thangs': ['House 1', 'House 2', 'House 3', 'House 4']\r\n    'margin': 4\r\n    }\r\n  'animals': {\r\n    'thangs': ['Cow', 'Horse']\r\n    'margin': 1\r\n    }\r\n  'wood': {\r\n    'thangs': ['Firewood 1', 'Firewood 2', 'Firewood 3']\r\n    'margin': 1\r\n    }\r\n  'farm': {\r\n    'thangs': ['Farm']\r\n    'margin': 9\r\n    }\r\n  'cave': {\r\n    'thangs': ['Cave']\r\n    'margin': 5\r\n    }\r\n  'stone': {\r\n    'thangs': ['Gargoyle', 'Rock Cluster 1', 'Rock Cluster 2', 'Rock Cluster 3']\r\n    'margin': 1\r\n    }\r\n  'torch': {\r\n    'thangs': ['Torch']\r\n    'margin': 0\r\n  }\r\n  'chains': {\r\n    'thangs': ['Chains']\r\n    'margin': 0\r\n  }\r\n  'barrel': {\r\n    'thangs': ['Barrel']\r\n    'margin': 1\r\n  }\r\n  'doors': {\r\n    'thangs': ['Dungeon Door']\r\n    'margin': -1\r\n    }\r\n  'grass_floor': {\r\n    'thangs': ['Grass01', 'Grass02', 'Grass03', 'Grass04', 'Grass05']\r\n    'margin': -1\r\n    }\r\n  'dungeon_wall': {\r\n    'thangs': ['Dungeon Wall']\r\n    'margin': 2\r\n    }\r\n  'dungeon_floor': {\r\n    'thangs': ['Dungeon Floor']\r\n    'margin': -1\r\n    }\r\n  'indoor_wall': {\r\n    'thangs': ['Indoor Wall']\r\n    'margin': 2\r\n    }\r\n  'indoor_floor': {\r\n    'thangs': ['Indoor Floor']\r\n    'margin': -1\r\n    }\r\n  'furniture': {\r\n    'thangs': ['Bookshelf', 'Chair', 'Table', 'Candle', 'Treasure Chest']\r\n    'margin': -1\r\n    }\r\n  'desert_walls': {\r\n    'thangs': ['Desert Wall 1', 'Desert Wall 2', 'Desert Wall 3', 'Desert Wall 4', 'Desert Wall 5', 'Desert Wall 6', 'Desert Wall 7', 'Desert Wall 8']\r\n    'margin': 6\r\n  }\r\n  'desert_floor': {\r\n    'thangs': ['Sand 01', 'Sand 02', 'Sand 03', 'Sand 04', 'Sand 05', 'Sand 06']\r\n    'margin': -1\r\n  }\r\n  'oases': {\r\n    'thangs': ['Oasis 1', 'Oasis 2', 'Oasis 3']\r\n    'margin': 4\r\n  }\r\n  'mountain_floor': {\r\n    'thangs': ['Talus 1', 'Talus 2', 'Talus 3', 'Talus 4', 'Talus 5', 'Talus 6']\r\n    'margin': -1\r\n  }\r\n  'mountain_walls': {\r\n    'thangs': ['Mountain 1','Mountain 3']\r\n    'margin': 6\r\n  }\r\n  'glacier_floor': {\r\n    'thangs': ['Firn 1', 'Firn 2', 'Firn 3', 'Firn 4', 'Firn 5', 'Firn 6']\r\n    'margin': -1\r\n  }\r\n  'glacier_walls': {\r\n    'thangs': ['Ice Wall']\r\n    'margin': 2\r\n  }\r\n}\r\n\r\npresets = {\r\n  'dungeon': {\r\n    'terrainName': 'Dungeon'\r\n    'type':'dungeon'\r\n    'borders':'dungeon_wall'\r\n    'borderNoise':0\r\n    'borderSize':4\r\n    'borderThickness':1\r\n    'floors':'dungeon_floor'\r\n    'decorations': {\r\n      'Room': {\r\n        'num': [1,1]\r\n        'width': [12, 20]\r\n        'height': [8, 16]\r\n        'thickness': [2,2]\r\n        'cluster': 'dungeon_wall'\r\n      }\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n      'Barrels': {\r\n        'num': [1,1]\r\n        'width': [8, 12]\r\n        'height': [8, 12]\r\n        'numBarrels': [4,6]\r\n        'cluster': 'barrel'\r\n      }\r\n      'cave': {\r\n        'num':[1,1]\r\n        'width': 10\r\n        'height': 10\r\n        'clusters': {\r\n          'cave':[1,1]\r\n          'stone':[2,4]\r\n        }\r\n      }\r\n    }\r\n  }\r\n  'indoor': {\r\n    'terrainName': 'Indoor'\r\n    'type':'indoor'\r\n    'borders':'indoor_wall'\r\n    'borderNoise':0\r\n    'borderSize':4\r\n    'borderThickness':1\r\n    'floors':'indoor_floor'\r\n    'decorations': {\r\n      'Room': {\r\n        'num': [1,1]\r\n        'width': [12, 20]\r\n        'height': [8, 16]\r\n        'thickness': [2,2]\r\n        'cluster': 'indoor_wall'\r\n      }\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n      'furniture': {\r\n        'num':[1,2]\r\n        'width': 15\r\n        'height': 15\r\n        'clusters': {\r\n          'furniture':[2,4]\r\n        }\r\n      }\r\n    }\r\n  }\r\n  'grassy': {\r\n    'terrainName': 'Grass'\r\n    'type':'grassy'\r\n    'borders':'tree_stands'\r\n    'borderNoise':1\r\n    'borderSize':2\r\n    'borderThickness':2\r\n    'floors':'grass_floor'\r\n    'decorations': {\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n      'house': {\r\n        'num':[1,2] #min-max\r\n        'width': 15\r\n        'height': 15\r\n        'clusters': {\r\n          'houses':[1,1]\r\n          'trees':[1,2]\r\n          'shrubs':[0,3]\r\n          'rocks':[1,2]\r\n        }\r\n      }\r\n      'farm': {\r\n        'num':[1,1] #min-max\r\n        'width': 25\r\n        'height': 15\r\n        'clusters': {\r\n          'farm':[1,1]\r\n          'shrubs':[2,3]\r\n          'wood':[2,4]\r\n          'animals':[2,3]\r\n        }\r\n      }\r\n    }\r\n  }\r\n  'desert': {\r\n    'terrainName': 'Desert'\r\n    'type':'desert'\r\n    'borders':'desert_walls'\r\n    'borderNoise':2\r\n    'borderSize':4\r\n    'borderThickness':4\r\n    'floors':'desert_floor'\r\n    'decorations': {\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n      'oasis': {\r\n        'num':[1,2] #min-max\r\n        'width': 10\r\n        'height': 10\r\n        'clusters': {\r\n          'oases':[1,1]\r\n          'shrubs':[0,5]\r\n          'rocks':[0,2]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  'mountain': {\r\n    'terrainName': 'Mountain'\r\n    'type': 'mountain'\r\n    'floors': 'mountain_floor'\r\n    'borders': 'mountain_walls'\r\n    'borderNoise': 1\r\n    'borderSize': 1\r\n    'borderThickness': 1\r\n    'decorations': {\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  'glacier': {\r\n    'terrainName': 'Glacier'\r\n    'type': 'glacier'\r\n    'floors': 'glacier_floor'\r\n    'borders': 'glacier_walls'\r\n    'borderNoise': 0\r\n    'borderSize': 4\r\n    'borderThickness': 1\r\n    'decorations': {\r\n      'hero': {\r\n        'num': [1, 1]\r\n        'width': 2\r\n        'height': 2\r\n        'clusters': {\r\n          'hero': [1, 1]\r\n        }\r\n      }\r\n      'Room': {\r\n        'num': [1,1]\r\n        'width': [12, 20]\r\n        'height': [8, 16]\r\n        'thickness': [2,2]\r\n        'cluster': 'glacier_walls'\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\npresetSizes = {\r\n  'small': {\r\n    'x':80\r\n    'y':68\r\n    'sizeFactor':1\r\n  }\r\n  'large': {\r\n    'x':160\r\n    'y':136\r\n    'sizeFactor':2\r\n  }\r\n}\r\n\r\nthangSizes = {\r\n  'floorSize': {\r\n    'x':20\r\n    'y':17\r\n  }\r\n  'borderSize': {\r\n    'x':4\r\n    'y':4\r\n  }}\r\n\r\n\r\nmodule.exports = class GenerateTerrainModal extends ModalView\r\n  id: 'generate-terrain-modal'\r\n  template: template\r\n  plain: true\r\n  modalWidthPercent: 90\r\n\r\n  events:\r\n    'click .choose-option': 'onGenerate'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @presets = presets\r\n    @presetSizes = presetSizes\r\n\r\n  onRevertModel: (e) ->\r\n    id = $(e.target).val()\r\n    CocoModel.backedUp[id].revert()\r\n    $(e.target).closest('tr').remove()\r\n    @reloadOnClose = true\r\n\r\n  onGenerate: (e) ->\r\n    target = $(e.target)\r\n    presetType = target.attr 'data-preset-type'\r\n    presetSize = target.attr 'data-preset-size'\r\n    @generateThangs presetType, presetSize\r\n    Backbone.Mediator.publish 'editor:random-terrain-generated', thangs: @thangs, terrain: presets[presetType].terrainName\r\n    @hide()\r\n\r\n  generateThangs: (presetName, presetSize) ->\r\n    @falseCount = 0\r\n    preset = presets[presetName]\r\n    presetSize = presetSizes[presetSize]\r\n    @thangs = []\r\n    @rects = []\r\n    @generateFloor preset, presetSize\r\n    @generateBorder preset, presetSize, preset.borderNoise\r\n    @generateDecorations preset, presetSize\r\n\r\n  generateFloor: (preset, presetSize) ->\r\n    for i in _.range(0, presetSize.x, thangSizes.floorSize.x)\r\n      for j in _.range(0, presetSize.y, thangSizes.floorSize.y)\r\n        @thangs.push {\r\n          'id': @getRandomThang(clusters[preset.floors].thangs)\r\n          'pos': {\r\n            'x': i + thangSizes.floorSize.x/2\r\n            'y': j + thangSizes.floorSize.y/2\r\n          }\r\n          'margin': clusters[preset.floors].margin\r\n        }\r\n\r\n  generateBorder: (preset, presetSize, noiseFactor=1) ->\r\n    for i in _.range(0, presetSize.x, thangSizes.borderSize.x)\r\n      for j in _.range(preset.borderThickness)\r\n        # Bottom wall\r\n        while not @addThang {\r\n          'id': @getRandomThang(clusters[preset.borders].thangs)\r\n          'pos': {\r\n            'x': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x/2)\r\n            'y': 0 + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y)\r\n          }\r\n          'margin': clusters[preset.borders].margin\r\n        }\r\n          continue\r\n\r\n        # Top wall\r\n        while not @addThang {\r\n          'id': @getRandomThang(clusters[preset.borders].thangs)\r\n          'pos': {\r\n            'x': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x/2)\r\n            'y': presetSize.y - preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y, thangSizes.borderSize.y/2)\r\n          }\r\n          'margin': clusters[preset.borders].margin\r\n        }\r\n          continue\r\n\r\n        # Double wall on top\r\n        if preset.type is 'dungeon'\r\n          @addThang {\r\n            'id': @getRandomThang(clusters[preset.borders].thangs)\r\n            'pos': {\r\n              'x': i + preset.borderSize/2\r\n              'y': presetSize.y - 3 * preset.borderSize/2\r\n            }\r\n            'margin': clusters[preset.borders].margin\r\n          }\r\n          if ( i / preset.borderSize ) % 2 and i isnt presetSize.x - thangSizes.borderSize.x\r\n            @addThang {\r\n              'id': @getRandomThang(clusters['torch'].thangs)\r\n              'pos': {\r\n                'x': i + preset.borderSize\r\n                'y': presetSize.y - preset.borderSize / 2\r\n              }\r\n              'margin': clusters['torch'].margin\r\n            }\r\n          else if ( i / preset.borderSize ) % 2 is 0 and i and _.random(100) < 30\r\n            @addThang {\r\n              'id': @getRandomThang(clusters['chains'].thangs)\r\n              'pos': {\r\n                'x': i + preset.borderSize\r\n                'y': presetSize.y - preset.borderSize / 2\r\n              }\r\n              'margin': clusters['chains'].margin\r\n            }\r\n\r\n    for i in _.range(0, presetSize.y, thangSizes.borderSize.y)\r\n      for j in _.range(preset.borderThickness)\r\n        # Left wall\r\n        while not @addThang {\r\n          'id': @getRandomThang(clusters[preset.borders].thangs)\r\n          'pos': {\r\n            'x': 0 + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x/2, thangSizes.borderSize.x)\r\n            'y': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y/2)\r\n          }\r\n          'margin': clusters[preset.borders].margin\r\n        }\r\n          continue\r\n\r\n        # Right wall\r\n        while not @addThang {\r\n          'id': @getRandomThang(clusters[preset.borders].thangs)\r\n          'pos': {\r\n            'x': presetSize.x - preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.x, thangSizes.borderSize.x/2)\r\n            'y': i + preset.borderSize/2 + noiseFactor * _.random(-thangSizes.borderSize.y/2, thangSizes.borderSize.y/2)\r\n          }\r\n          'margin': clusters[preset.borders].margin\r\n        }\r\n          continue\r\n\r\n  generateDecorations: (preset, presetSize)->\r\n    for name, decoration of preset.decorations\r\n      for num in _.range(presetSize.sizeFactor * _.random(decoration.num[0], decoration.num[1]))\r\n        if @['build'+name] isnt undefined\r\n          @['build'+name](preset, presetSize, decoration)\r\n          continue\r\n        while true\r\n          rect = {\r\n            'x':_.random(decoration.width/2 + preset.borderSize/2 + thangSizes.borderSize.x, presetSize.x - decoration.width/2 - preset.borderSize/2 - thangSizes.borderSize.x),\r\n            'y':_.random(decoration.height/2 + preset.borderSize/2 + thangSizes.borderSize.y, presetSize.y - decoration.height/2 - preset.borderSize/2 - thangSizes.borderSize.y)\r\n            'width':decoration.width\r\n            'height':decoration.height\r\n          }\r\n          break if @addRect rect\r\n\r\n        for cluster, range of decoration.clusters\r\n          for i in _.range(_.random(range[0], range[1]))\r\n            while not @addThang {\r\n              'id':@getRandomThang(clusters[cluster].thangs)\r\n              'pos':{\r\n                'x':_.random(rect.x - rect.width/2, rect.x + rect.width/2)\r\n                'y':_.random(rect.y - rect.height/2, rect.y + rect.height/2)\r\n              }\r\n              'margin':clusters[cluster].margin\r\n            }\r\n              continue\r\n\r\n  buildRoom: (preset, presetSize, room) ->\r\n    grid = preset.borderSize\r\n    while true\r\n      rect = {\r\n        'width':presetSize.sizeFactor * (room.width[0] + grid * _.random(0, (room.width[1] - room.width[0])/grid))\r\n        'height':presetSize.sizeFactor * (room.height[0] + grid * _.random(0, (room.height[1] - room.height[0])/grid))\r\n      }\r\n      # This logic isn't quite right--it makes the rooms bigger than intended--but it's snapping correctly, which is fine for now.\r\n      rect.width = Math.round((rect.width - grid) / (2 * grid)) * 2 * grid + grid\r\n      rect.height = Math.round((rect.height - grid) / (2 * grid)) * 2 * grid + grid\r\n      roomThickness = _.random(room.thickness[0], room.thickness[1])\r\n      rect.x = _.random(rect.width/2 + grid * (roomThickness+1.5), presetSize.x - rect.width/2 - grid * (roomThickness+1.5))\r\n      rect.y = _.random(rect.height/2 + grid * (roomThickness+2.5), presetSize.y - rect.height/2 - grid * (roomThickness+3.5))\r\n      # Snap room walls to the wall grid.\r\n      rect.x = Math.round((rect.x - grid / 2) / grid) * grid\r\n      rect.y = Math.round((rect.y - grid / 2) / grid) * grid\r\n      break if @addRect {\r\n        'x': rect.x\r\n        'y': rect.y\r\n        'width': rect.width + 2.5 * roomThickness * grid\r\n        'height': rect.height + 2.5 * roomThickness * grid\r\n      }\r\n\r\n    xRange = _.range(rect.x - rect.width/2 + grid, rect.x + rect.width/2, grid)\r\n    topDoor = _.random(1) > 0.5\r\n    topDoorX = xRange[_.random(0, xRange.length-1)]\r\n    bottomDoor = if not topDoor then true else _.random(1) > 0.5\r\n    bottomDoorX = xRange[_.random(0, xRange.length-1)]\r\n\r\n    for t in _.range(0, roomThickness+1)\r\n      for i in _.range(rect.x - rect.width/2 - (t-1) * grid, rect.x + rect.width/2 + t * grid, grid)\r\n        # Bottom wall\r\n        thang = {\r\n          'id': @getRandomThang(clusters[room.cluster].thangs)\r\n          'pos': {\r\n            'x': i\r\n            'y': rect.y - rect.height/2 - t * grid\r\n          }\r\n          'margin': clusters[room.cluster].margin\r\n        }\r\n        if i is bottomDoorX and bottomDoor\r\n          thang.id = @getRandomThang(clusters['doors'].thangs)\r\n          thang.pos.y -= grid/3\r\n        @addThang thang unless i is bottomDoorX and t isnt roomThickness and bottomDoor\r\n\r\n        if t is roomThickness and i isnt rect.x - rect.width/2 - (t-1) * grid and preset.type is 'dungeon'\r\n          if ( i isnt bottomDoorX and i isnt bottomDoorX + grid ) or not bottomDoor\r\n            @addThang {\r\n              'id': @getRandomThang(clusters['torch'].thangs)\r\n              'pos': {\r\n                'x': thang.pos.x - grid / 2\r\n                'y': thang.pos.y + grid\r\n              }\r\n              'margin': clusters['torch'].margin\r\n            }\r\n\r\n        # Top wall\r\n        thang = {\r\n          'id': @getRandomThang(clusters[room.cluster].thangs)\r\n          'pos': {\r\n            'x': i\r\n            'y': rect.y + rect.height/2 + t * grid\r\n          }\r\n          'margin': clusters[room.cluster].margin\r\n        }\r\n        if i is topDoorX and topDoor\r\n          thang.id = @getRandomThang(clusters['doors'].thangs)\r\n          thang.pos.y -= grid\r\n        @addThang thang unless i is topDoorX and t isnt roomThickness and topDoor\r\n\r\n    for t in _.range(0, roomThickness)\r\n      for i in _.range(rect.y - rect.height/2 - t * grid, rect.y + rect.height/2 + (t+1) * grid, grid)\r\n        # Left wall\r\n        @addThang {\r\n          'id': @getRandomThang(clusters[room.cluster].thangs)\r\n          'pos': {\r\n            'x': rect.x - rect.width/2 - t * grid\r\n            'y': i\r\n          }\r\n          'margin': clusters[room.cluster].margin\r\n        }\r\n\r\n        # Right wall\r\n        @addThang {\r\n          'id': @getRandomThang(clusters[room.cluster].thangs)\r\n          'pos': {\r\n            'x': rect.x + rect.width/2 + t * grid\r\n            'y': i\r\n          }\r\n          'margin': clusters[room.cluster].margin\r\n        }\r\n\r\n  buildBarrels: (preset, presetSize, decoration) ->\r\n    rect = {\r\n      'width':presetSize.sizeFactor * ( _.random( decoration.width[0], decoration.width[1] ) )\r\n      'height':presetSize.sizeFactor * ( _.random( decoration.height[0], decoration.height[1] ) )\r\n    }\r\n    x = [ rect.width/2 + preset.borderSize , presetSize.x - rect.width/2 - preset.borderSize ]\r\n    y = [ rect.height/2 + preset.borderSize , presetSize.y - rect.height/2 - 2 * preset.borderSize ]\r\n\r\n    for i in x\r\n      for j in y\r\n        if _.random(100) < 40\r\n          rect = {\r\n            'x': i\r\n            'y': j\r\n            'width': rect.width\r\n            'height': rect.height\r\n          }\r\n          if @addRect rect\r\n            for num in _.range( _.random( decoration.numBarrels[0], decoration.numBarrels[1] ) )\r\n              while not @addThang {\r\n                'id': @getRandomThang(clusters[decoration.cluster].thangs)\r\n                'pos': {\r\n                  'x': _.random(rect.x - rect.width/2, rect.x + rect.width/2)\r\n                  'y': _.random(rect.y - rect.height/2, rect.y + rect.height/2)\r\n                }\r\n                'margin': clusters[decoration.cluster].margin\r\n              }\r\n                continue\r\n\r\n  addThang: (thang) ->\r\n    if @falseCount > 100\r\n      console.log 'infinite loop', thang\r\n      @falseCount = 0\r\n      return true\r\n    for existingThang in @thangs\r\n      if existingThang.margin is -1 or thang.margin is -1\r\n        continue\r\n      if Math.abs(existingThang.pos.x - thang.pos.x) < thang.margin + existingThang.margin and Math.abs(existingThang.pos.y - thang.pos.y) < thang.margin + existingThang.margin\r\n        @falseCount++\r\n        return false\r\n    @thangs.push thang\r\n    true\r\n\r\n  addRect: (rect) ->\r\n    if @falseCount > 100\r\n      console.log 'infinite loop', rect\r\n      @falseCount = 0\r\n      return true\r\n    for existingRect in @rects\r\n      if Math.abs(existingRect.x - rect.x) <= rect.width/2 + existingRect.width/2 and Math.abs(existingRect.y - rect.y) <= rect.height/2 + existingRect.height/2\r\n        @falseCount++\r\n        return false\r\n    @rects.push rect\r\n    true\r\n\r\n  getRandomThang: (thangList) ->\r\n    return thangList[_.random(0, thangList.length-1)]\r\n\r\n  onHidden: ->\r\n    location.reload() if @reloadOnClose\r\n","VersionsModal = require 'views/editor/modal/VersionsModal'\r\n\r\nmodule.exports = class LevelVersionsModal extends VersionsModal\r\n  id: 'editor-level-versions-view'\r\n  url: '/db/level/'\r\n  page: 'level'\r\n\r\n  constructor: (options, @ID) ->\r\n    super options, @ID, require 'models/Level'\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/load-branch-modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\ndeltasLib = require 'core/deltas'\r\nBranch = require 'models/Branch'\r\nBranches = require 'collections/Branches'\r\nLevelComponents = require 'collections/LevelComponents'\r\nLevelSystems = require 'collections/LevelSystems'\r\n\r\n\r\nmodule.exports = class LoadBranchModal extends ModalView\r\n  id: 'load-branch-modal'\r\n  template: template\r\n  modalWidthPercent: 99\r\n  events:\r\n    'click #load-branch-btn': 'onClickLoadBranchButton'\r\n    'click #unstash-branch-btn': 'onClickUnstashBranchButton'\r\n    'click #branches-list-group .list-group-item': 'onClickBranch'\r\n    'click .delete-branch-btn': 'onClickDeleteBranchButton'\r\n    \r\n\r\n  initialize: ({ @components, @systems }) ->\r\n    # Should be given all loaded, up to date systems and components with existing changes\r\n    \r\n    # Load existing branches\r\n    @branches = new Branches()\r\n    @branches.fetch({url: '/db/branches'})\r\n    .then(=>\r\n      @selectedBranch = @branches.first()\r\n      \r\n      # Load any patch target we don't already have\r\n      fetches = []\r\n      for branch in @branches.models\r\n        for patch in branch.get('patches')\r\n          collection = if patch.target.collection is 'level_component' then @components else @systems\r\n          model = collection.get(patch.target.id)\r\n          if not model\r\n            model = new collection.model({ _id: patch.target.id })\r\n            fetches.push(model.fetch())\r\n            model.once 'sync', -> @markToRevert()\r\n            collection.add(model)\r\n      return $.when(fetches...)\r\n      \r\n    ).then(=>\r\n\r\n      # Go through each branch and figure out what their patch statuses are\r\n      for branch in @branches.models\r\n        for patch in branch.get('patches')\r\n          patch.id = _.uniqueId()\r\n          collection = if patch.target.collection is 'level_component' then @components else @systems\r\n\r\n          # make a model that represents what the patch represented when it was made\r\n          originalChange = collection.get(patch.target.id).clone(false)\r\n          originalChange.markToRevert()\r\n          originalChange.applyDelta(patch.delta)\r\n          \r\n          # make a model that represents what will change locally\r\n          currentModel = collection.find (model) -> _.all([\r\n            model.get('original') is patch.target.original,\r\n            model.get('version').isLatestMajor\r\n          ])\r\n          postLoadChange = currentModel.clone()\r\n          postLoadChange.markToRevert() # includes whatever local changes we have now\r\n          \r\n          toApply = currentModel.clone(false)\r\n          applied = toApply.applyDelta(patch.delta)\r\n          if applied\r\n            postLoadChange.set(toApply.attributes)\r\n            for key in postLoadChange.keys()\r\n              if not toApply.has(key)\r\n                postLoadChange.unset(key)\r\n            # now postLoadChange has current state -> future state\r\n          \r\n          # properties used in rendering and loading\r\n          _.assign(patch, {\r\n            # the original target with patch applied\r\n            originalChange\r\n            \r\n            # the current target with local changes removed and patch applied (if successful)\r\n            # Whether the patch was applied or not, this is how the model will be after loading\r\n            postLoadChange\r\n            \r\n            # whether applying the patch to the current target was successful\r\n            applied\r\n            \r\n            # so we can label this part of the patch as overwriting local changes\r\n            currentModelHasLocalChanges: currentModel.hasLocalChanges()\r\n            \r\n            # so we can label changes being applied to a newer version of the model\r\n            modelHasChangedSincePatchCreated: originalChange.id isnt currentModel.id\r\n            \r\n            # the target model as it was passed into the modal, unchanged\r\n            currentModel\r\n          })\r\n    ).then(=> @render())\r\n    \r\n  afterRender: ->\r\n    super()\r\n    @renderSelectedBranch()\r\n\r\n  insertDeltaView: (model, changeEl, headModel) ->\r\n    try\r\n      deltaView = new DeltaView({model: model, headModel, skipPaths: deltasLib.DOC_SKIP_PATHS})\r\n      @insertSubView(deltaView, $(changeEl))\r\n      return deltaView\r\n    catch e\r\n      console.error 'Couldn\\'t create delta view:', e\r\n        \r\n  renderSelectedBranch: ->\r\n    # insert delta subviews for the selected branch, including the 'headComponent' which shows\r\n    # what, if any, conflicts the existing branch has with the client's local changes\r\n    \r\n    @removeSubView(view) for view in @selectedBranchDeltaViews if @selectedBranchDeltaViews\r\n    @selectedBranchDeltaViews = []\r\n    @renderSelectors('#selected-branch-col')\r\n    return unless @selectedBranch\r\n    for patch in @selectedBranch.get('patches')\r\n      originalChangeEl = @$(\".changes-stub[data-patch-id='#{patch.id}'][data-prop='original-change']\")\r\n      @insertDeltaView(patch.originalChange, originalChangeEl)\r\n      postLoadChangeEl = @$(\".changes-stub[data-patch-id='#{patch.id}'][data-prop='post-load-change']\")\r\n      @insertDeltaView(patch.postLoadChange, postLoadChangeEl)\r\n    \r\n  onClickBranch: (e) ->\r\n    $(e.currentTarget).closest('.list-group').find('.active').removeClass('active')\r\n    $(e.currentTarget).addClass('active')\r\n    branchCid = $(e.currentTarget).data('branch-cid')\r\n    @selectedBranch = @branches.get(branchCid)\r\n    @renderSelectedBranch()\r\n\r\n  onClickUnstashBranchButton: (e) ->\r\n    @loadBranch({deleteBranch: true})\r\n\r\n  onClickLoadBranchButton: (e) ->\r\n    @loadBranch({deleteBranch: false})\r\n\r\n  loadBranch: ({deleteBranch}) ->\r\n    selectedBranch = @$('#branches-list-group .active')\r\n    branchCid = selectedBranch.data('branch-cid')\r\n    branch = @branches.get(branchCid)\r\n    for patch in branch.get('patches')\r\n      continue if not patch.applied\r\n      { currentModel, postLoadChange } = patch\r\n      \r\n      currentModel.set(postLoadChange.attributes)\r\n      for key in currentModel.keys()\r\n        if not postLoadChange.has(key)\r\n          currentModel.unset(key)\r\n    if deleteBranch\r\n      Promise.resolve(branch.destroy()).catch((e) => noty text: 'Failed to delete branch after unstashing', layout: 'topCenter', type: 'error', killer: false)\r\n    @hide()\r\n\r\n  onClickDeleteBranchButton: (e) ->\r\n    e.preventDefault()\r\n    e.stopImmediatePropagation()\r\n    branchCid = $(e.currentTarget).closest('.list-group-item').data('branch-cid')\r\n    branch = @branches.get(branchCid)\r\n    return unless confirm('Really delete this branch?')\r\n    branch.destroy()\r\n    @branches.remove(branch)\r\n    if branch is @selectedBranch\r\n      @selectedBranch = null\r\n      @renderSelectedBranch()\r\n    $(e.currentTarget).closest('.list-group-item').remove()\r\n","NewModelModal = require 'views/editor/modal/NewModelModal'\r\ntemplate = require 'templates/editor/level/modal/new-achievement'\r\nforms = require 'core/forms'\r\nAchievement = require 'models/Achievement'\r\n\r\nmodule.exports = class NewAchievementModal extends NewModelModal\r\n  id: 'new-achievement-modal'\r\n  template: template\r\n  plain: false\r\n\r\n  events:\r\n    'click #save-new-achievement-link': 'onAchievementSubmitted'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @level = options.level\r\n\r\n  onAchievementSubmitted: (e) ->\r\n    slug = _.string.slugify @$el.find('#name').val()\r\n    url = \"/editor/achievement/#{slug}\"\r\n    window.open url, '_blank'\r\n\r\n  createQuery: ->\r\n    checked = @$el.find('[name=queryOptions]:checked')\r\n    checkedValues = ($(check).val() for check in checked)\r\n    query = {}\r\n    for id in checkedValues\r\n      switch id\r\n        when 'misc-level-completion'\r\n          query['state.complete'] = true\r\n        else\r\n          query[\"state.goalStates.#{id}.status\"] = 'success'\r\n    query['level.original'] = @level.get 'original'\r\n    query\r\n\r\n  makeNewModel: ->\r\n    achievement = new Achievement\r\n    name = @$el.find('#name').val()\r\n    description = @$el.find('#description').val()\r\n    query = @createQuery()\r\n\r\n    achievement.set 'name', name\r\n    achievement.set 'description', description\r\n    achievement.set 'query', query\r\n    achievement.set 'collection', 'level.sessions'\r\n    achievement.set 'userField', 'creator'\r\n    achievement.set 'related', @level.get('original')\r\n\r\n    achievement\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/save-branch-modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\ndeltasLib = require 'core/deltas'\r\nBranch = require 'models/Branch'\r\nBranches = require 'collections/Branches'\r\nLevelComponents = require 'collections/LevelComponents'\r\nLevelSystems = require 'collections/LevelSystems'\r\n\r\n\r\nmodule.exports = class SaveBranchModal extends ModalView\r\n  id: 'save-branch-modal'\r\n  template: template\r\n  modalWidthPercent: 99\r\n  events:\r\n    'click #save-branch-btn': 'onClickSaveBranchButton'\r\n    'click #branches-list-group .list-group-item': 'onClickBranch'\r\n    'click .delete-branch-btn': 'onClickDeleteBranchButton'\r\n    'click #stash-branch-btn': 'onClickStashBranchButton'\r\n\r\n  initialize: ({ @components, @systems }) ->\r\n    # Should be given all loaded, up to date systems and components with existing changes\r\n    \r\n    # Create a list of components and systems we'll be saving a branch for\r\n    @componentsWithChanges = new LevelComponents(@components.filter((c) -> c.hasLocalChanges()))\r\n    @systemsWithChanges = new LevelSystems(@systems.filter((c) -> c.hasLocalChanges()))\r\n    \r\n    # Load existing branches\r\n    @branches = new Branches()\r\n    @branches.fetch({url: '/db/branches'})\r\n    .then(=>\r\n      \r\n      # Load any patch target we don't already have\r\n      fetches = []\r\n      for branch in @branches.models\r\n        for patch in branch.get('patches') or []\r\n          collection = if patch.target.collection is 'level_component' then @components else @systems\r\n          model = collection.get(patch.target.id)\r\n          if not model\r\n            model = new collection.model({ _id: patch.target.id })\r\n            fetches.push(model.fetch())\r\n            model.once 'sync', -> @markToRevert()\r\n            collection.add(model)\r\n      return $.when(fetches...)\r\n      \r\n    ).then(=>\r\n      \r\n      # Go through each branch and make clones of patch targets, with patches applied, so we can show the deltas\r\n      for branch in @branches.models\r\n        branch.components = new Backbone.Collection()\r\n        branch.systems = new Backbone.Collection()\r\n        for patch in branch.get('patches') or []\r\n          patch.id = _.uniqueId()\r\n          if patch.target.collection is 'level_component'\r\n            allModels = @components\r\n            changedModels = branch.components\r\n          else\r\n            allModels = @systems\r\n            changedModels = branch.systems\r\n          model = allModels.get(patch.target.id).clone(false)\r\n          model.markToRevert()\r\n          model.applyDelta(patch.delta)\r\n          changedModels.add(model)\r\n      @selectedBranch = @branches.first()\r\n      @render()\r\n    )\r\n\r\n  afterRender: ->\r\n    super()\r\n    @renderSelectedBranch()\r\n    \r\n    # insert all the Delta views for the systems/components which will form the branch\r\n    changeEls = @$el.find('.component-changes-stub')\r\n    for changeEl in changeEls\r\n      componentId = $(changeEl).data('component-id')\r\n      component = @componentsWithChanges.find((c) -> c.id is componentId)\r\n      @insertDeltaView(component, changeEl)\r\n\r\n    changeEls = @$el.find('.system-changes-stub')\r\n    for changeEl in changeEls\r\n      systemId = $(changeEl).data('system-id')\r\n      system = @systemsWithChanges.find((c) -> c.id is systemId)\r\n      @insertDeltaView(system, changeEl)\r\n      \r\n  insertDeltaView: (model, changeEl, headModel) ->\r\n    try\r\n      deltaView = new DeltaView({model: model, headModel, skipPaths: deltasLib.DOC_SKIP_PATHS})\r\n      @insertSubView(deltaView, $(changeEl))\r\n      return deltaView\r\n    catch e\r\n      console.error 'Couldn\\'t create delta view:', e\r\n        \r\n  renderSelectedBranch: ->\r\n    # insert delta subviews for the selected branch, including the 'headComponent' which shows\r\n    # what, if any, conflicts the existing branch has with the client's local changes\r\n    \r\n    @removeSubView(view) for view in @selectedBranchDeltaViews if @selectedBranchDeltaViews\r\n    @selectedBranchDeltaViews = []\r\n    @renderSelectors('#selected-branch-col')\r\n    changeEls = @$el.find('#selected-branch-col .component-changes-stub')\r\n    for changeEl in changeEls\r\n      componentId = $(changeEl).data('component-id')\r\n      component = @selectedBranch.components.get(componentId)\r\n      targetComponent = @components.find((c) -> c.get('original') is component.get('original') and c.get('version').isLatestMajor)\r\n      preBranchSave = component.clone()\r\n      preBranchSave.markToRevert()\r\n      componentDiff = targetComponent.clone()\r\n      preBranchSave.set(componentDiff.attributes)\r\n      @selectedBranchDeltaViews.push(@insertDeltaView(preBranchSave, changeEl))\r\n\r\n    changeEls = @$el.find('#selected-branch-col .system-changes-stub')\r\n    for changeEl in changeEls\r\n      systemId = $(changeEl).data('system-id')\r\n      system = @selectedBranch.systems.get(systemId)\r\n      targetSystem = @systems.find((c) -> c.get('original') is system.get('original') and c.get('version').isLatestMajor)\r\n      preBranchSave = system.clone()\r\n      preBranchSave.markToRevert()\r\n      systemDiff = targetSystem.clone()\r\n      preBranchSave.set(systemDiff.attributes)\r\n      @selectedBranchDeltaViews.push(@insertDeltaView(preBranchSave, changeEl))\r\n\r\n  onClickBranch: (e) ->\r\n    $(e.currentTarget).closest('.list-group').find('.active').removeClass('active')\r\n    $(e.currentTarget).addClass('active')\r\n    branchCid = $(e.currentTarget).data('branch-cid')\r\n    @selectedBranch = if branchCid then @branches.get(branchCid) else null\r\n    @renderSelectedBranch()\r\n\r\n  onClickStashBranchButton: (e) ->\r\n    @saveBranch(e, {deleteSavedChanges: true})\r\n\r\n  onClickSaveBranchButton: (e) ->\r\n    @saveBranch(e, {deleteSavedChanges: false})\r\n\r\n  saveBranch: (e, {deleteSavedChanges}) ->\r\n    if @selectedBranch\r\n      branch = @selectedBranch\r\n    else\r\n      name = @$('#new-branch-name-input').val()\r\n      if not name\r\n        return noty text: 'Name required', layout: 'topCenter', type: 'error', killer: false\r\n      slug = _.string.slugify(name)\r\n      if @branches.findWhere({slug})\r\n        return noty text: 'Name taken', layout: 'topCenter', type: 'error', killer: false\r\n      branch = new Branch({name})\r\n    \r\n    patches = []\r\n    toRevert = []\r\n    selectedComponents = _.map(@$('.component-checkbox:checked'), (checkbox) => @componentsWithChanges.get($(checkbox).data('component-id')))\r\n    for component in selectedComponents\r\n      patches.push(component.makePatch().toJSON())\r\n      toRevert.push(component)\r\n    \r\n    selectedSystems = _.map(@$('.system-checkbox:checked'), (checkbox) => @systemsWithChanges.get($(checkbox).data('system-id')))\r\n    for system in selectedSystems\r\n      patches.push(system.makePatch().toJSON())\r\n      toRevert.push(system)\r\n    branch.set({patches})\r\n    jqxhr = branch.save()\r\n    button = $(e.currentTarget)\r\n    if not jqxhr\r\n      return button.text('Save Failed (validation error)')\r\n      \r\n    button.attr('disabled', true).text('Saving...')\r\n    Promise.resolve(jqxhr)\r\n    .then =>\r\n      if deleteSavedChanges\r\n        model.revert() for model in toRevert\r\n      @hide()\r\n    .catch (e) =>\r\n      button.attr('disabled', false).text('Save Failed (network/runtime error)')\r\n      throw e\r\n\r\n  onClickDeleteBranchButton: (e) ->\r\n    e.preventDefault()\r\n    e.stopImmediatePropagation()\r\n    branchCid = $(e.currentTarget).closest('.list-group-item').data('branch-cid')\r\n    branch = @branches.get(branchCid)\r\n    return unless confirm('Really delete this branch?')\r\n    branch.destroy()\r\n    @branches.remove(branch)\r\n    if branch is @selectedBranch\r\n      @selectedBranch = null\r\n      @renderSelectedBranch()\r\n    $(e.currentTarget).closest('.list-group-item').remove()\r\n","SaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\ntemplate = require 'templates/editor/level/save-level-modal'\r\nforms = require 'core/forms'\r\nLevelComponent = require 'models/LevelComponent'\r\nLevelSystem = require 'models/LevelSystem'\r\nDeltaView = require 'views/editor/DeltaView'\r\nPatchModal = require 'views/editor/PatchModal'\r\ndeltasLib = require 'core/deltas'\r\nVerifierTest = require 'views/editor/verifier/VerifierTest'\r\nSuperModel = require 'models/SuperModel'\r\n\r\nmodule.exports = class SaveLevelModal extends SaveVersionModal\r\n  template: template\r\n  instant: false\r\n  modalWidthPercent: 60\r\n  plain: true\r\n\r\n  events:\r\n    'click #save-version-button': 'commitLevel'\r\n    'submit form': 'commitLevel'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @level = options.level\r\n    @buildTime = options.buildTime\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.level = @level\r\n    context.levelNeedsSave = @level.hasLocalChanges()\r\n    context.modifiedComponents = _.filter @supermodel.getModels(LevelComponent), @shouldSaveEntity\r\n    context.modifiedSystems = _.filter @supermodel.getModels(LevelSystem), @shouldSaveEntity\r\n    @hasChanges = (context.levelNeedsSave or context.modifiedComponents.length or context.modifiedSystems.length)\r\n    @lastContext = context\r\n    context\r\n\r\n  afterRender: ->\r\n    super(false)\r\n    changeEls = @$el.find('.changes-stub')\r\n    models = if @lastContext.levelNeedsSave then [@level] else []\r\n    models = models.concat @lastContext.modifiedComponents\r\n    models = models.concat @lastContext.modifiedSystems\r\n    models = (m for m in models when m.hasWriteAccess())\r\n    for changeEl, i in changeEls\r\n      model = models[i]\r\n      try\r\n        deltaView = new DeltaView({model: model, skipPaths: deltasLib.DOC_SKIP_PATHS})\r\n        @insertSubView(deltaView, $(changeEl))\r\n      catch e\r\n        console.error 'Couldn\\'t create delta view:', e\r\n    @verify() if me.isAdmin()\r\n\r\n  shouldSaveEntity: (m) ->\r\n    return false unless m.hasWriteAccess()\r\n    if m.get('system') is 'ai' and m.get('name') is 'Jitters' and m.type() is 'LevelComponent'\r\n      # Trying to debug the occasional phantom all-Components-must-be-saved bug\r\n      console.log \"Should we save\", m.get('system'), m.get('name'), m, \"? localChanges:\", m.hasLocalChanges(), \"version:\", m.get('version'), 'isPublished:', m.isPublished(), 'collection:', m.collection\r\n      return false\r\n    return true if m.hasLocalChanges()\r\n    console.error \"Trying to check major version of #{m.type()} #{m.get('name')}, but it doesn't have a version:\", m unless m.get('version')\r\n    return true if (m.get('version').major is 0 and m.get('version').minor is 0) or not m.isPublished() and not m.collection\r\n    # Sometimes we have two versions: one in a search collection and one with a URL. We only save changes to the latter.\r\n    false\r\n\r\n  commitLevel: (e) ->\r\n    e.preventDefault()\r\n    @level.set 'buildTime', @buildTime\r\n    modelsToSave = []\r\n    formsToSave = []\r\n    for form in @$el.find('form')\r\n      # Level form is first, then LevelComponents' forms, then LevelSystems' forms\r\n      fields = {}\r\n      for field in $(form).serializeArray()\r\n        fields[field.name] = if field.value is 'on' then true else field.value\r\n      isLevelForm = $(form).attr('id') is 'save-level-form'\r\n      if isLevelForm\r\n        model = @level\r\n      else\r\n        [kind, klass] = if $(form).hasClass 'component-form' then ['component', LevelComponent] else ['system', LevelSystem]\r\n        model = @supermodel.getModelByOriginalAndMajorVersion klass, fields[\"#{kind}-original\"], parseInt(fields[\"#{kind}-parent-major-version\"], 10)\r\n        console.log 'Couldn\\'t find model for', kind, fields, 'from', @supermodel.models unless model\r\n      newModel = if fields.major then model.cloneNewMajorVersion() else model.cloneNewMinorVersion()\r\n      newModel.set 'commitMessage', fields['commit-message']\r\n      modelsToSave.push newModel\r\n      if isLevelForm\r\n        @level = newModel\r\n        if fields['publish'] and not @level.isPublished()\r\n          @level.publish()\r\n      else if @level.isPublished() and not newModel.isPublished()\r\n        newModel.publish()  # Publish any LevelComponents that weren't published yet\r\n      formsToSave.push form\r\n\r\n    for model in modelsToSave\r\n      if errors = model.getValidationErrors()\r\n        messages = (\"\\t #{error.dataPath}: #{error.message}\" for error in errors)\r\n        messages = messages.join('<br />')\r\n        @$el.find('#errors-wrapper .errors').html(messages)\r\n        @$el.find('#errors-wrapper').removeClass('hide')\r\n        return\r\n\r\n    @showLoading()\r\n    tuples = _.zip(modelsToSave, formsToSave)\r\n    for [newModel, form] in tuples\r\n      newModel.updateI18NCoverage() if newModel.get('i18nCoverage')\r\n      res = newModel.save(null, {type: 'POST'})  # Override PUT so we can trigger postNewVersion logic\r\n      do (newModel, form) =>\r\n        res.error =>\r\n          @hideLoading()\r\n          console.log 'Got errors:', JSON.parse(res.responseText)\r\n          forms.applyErrorsToForm($(form), JSON.parse(res.responseText))\r\n        res.success =>\r\n          modelsToSave = _.without modelsToSave, newModel\r\n          oldModel = _.find @supermodel.models, (m) -> m.get('original') is newModel.get('original')\r\n          oldModel.clearBackup()  # Otherwise looking at old versions is confusing.\r\n          unless modelsToSave.length\r\n            url = \"/editor/level/#{@level.get('slug') or @level.id}\"\r\n            document.location.href = url\r\n            @hide()  # This will destroy everything, so do it last\r\n\r\n  verify: ->\r\n    return @$('#verifier-stub').hide() unless (solutions = @level.getSolutions()) and solutions.length\r\n    @running = @problems = @failed = @passedExceptFrames = @passed = 0\r\n    @waiting = solutions.length\r\n    @renderSelectors '#verifier-tests'\r\n    for solution in solutions\r\n      childSupermodel = new SuperModel()\r\n      childSupermodel.models = _.clone @supermodel.models\r\n      childSupermodel.collections = _.clone @supermodel.collections\r\n      test = new VerifierTest @level.get('slug'), @onVerifierTestUpate, childSupermodel, solution.language, {devMode: true}\r\n\r\n  onVerifierTestUpate: (e) =>\r\n    return if @destroyed\r\n    if e.state is 'running'\r\n      --@waiting\r\n      ++@running\r\n    else if e.state in ['complete', 'error', 'no-solution']\r\n      --@running\r\n      if e.state is 'complete'\r\n        if e.test.isSuccessful true\r\n          ++@passed\r\n        else if e.test.isSuccessful false\r\n          ++@passedExceptFrames\r\n        else\r\n          ++@failed\r\n      else if e.state is 'no-solution'\r\n        console.warn 'Solution problem for', e.test.language\r\n        ++@problems\r\n      else\r\n        ++@problems\r\n    @renderSelectors '#verifier-tests'\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/world-select-modal'\r\nSurface = require 'lib/surface/Surface'\r\nThangType = require 'models/ThangType'\r\n\r\nmodule.exports = class WorldSelectModal extends ModalView\r\n  id: 'world-select-modal'\r\n  template: template\r\n  modalWidthPercent: 80\r\n  cache: false\r\n\r\n  subscriptions:\r\n    'surface:choose-region': 'selectionMade'\r\n    'surface:choose-point': 'selectionMade'\r\n\r\n  events:\r\n    'click #done-button': 'done'\r\n\r\n  shortcuts:\r\n    'enter': 'done'\r\n\r\n  constructor: (options) ->\r\n    @world = options.world\r\n    @dataType = options.dataType or 'point'\r\n    @default = options.default\r\n    @defaultFromZoom = options.defaultFromZoom\r\n    @selectionMade = _.debounce(@selectionMade, 300)\r\n    @supermodel = options.supermodel\r\n    super()\r\n\r\n  getRenderData: (c={}) =>\r\n    c = super(c)\r\n    c.selectingPoint = @dataType is 'point'\r\n    c.flexibleRegion = @dataType is 'region'\r\n    c\r\n\r\n  afterInsert: ->\r\n    super()\r\n    @initSurface()\r\n\r\n  # surface setup\r\n\r\n  initSurface: ->\r\n    webGLCanvas = @$el.find('.webgl-canvas')\r\n    normalCanvas = @$el.find('.normal-canvas')\r\n    canvases = webGLCanvas.add(normalCanvas)\r\n    canvases.attr('width', currentView.$el.width()*.8-70)\r\n    canvases.attr('height', currentView.$el.height()*.6)\r\n    @surface = new Surface @world, normalCanvas, webGLCanvas, {\r\n      paths: false\r\n      grid: true\r\n      navigateToSelection: false\r\n      choosing: @dataType\r\n      coords: true\r\n      thangTypes: @supermodel.getModels(ThangType)\r\n      showInvisible: true\r\n    }\r\n    @surface.playing = false\r\n    @surface.setWorld @world\r\n    @surface.camera.zoomTo({x: 262, y: -164}, 1.66, 0)\r\n    @showDefaults()\r\n\r\n  showDefaults: ->\r\n    # show current point, and zoom to it\r\n    if @dataType is 'point'\r\n      if @default? and _.isFinite(@default.x) and _.isFinite(@default.y)\r\n        @surface.chooser.setPoint(@default)\r\n        @surface.camera.zoomTo(@surface.camera.worldToSurface(@default), 2)\r\n\r\n    else if @defaultFromZoom?\r\n      @showZoomRegion()\r\n      surfaceTarget = @surface.camera.worldToSurface(@defaultFromZoom.target)\r\n      @surface.camera.zoomTo(surfaceTarget, @defaultFromZoom.zoom*0.6)\r\n\r\n    else if @default? and _.isFinite(@default[0].x) and _.isFinite(@default[0].y) and _.isFinite(@default[1].x) and _.isFinite(@default[1].y)\r\n      @surface.chooser.setRegion(@default)\r\n      @showBoundaryRegion()\r\n\r\n  showZoomRegion: ->\r\n    d = @defaultFromZoom\r\n    canvasWidth = 924  # Dimensions for canvas player. Need these somewhere.\r\n    canvasHeight = 589\r\n    dimensions = {x: canvasWidth/d.zoom, y: canvasHeight/d.zoom}\r\n    dimensions = @surface.camera.surfaceToWorld(dimensions)\r\n    width = dimensions.x\r\n    height = dimensions.y\r\n    target = d.target\r\n    region = [\r\n      {x: target.x - width/2, y: target.y - height/2}\r\n      {x: target.x + width/2, y: target.y + height/2}\r\n    ]\r\n    @surface.chooser.setRegion(region)\r\n\r\n  showBoundaryRegion: ->\r\n    bounds = @surface.camera.normalizeBounds(@default)\r\n    point = {\r\n      x: bounds.x + bounds.width / 2\r\n      y: bounds.y + bounds.height / 2\r\n    }\r\n    zoom = 0.8 * (@surface.camera.canvasWidth / bounds.width)\r\n    @surface.camera.zoomTo(point, zoom)\r\n\r\n  # event handlers\r\n\r\n  selectionMade: (e) =>\r\n    e.camera = @surface.camera\r\n    @lastSelection = e\r\n\r\n  done: =>\r\n    @callback?(@lastSelection)\r\n    @hide()\r\n\r\n  onHidden: ->\r\n    @surface?.destroy()\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/scripts_tab'\r\nLevel = require 'models/Level'\r\nSurface = require 'lib/surface/Surface'\r\nnodes = require './../treema_nodes'\r\ndefaultScripts = require 'lib/DefaultScripts'\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class ScriptsTabView extends CocoView\r\n  id: 'editor-level-scripts-tab-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  subscriptions:\r\n    'editor:level-loaded': 'onLevelLoaded'\r\n    'editor:thangs-edited': 'onThangsEdited'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @world = options.world\r\n    @files = options.files\r\n    $(window).on 'resize', @onWindowResize\r\n\r\n  destroy: ->\r\n    @scriptTreema?.destroy()\r\n    @scriptTreemas?.destroy()\r\n    $(window).off 'resize', @onWindowResize\r\n    super()\r\n\r\n  onLoaded: ->\r\n  onLevelLoaded: (e) ->\r\n    @level = e.level\r\n    @dimensions = @level.dimensions()\r\n    scripts = $.extend(true, [], @level.get('scripts') ? [])\r\n    if scripts.length is 0\r\n      scripts = $.extend(true, [], defaultScripts)\r\n    treemaOptions =\r\n      schema: Level.schema.properties.scripts\r\n      data: scripts\r\n      callbacks:\r\n        change: @onScriptsChanged\r\n        select: @onScriptSelected\r\n        addChild: @onNewScriptAdded\r\n        removeChild: @onScriptDeleted\r\n      nodeClasses:\r\n        array: ScriptsNode\r\n        object: ScriptNode\r\n      view: @\r\n    @scriptsTreema = @$el.find('#scripts-treema').treema treemaOptions\r\n    @scriptsTreema.build()\r\n    if @scriptsTreema.childrenTreemas[0]?\r\n      @scriptsTreema.childrenTreemas[0].select()\r\n      @scriptsTreema.childrenTreemas[0].broadcastChanges() # can get rid of this after refactoring treema\r\n\r\n  onScriptsChanged: (e) =>\r\n    @level.set 'scripts', @scriptsTreema.data\r\n\r\n  onScriptSelected: (e, selected) =>\r\n    selected = if selected.length > 1 then selected[0].getLastSelectedTreema() else selected[0]\r\n    unless selected\r\n      @$el.find('#script-treema').replaceWith($('<div id=\"script-treema\"></div>'))\r\n      @selectedScriptPath = null\r\n      return\r\n\r\n    @thangIDs = @getThangIDs()\r\n    treemaOptions =\r\n      world: @world\r\n      filePath: \"db/level/#{@level.get('original')}\"\r\n      files: @files\r\n      view: @\r\n      schema: Level.schema.properties.scripts.items\r\n      data: selected.data\r\n      thangIDs: @thangIDs\r\n      dimensions: @dimensions\r\n      supermodel: @supermodel\r\n      readOnly: me.get('anonymous')\r\n      callbacks:\r\n        change: @onScriptChanged\r\n      nodeClasses:\r\n        object: PropertiesNode\r\n        'event-value-chain': EventPropsNode\r\n        'event-prereqs': EventPrereqsNode\r\n        'event-prereq': EventPrereqNode\r\n        'event-channel': ChannelNode\r\n        'thang': nodes.ThangNode\r\n        'milliseconds': nodes.MillisecondsNode\r\n        'seconds': nodes.SecondsNode\r\n        'point2d': nodes.WorldPointNode\r\n        'viewport': nodes.WorldViewportNode\r\n        'bounds': nodes.WorldBoundsNode\r\n\r\n    newPath = selected.getPath()\r\n    return if newPath is @selectedScriptPath\r\n    #@scriptTreema?.destroy() # TODO: get this to work\r\n    @scriptTreema = @$el.find('#script-treema').treema treemaOptions\r\n    @scriptTreema.build()\r\n    @scriptTreema.childrenTreemas?.noteChain?.open(5)\r\n    @selectedScriptPath = newPath\r\n\r\n  getThangIDs: ->\r\n    (t.id for t in @level.get('thangs') ? [])\r\n\r\n  onNewScriptAdded: (scriptNode) =>\r\n    return unless scriptNode\r\n    if scriptNode.data.id is undefined\r\n      scriptNode.disableTracking()\r\n      scriptNode.set '/id', 'Script-' + @scriptsTreema.data.length\r\n      scriptNode.enableTracking()\r\n\r\n  onScriptDeleted: =>\r\n    for key, treema of @scriptsTreema.childrenTreemas\r\n      key = parseInt(key)\r\n      treema.disableTracking()\r\n      if /Script-[0-9]*/.test treema.data.id\r\n        existingKey = parseInt(treema.data.id.substr(7))\r\n        if existingKey isnt key+1\r\n          treema.set 'id', 'Script-' + (key+1)\r\n      treema.enableTracking()\r\n\r\n  onScriptChanged: =>\r\n    return unless @selectedScriptPath\r\n    @scriptsTreema.set(@selectedScriptPath, @scriptTreema.data)\r\n\r\n  onThangsEdited: (e) ->\r\n    # Update in-place so existing Treema nodes refer to the same array.\r\n    @thangIDs?.splice(0, @thangIDs.length, @getThangIDs()...)\r\n\r\n  onWindowResize: (e) =>\r\n    @$el.find('#scripts-treema').collapse('show') if $('body').width() > 800\r\n\r\nclass ScriptsNode extends TreemaArrayNode\r\n  nodeDescription: 'Script'\r\n  addNewChild: ->\r\n    newTreema = super()\r\n    if @callbacks.addChild\r\n      @callbacks.addChild newTreema\r\n    newTreema\r\n\r\nclass ScriptNode extends TreemaObjectNode\r\n  valueClass: 'treema-script'\r\n  collection: false\r\n  buildValueForDisplay: (valEl, data) ->\r\n    val = data.id or data.channel\r\n    s = \"#{val}\"\r\n    @buildValueForDisplaySimply valEl, s\r\n\r\n  onTabPressed: (e) ->\r\n    @tabToCurrentScript()\r\n    e.preventDefault()\r\n\r\n  onDeletePressed: (e) ->\r\n    returnVal = super(e)\r\n    if @callbacks.removeChild\r\n      @callbacks.removeChild()\r\n    returnVal\r\n\r\n  onRightArrowPressed: ->\r\n    @tabToCurrentScript()\r\n\r\n  tabToCurrentScript: ->\r\n    @settings.view.scriptTreema?.keepFocus()\r\n    firstRow = @settings.view.scriptTreema?.$el.find('.treema-node:visible').data('instance')\r\n    return unless firstRow?\r\n    firstRow.select()\r\n\r\nclass PropertiesNode extends TreemaObjectNode\r\n  nodeDescription: 'Script Property'\r\n\r\nclass EventPropsNode extends TreemaNode.nodeMap.string\r\n  valueClass: 'treema-event-props'\r\n\r\n  arrayToString: -> (@getData() or []).join('.')\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    joined = @arrayToString()\r\n    joined = '(unset)' if not joined.length\r\n    @buildValueForDisplaySimply valEl, joined\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    channel = @getRoot().data.channel\r\n    channelSchema = Backbone.Mediator.channelSchemas[channel]\r\n    autocompleteValues = []\r\n    autocompleteValues.push key for key, val of channelSchema?.properties\r\n    valEl.find('input').autocomplete(source: autocompleteValues, minLength: 0, delay: 0, autoFocus: true).autocomplete('search')\r\n    valEl\r\n\r\n  saveChanges: (valEl) ->\r\n    @data = (s for s in $('input', valEl).val().split('.') when s.length)\r\n\r\nclass EventPrereqsNode extends TreemaNode.nodeMap.array\r\n  open: (depth=2) ->\r\n    super(depth)\r\n\r\n  addNewChild: ->\r\n    newTreema = super(arguments)\r\n    return unless newTreema?\r\n    newTreema.open()\r\n    newTreema.childrenTreemas.eventProps?.edit()\r\n\r\nclass EventPrereqNode extends TreemaNode.nodeMap.object\r\n  buildValueForDisplay: (valEl, data) ->\r\n    eventProp = (data.eventProps or []).join('.')\r\n    eventProp = '(unset)' unless eventProp.length\r\n    statements = []\r\n    for key, value of data\r\n      continue if key is 'eventProps'\r\n      comparison = @workingSchema.properties[key].title\r\n      value = value.toString()\r\n      statements.push(\"#{comparison} #{value}\")\r\n    statements = statements.join(', ')\r\n    s = \"#{eventProp} #{statements}\"\r\n    @buildValueForDisplaySimply valEl, s\r\n\r\nclass ChannelNode extends TreemaNode.nodeMap.string\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    autocompleteValues = ({label: val?.title or key, value: key} for key, val of Backbone.Mediator.channelSchemas)\r\n    valEl.find('input').autocomplete(source: autocompleteValues, minLength: 0, delay: 0, autoFocus: true)\r\n    valEl\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/settings_tab'\r\nLevel = require 'models/Level'\r\nThangType = require 'models/ThangType'\r\nSurface = require 'lib/surface/Surface'\r\nnodes = require './../treema_nodes'\r\n{me} = require 'core/auth'\r\nrequire 'vendor/treema'\r\nconcepts = require 'schemas/concepts'\r\n\r\nmodule.exports = class SettingsTabView extends CocoView\r\n  id: 'editor-level-settings-tab-view'\r\n  className: 'tab-pane'\r\n  template: template\r\n\r\n  # not thangs or scripts or the backend stuff\r\n  editableSettings: [\r\n    'name', 'description', 'documentation', 'nextLevel', 'victory', 'i18n', 'goals',\r\n    'type', 'kind', 'terrain', 'banner', 'loadingTip', 'requiresSubscription', 'adventurer', 'adminOnly',\r\n    'helpVideos', 'replayable', 'scoreTypes', 'concepts', 'primaryConcepts', 'picoCTFProblem', 'practice', 'practiceThresholdMinutes'\r\n    'primerLanguage', 'shareable', 'studentPlayInstructions', 'requiredCode', 'suspectCode',\r\n    'requiredGear', 'restrictedGear', 'requiredProperties', 'restrictedProperties', 'recommendedHealth', 'allowedHeroes'\r\n  ]\r\n\r\n  subscriptions:\r\n    'editor:level-loaded': 'onLevelLoaded'\r\n    'editor:thangs-edited': 'onThangsEdited'\r\n    'editor:random-terrain-generated': 'onRandomTerrainGenerated'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n\r\n  onLoaded: ->\r\n  onLevelLoaded: (e) ->\r\n    @level = e.level\r\n    data = _.pick @level.attributes, (value, key) => key in @editableSettings\r\n    schema = _.cloneDeep Level.schema\r\n    schema.properties = _.pick schema.properties, (value, key) => key in @editableSettings\r\n    schema.required = _.intersection schema.required, @editableSettings\r\n    schema.default = _.pick schema.default, (value, key) => key in @editableSettings\r\n    @thangIDs = @getThangIDs()\r\n    treemaOptions =\r\n      filePath: \"db/level/#{@level.get('original')}\"\r\n      supermodel: @supermodel\r\n      schema: schema\r\n      data: data\r\n      readOnly: me.get('anonymous')\r\n      callbacks: {change: @onSettingsChanged}\r\n      thangIDs: @thangIDs\r\n      nodeClasses:\r\n        object: SettingsNode\r\n        thang: nodes.ThangNode\r\n        'solution-gear': SolutionGearNode\r\n        'solution-stats': SolutionStatsNode\r\n        concept: ConceptNode\r\n        'concepts-list': ConceptsListNode\r\n      solutions: @level.getSolutions()\r\n\r\n    @settingsTreema = @$el.find('#settings-treema').treema treemaOptions\r\n    @settingsTreema.build()\r\n    @settingsTreema.open()\r\n    @lastTerrain = data.terrain\r\n\r\n  getThangIDs: ->\r\n    (t.id for t in @level.get('thangs') ? [])\r\n\r\n  onSettingsChanged: (e) =>\r\n    $('.level-title').text @settingsTreema.data.name\r\n    for key in @editableSettings\r\n      @level.set key, @settingsTreema.data[key]\r\n    if (terrain = @settingsTreema.data.terrain) isnt @lastTerrain\r\n      @lastTerrain = terrain\r\n      Backbone.Mediator.publish 'editor:terrain-changed', terrain: terrain\r\n    for goal, index in @settingsTreema.data.goals ? []\r\n      continue if goal.id\r\n      goalIndex = index\r\n      goalID = \"goal-#{goalIndex}\"\r\n      goalID = \"goal-#{++goalIndex}\" while _.find @settingsTreema.get(\"goals\"), id: goalID\r\n      @settingsTreema.disableTracking()\r\n      @settingsTreema.set \"/goals/#{index}/id\", goalID\r\n      @settingsTreema.set \"/goals/#{index}/name\", _.string.humanize goalID\r\n      @settingsTreema.enableTracking()\r\n\r\n  onThangsEdited: (e) ->\r\n    # Update in-place so existing Treema nodes refer to the same array.\r\n    @thangIDs?.splice(0, @thangIDs.length, @getThangIDs()...)\r\n    @settingsTreema.solutions = @level.getSolutions()  # Remove if slow\r\n\r\n  onRandomTerrainGenerated: (e) ->\r\n    @settingsTreema.set '/terrain', e.terrain\r\n\r\n  destroy: ->\r\n    @settingsTreema?.destroy()\r\n    super()\r\n\r\n\r\nclass SettingsNode extends TreemaObjectNode\r\n  nodeDescription: 'Settings'\r\n\r\nclass SolutionGearNode extends TreemaArrayNode\r\n  select: ->\r\n    super()\r\n    return unless solution = _.find @getRoot().solutions, succeeds: true, language: 'javascript'\r\n    propertiesUsed = []\r\n    for match in (solution.source ? '').match /hero\\.([a-z][A-Za-z0-9]*)/g\r\n      prop = match.split('.')[1]\r\n      propertiesUsed.push prop unless prop in propertiesUsed\r\n    return unless propertiesUsed.length\r\n    if _.isEqual @data, propertiesUsed\r\n      @$el.find('.treema-description').html('Solution uses exactly these required properties.')\r\n      return\r\n    description = 'Solution used properties: ' + [\"<code>#{prop}</code>\" for prop in propertiesUsed].join(' ')\r\n    button = $('<button class=\"btn btn-sm\">Use</button>')\r\n    $(button).on 'click', =>\r\n      @set '', propertiesUsed\r\n      _.defer =>\r\n        @open()\r\n        @select()\r\n    @$el.find('.treema-description').html(description).append(button)\r\n\r\nclass SolutionStatsNode extends TreemaNode.nodeMap.number\r\n  select: ->\r\n    super()\r\n    return unless solution = _.find @getRoot().solutions, succeeds: true, language: 'javascript'\r\n    ThangType.calculateStatsForHeroConfig solution.heroConfig, (stats) =>\r\n      stats[key] = val.toFixed(2) for key, val of stats when parseInt(val) isnt val\r\n      description = \"Solution had stats: <code>#{JSON.stringify(stats)}</code>\"\r\n      button = $('<button class=\"btn btn-sm\">Use health</button>')\r\n      $(button).on 'click', =>\r\n        @set '', stats.health\r\n        _.defer =>\r\n          @open()\r\n          @select()\r\n      @$el.find('.treema-description').html(description).append(button)\r\n\r\nclass ConceptNode extends TreemaNode.nodeMap.string\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super valEl, data\r\n    return unless data\r\n    return console.error \"Couldn't find concept #{@data}\" unless concept = _.find concepts, concept: @data\r\n    description = \"#{concept.name} -- #{concept.description}\"\r\n    description = description + \" (Deprecated)\" if concept.deprecated\r\n    description = \"AUTO | \" + description if concept.automatic\r\n    @$el.find('.treema-row').css('float', 'left')\r\n    @$el.addClass('concept-automatic') if concept.automatic\r\n    @$el.addClass('concept-deprecated') if concept.deprecated\r\n    @$el.find('.treema-description').remove()\r\n    @$el.append($(\"<span class='treema-description'>#{description}</span>\").show())\r\n\r\n  limitChoices: (options) ->\r\n    if @parent.keyForParent is 'concepts'\r\n      options = (o for o in options when _.find(concepts, (c) -> c.concept is o and not c.automatic and not c.deprecated))  # Allow manual, not automatic\r\n    else\r\n      options = (o for o in options when _.find(concepts, (c) -> c.concept is o and not c.deprecated))  # Allow both\r\n    super options\r\n\r\n  onClick: (e) ->\r\n    return if @$el.hasClass('concept-automatic')  # Don't allow editing of automatic concepts\r\n    super e\r\n\r\nclass ConceptsListNode extends TreemaNode.nodeMap.array\r\n  sort: true\r\n\r\n  sortFunction: (a, b) ->\r\n    aAutomatic = _.find concepts, (c) -> c.concept is a and c.automatic\r\n    bAutomatic = _.find concepts, (c) -> c.concept is b and c.automatic\r\n    return 1 if bAutomatic and not aAutomatic  # Auto before manual\r\n    return -1 if aAutomatic and not bAutomatic  # Auto before manual\r\n    return 0 if not aAutomatic and not bAutomatic  # No ordering within manual\r\n    super a, b  # Alpha within auto\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/system/add'\r\navailableSystemTemplate = require 'templates/editor/level/system/available_system'\r\nLevelSystem = require 'models/LevelSystem'\r\nCocoCollection = require 'collections/CocoCollection'\r\n\r\nclass LevelSystemSearchCollection extends CocoCollection\r\n  url: '/db/level.system'\r\n  model: LevelSystem\r\n\r\nmodule.exports = class AddLevelSystemModal extends ModalView\r\n  id: 'editor-level-system-add-modal'\r\n  template: template\r\n  instant: true\r\n\r\n  events:\r\n    'click .available-systems-list li': 'onAddSystem'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @extantSystems = options.extantSystems ? []\r\n    @systems = @supermodel.loadCollection(new LevelSystemSearchCollection(), 'systems').model\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @renderAvailableSystems()\r\n\r\n  renderAvailableSystems: ->\r\n    ul = @$el.find('ul.available-systems-list').empty()\r\n    systems = (m.attributes for m in @systems.models)\r\n    _.remove systems, (system) =>\r\n      _.find @extantSystems, {original: system.original}  # already have this one added\r\n    systems = _.sortBy systems, 'name'\r\n    for system in systems\r\n      ul.append $(availableSystemTemplate(system: system))\r\n\r\n  onAddSystem: (e) ->\r\n    id = $(e.currentTarget).data('system-id')\r\n    system = _.find @systems.models, id: id\r\n    unless system\r\n      return console.error 'Couldn\\'t find system for id', id, 'out of', @systems.models\r\n    # Add all dependencies, recursively, unless we already have them\r\n    toAdd = system.getDependencies(@systems.models)\r\n    _.remove toAdd, (s1) =>\r\n      _.find @extantSystems, original: s1.get('original')\r\n    for s in toAdd.concat [system]\r\n      levelSystem =\r\n        original: s.get('original') ? id\r\n        majorVersion: s.get('version').major ? 0\r\n      @extantSystems.push levelSystem\r\n      Backbone.Mediator.publish 'editor:level-system-added', system: levelSystem\r\n    @renderAvailableSystems()\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/system/level-system-edit-view'\r\nLevelSystem = require 'models/LevelSystem'\r\nSystemVersionsModal = require 'views/editor/level/systems/SystemVersionsModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nSaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\nace = require 'ace'\r\n\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class LevelSystemEditView extends CocoView\r\n  id: 'level-system-edit-view'\r\n  template: template\r\n  editableSettings: ['name', 'description', 'codeLanguage', 'dependencies', 'propertyDocumentation', 'i18n']\r\n\r\n  events:\r\n    'click #done-editing-system-button': 'endEditing'\r\n    'click .nav a': (e) -> $(e.target).tab('show')\r\n    'click #system-patches-tab': -> @patchesView.load()\r\n    'click #system-code-tab': 'buildCodeEditor'\r\n    'click #system-config-schema-tab': 'buildConfigSchemaTreema'\r\n    'click #system-settings-tab': 'buildSettingsTreema'\r\n    'click #system-history-button': 'showVersionHistory'\r\n    'click #patch-system-button': 'startPatchingSystem'\r\n    'click #system-watch-button': 'toggleWatchSystem'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @levelSystem = @supermodel.getModelByOriginalAndMajorVersion LevelSystem, options.original, options.majorVersion or 0\r\n    console.log 'Couldn\\'t get levelSystem for', options, 'from', @supermodel.models unless @levelSystem\r\n\r\n  afterRender: ->\r\n    super()\r\n    @buildSettingsTreema()\r\n    @buildConfigSchemaTreema()\r\n    @buildCodeEditor()\r\n    @patchesView = @insertSubView(new PatchesView(@levelSystem), @$el.find('.patches-view'))\r\n    @updatePatchButton()\r\n\r\n  buildSettingsTreema: ->\r\n    data = _.pick @levelSystem.attributes, (value, key) => key in @editableSettings\r\n    schema = _.cloneDeep LevelSystem.schema\r\n    schema.properties = _.pick schema.properties, (value, key) => key in @editableSettings\r\n    schema.required = _.intersection schema.required, @editableSettings\r\n    schema.default = _.pick schema.default, (value, key) => key in @editableSettings\r\n\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: schema\r\n      data: data\r\n      callbacks: {change: @onSystemSettingsEdited}\r\n    treemaOptions.readOnly = me.get('anonymous')\r\n    @systemSettingsTreema = @$el.find('#edit-system-treema').treema treemaOptions\r\n    @systemSettingsTreema.build()\r\n    @systemSettingsTreema.open()\r\n\r\n  onSystemSettingsEdited: =>\r\n    # Make sure it validates first?\r\n    for key, value of @systemSettingsTreema.data\r\n      @levelSystem.set key, value unless key is 'js' # will compile code if needed\r\n    @updatePatchButton()\r\n\r\n  buildConfigSchemaTreema: ->\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: LevelSystem.schema.properties.configSchema\r\n      data: $.extend true, {}, @levelSystem.get 'configSchema'\r\n      callbacks: {change: @onConfigSchemaEdited}\r\n    treemaOptions.readOnly = me.get('anonymous')\r\n    @configSchemaTreema = @$el.find('#config-schema-treema').treema treemaOptions\r\n    @configSchemaTreema.build()\r\n    @configSchemaTreema.open()\r\n    # TODO: schema is not loaded for the first one here?\r\n    @configSchemaTreema.tv4.addSchema('metaschema', LevelSystem.schema.properties.configSchema)\r\n\r\n  onConfigSchemaEdited: =>\r\n    @levelSystem.set 'configSchema', @configSchemaTreema.data\r\n    @updatePatchButton()\r\n\r\n  buildCodeEditor: ->\r\n    @destroyAceEditor(@editor)\r\n    editorEl = $('<div></div>').text(@levelSystem.get('code')).addClass('inner-editor')\r\n    @$el.find('#system-code-editor').empty().append(editorEl)\r\n    @editor = ace.edit(editorEl[0])\r\n    @editor.setReadOnly(me.get('anonymous'))\r\n    session = @editor.getSession()\r\n    session.setMode 'ace/mode/coffee'\r\n    session.setTabSize 2\r\n    session.setNewLineMode = 'unix'\r\n    session.setUseSoftTabs true\r\n    @editor.on('change', @onEditorChange)\r\n\r\n  onEditorChange: =>\r\n    @levelSystem.set 'code', @editor.getValue()\r\n    @updatePatchButton()\r\n\r\n  updatePatchButton: ->\r\n    @$el.find('#patch-system-button').toggle Boolean @levelSystem.hasLocalChanges()\r\n\r\n  endEditing: (e) ->\r\n    Backbone.Mediator.publish 'editor:level-system-editing-ended', system: @levelSystem\r\n    null\r\n\r\n  showVersionHistory: (e) ->\r\n    systemVersionsModal = new SystemVersionsModal {}, @levelSystem.id\r\n    @openModalView systemVersionsModal\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  startPatchingSystem: (e) ->\r\n    @openModalView new SaveVersionModal({model: @levelSystem})\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  toggleWatchSystem: ->\r\n    console.log 'toggle watch system?'\r\n    button = @$el.find('#system-watch-button')\r\n    @levelSystem.watch(button.find('.watch').is(':visible'))\r\n    button.find('> span').toggleClass('secret')\r\n\r\n  destroy: ->\r\n    @destroyAceEditor(@editor)\r\n    @systemSettingsTreema?.destroy()\r\n    @configSchemaTreema?.destroy()\r\n    super()\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/system/new'\r\nLevelSystem = require 'models/LevelSystem'\r\nforms = require 'core/forms'\r\n{me} = require 'core/auth'\r\n\r\nmodule.exports = class NewLevelSystemModal extends ModalView\r\n  id: 'editor-level-system-new-modal'\r\n  template: template\r\n  instant: false\r\n  modalWidthPercent: 60\r\n\r\n  events:\r\n    'click #new-level-system-submit': 'makeNewLevelSystem'\r\n    'submit form': 'makeNewLevelSystem'\r\n\r\n  makeNewLevelSystem: (e) ->\r\n    e.preventDefault()\r\n    system = @$el.find('#level-system-system').val()\r\n    name = @$el.find('#level-system-name').val()\r\n    system = new LevelSystem()\r\n    system.set 'name', name\r\n    system.set 'code', system.get('code', true).replace(/Jitter/g, name)\r\n    system.set 'permissions', [{access: 'owner', target: me.id}]  # Private until saved in a published Level\r\n    res = system.save(null, {type: 'POST'})  # Override PUT so we can trigger postFirstVersion logic\r\n    return unless res\r\n\r\n    @showLoading()\r\n    res.error =>\r\n      @hideLoading()\r\n      console.log 'Got errors:', JSON.parse(res.responseText)\r\n      forms.applyErrorsToForm(@$el, JSON.parse(res.responseText))\r\n    res.success =>\r\n      @supermodel.registerModel system\r\n      Backbone.Mediator.publish 'editor:edit-level-system', original: system.get('_id'), majorVersion: 0\r\n      @hide()\r\n","VersionsModal = require 'views/editor/modal/VersionsModal'\r\n\r\nmodule.exports = class SystemVersionsModal extends VersionsModal\r\n  id: 'editor-system-versions-view'\r\n  url: '/db/level.system/'\r\n  page: 'system'\r\n\r\n  constructor: (options, @ID) ->\r\n    super options, @ID, require 'models/LevelSystem'\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/systems-tab-view'\r\nLevel = require 'models/Level'\r\nLevelSystem = require 'models/LevelSystem'\r\nLevelSystemEditView = require './LevelSystemEditView'\r\nNewLevelSystemModal = require './NewLevelSystemModal'\r\nAddLevelSystemModal = require './AddLevelSystemModal'\r\nnodes = require '../treema_nodes'\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class SystemsTabView extends CocoView\r\n  id: 'systems-tab-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  subscriptions:\r\n    'editor:level-system-added': 'onLevelSystemAdded'\r\n    'editor:edit-level-system': 'editLevelSystem'\r\n    'editor:level-system-editing-ended': 'onLevelSystemEditingEnded'\r\n    'editor:level-loaded': 'onLevelLoaded'\r\n    'editor:terrain-changed': 'onTerrainChanged'\r\n\r\n  events:\r\n    'click #add-system-button': 'addLevelSystem'\r\n    'click #create-new-system-button': 'createNewLevelSystem'\r\n    'click #create-new-system': 'createNewLevelSystem'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    for system in @buildDefaultSystems()\r\n      url = \"/db/level.system/#{system.original}/version/#{system.majorVersion}\"\r\n      ls = new LevelSystem().setURL(url)\r\n      @supermodel.loadModel(ls)\r\n\r\n  afterRender: ->\r\n    @buildSystemsTreema()\r\n\r\n  onLoaded: ->\r\n    super()\r\n\r\n  onLevelLoaded: (e) ->\r\n    @level = e.level\r\n    @buildSystemsTreema()\r\n\r\n  buildSystemsTreema: ->\r\n    return unless @level and @supermodel.finished()\r\n    systems = $.extend(true, [], @level.get('systems') ? [])\r\n    unless systems.length\r\n      systems = @buildDefaultSystems()\r\n      insertedDefaults = true\r\n    systems = @getSortedByName systems\r\n    thangs = if @level? then @level.get('thangs') else []\r\n    thangIDs = _.filter(_.pluck(thangs, 'id'))\r\n    teams = _.filter(_.pluck(thangs, 'team'))\r\n    superteams = _.filter(_.pluck(thangs, 'superteam'))\r\n    superteams = _.union(teams, superteams)\r\n    treemaOptions =\r\n      supermodel: @supermodel\r\n      schema: Level.schema.properties.systems\r\n      data: systems\r\n      readOnly: me.get('anonymous')\r\n      world: @options.world\r\n      view: @\r\n      thangIDs: thangIDs\r\n      teams: teams\r\n      superteams: superteams\r\n      callbacks:\r\n        change: @onSystemsChanged\r\n        select: @onSystemSelected\r\n      nodeClasses:\r\n        'level-system': LevelSystemNode\r\n        'level-system-configuration': LevelSystemConfigurationNode\r\n        'point2d': nodes.WorldPointNode\r\n        'viewport': nodes.WorldViewportNode\r\n        'bounds': nodes.WorldBoundsNode\r\n        'radians': nodes.RadiansNode\r\n        'team': nodes.TeamNode\r\n        'superteam': nodes.SuperteamNode\r\n        'meters': nodes.MetersNode\r\n        'kilograms': nodes.KilogramsNode\r\n        'seconds': nodes.SecondsNode\r\n        'speed': nodes.SpeedNode\r\n        'acceleration': nodes.AccelerationNode\r\n        'thang-type': nodes.ThangTypeNode\r\n        'item-thang-type': nodes.ItemThangTypeNode\r\n\r\n    @systemsTreema = @$el.find('#systems-treema').treema treemaOptions\r\n    @systemsTreema.build()\r\n    @systemsTreema.open()\r\n    @onSystemsChanged() if insertedDefaults\r\n\r\n  onSystemsChanged: (e) =>\r\n    systems = @getSortedByName @systemsTreema.data\r\n    @level.set 'systems', systems\r\n\r\n  getSortedByName: (systems) =>\r\n    systemModels = @supermodel.getModels LevelSystem\r\n    systemModelMap = {}\r\n    systemModelMap[sys.get('original')] = sys.get('name') for sys in systemModels\r\n    _.sortBy systems, (sys) -> systemModelMap[sys.original]\r\n\r\n  onSystemSelected: (e, selected) =>\r\n    selected = if selected.length > 1 then selected[0].getLastSelectedTreema() else selected[0]\r\n    unless selected\r\n      @removeSubView @levelSystemEditView if @levelSystemEditView\r\n      @levelSystemEditView = null\r\n      return\r\n    until (data = selected.getData()) and data.original\r\n      selected = selected.parent\r\n    @editLevelSystem original: data.original, majorVersion: data.majorVersion\r\n\r\n  onLevelSystemAdded: (e) ->\r\n    @systemsTreema.insert '/', e.system\r\n\r\n  addLevelSystem: (e) ->\r\n    @openModalView new AddLevelSystemModal supermodel: @supermodel, extantSystems: _.cloneDeep @systemsTreema.data\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  createNewLevelSystem: (e) ->\r\n    @openModalView new NewLevelSystemModal supermodel: @supermodel\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  editLevelSystem: (e) ->\r\n    @levelSystemEditView = @insertSubView new LevelSystemEditView(original: e.original, majorVersion: e.majorVersion, supermodel: @supermodel)\r\n\r\n  onLevelSystemEditingEnded: (e) ->\r\n    @removeSubView @levelSystemEditView\r\n    @levelSystemEditView = null\r\n\r\n  onTerrainChanged: (e) ->\r\n    defaultPathfinding = e.terrain in ['Dungeon', 'Indoor', 'Mountain', 'Glacier', 'Volcano']\r\n    changed = false\r\n    if AI = @systemsTreema.get 'original=528110f30268d018e3000001'\r\n      unless AI.config?.findsPaths is defaultPathfinding\r\n        AI.config ?= {}\r\n        AI.config.findsPaths = defaultPathfinding\r\n        @systemsTreema.set 'original=528110f30268d018e3000001', AI\r\n        changed = true\r\n    if Vision = @systemsTreema.get 'original=528115040268d018e300001b'\r\n      unless Vision.config?.checksLineOfSight is defaultPathfinding\r\n        Vision.config ?= {}\r\n        Vision.config.checksLineOfSight = defaultPathfinding\r\n        @systemsTreema.set 'original=528115040268d018e300001b', Vision\r\n        changed = true\r\n    if changed\r\n      noty {\r\n        text: \"AI/Vision System defaulted pathfinding/line-of-sight to #{defaultPathfinding} for terrain #{e.terrain}.\"\r\n        layout: 'topCenter'\r\n        timeout: 5000\r\n        type: 'information'\r\n      }\r\n\r\n  buildDefaultSystems: ->\r\n    [\r\n      {original: '528112c00268d018e3000008', majorVersion: 0}  # Event\r\n      {original: '5280f83b8ae1581b66000001', majorVersion: 0}  # Existence\r\n      {original: '5281146f0268d018e3000014', majorVersion: 0}  # Programming\r\n      {original: '528110f30268d018e3000001', majorVersion: 0}  # AI\r\n      {original: '52810ffa33e01a6e86000012', majorVersion: 0}  # Action\r\n      {original: '528114b20268d018e3000017', majorVersion: 0}  # Targeting\r\n      {original: '528105f833e01a6e86000007', majorVersion: 0}  # Collision\r\n      {original: '528113240268d018e300000c', majorVersion: 0}  # Movement\r\n      {original: '528112530268d018e3000007', majorVersion: 0}  # Combat\r\n      {original: '52810f4933e01a6e8600000c', majorVersion: 0}  # Hearing\r\n      {original: '528115040268d018e300001b', majorVersion: 0}  # Vision\r\n      {original: '5280dc4d251616c907000001', majorVersion: 0}  # Inventory\r\n      {original: '528111b30268d018e3000004', majorVersion: 0}  # Alliance\r\n      {original: '528114e60268d018e300001a', majorVersion: 0}  # UI\r\n      {original: '528114040268d018e3000011', majorVersion: 0}  # Physics\r\n      {original: '52ae4f02a4dcd4415200000b', majorVersion: 0}  # Display\r\n      {original: '52e953e81b2028d102000004', majorVersion: 0}  # Effect\r\n      {original: '52f1354370fb890000000005', majorVersion: 0}  # Magic\r\n    ]\r\n\r\n  destroy: ->\r\n    @systemsTreema?.destroy()\r\n    super()\r\n\r\nclass LevelSystemNode extends TreemaObjectNode\r\n  valueClass: 'treema-level-system'\r\n  constructor: ->\r\n    super(arguments...)\r\n    @grabDBComponent()\r\n    @collection = @system?.attributes?.configSchema?.properties?\r\n\r\n  grabDBComponent: ->\r\n    data = @getData()\r\n    @system = @settings.supermodel.getModelByOriginalAndMajorVersion(LevelSystem, data.original, data.majorVersion)\r\n    console.error 'Couldn\\'t find system for', data.original, data.majorVersion, 'from models', @settings.supermodel.models unless @system\r\n\r\n  getChildSchema: (key) ->\r\n    return @system.attributes.configSchema if key is 'config'\r\n    return super(key)\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    return super valEl unless data.original and @system\r\n    name = @system.get 'name'\r\n    name += \" v#{@system.get('version').major}\" if @system.get('version').major\r\n    @buildValueForDisplaySimply valEl, name\r\n\r\n  onEnterPressed: (e) ->\r\n    super e\r\n    data = @getData()\r\n    Backbone.Mediator.publish 'editor:edit-level-system', original: data.original, majorVersion: data.majorVersion\r\n\r\n  open: (depth) ->\r\n    super depth\r\n    cTreema = @childrenTreemas.config\r\n    if cTreema? and (cTreema.getChildren().length or cTreema.canAddChild())\r\n      cTreema.open()\r\n# No easy way to flatten the config object, so for now just keep it longer than it needs to be\r\n\r\nclass LevelSystemConfigurationNode extends TreemaObjectNode\r\n  valueClass: 'treema-level-system-configuration'\r\n  buildValueForDisplay: -> return\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/tasks-tab'\r\nLevel = require 'models/Level'\r\n\r\nmodule.exports = class TasksTabView extends CocoView\r\n  id: 'editor-level-tasks-tab-view'\r\n  className: 'tab-pane'\r\n  template: template\r\n  events:\r\n    'click .task-row': 'onClickTaskRow'\r\n    'click .task-input': 'onClickTaskInput'\r\n    'click .start-edit': 'onClickStartEdit'\r\n    'click #create-task': 'onClickCreateTask'\r\n    'keydown #cur-edit': 'onKeyDownCurEdit'\r\n    'blur #cur-edit': 'onBlurCurEdit'\r\n\r\n  subscriptions:\r\n    'editor:level-loaded': 'onLevelLoaded'\r\n\r\n  applyTaskName: (_task, _input) ->\r\n    name = _input.value\r\n    potentialTask = @tasks.findWhere({'name':_input})\r\n    if potentialTask and potentialTask isnt _task\r\n      noty\r\n        timeout: 5000\r\n        text: 'Task with name already exists!'\r\n        type: 'error'\r\n        layout: 'topCenter'\r\n      _input.focus()\r\n    else if name is ''\r\n      @tasks.remove _task\r\n      @pushTasks()\r\n      @render()\r\n    else\r\n      _task.set 'name', name\r\n      _task.set 'curEdit', false\r\n      @pushTasks()\r\n      @render()\r\n\r\n  focusEditInput: ->\r\n    editInput = @$('#cur-edit')[0]\r\n    if editInput\r\n      editInput.focus()\r\n      len = editInput.value.length * 2\r\n      editInput.setSelectionRange len, len\r\n\r\n  getTaskByCID: (_cid) ->\r\n    return @tasks.get _cid\r\n\r\n  taskMap: ->\r\n    return @tasks?.map((_obj) -> return (name: _obj.get('name'), complete: (_obj.get('complete') || false)))\r\n\r\n  taskArray: ->\r\n    return @tasks?.toArray()\r\n\r\n  onLevelLoaded: (e) ->\r\n    @level = e.level\r\n    @defaultTasks = tasksForLevel @level\r\n    @level.set 'tasks', _.clone @defaultTasks\r\n    Task = Backbone.Model.extend({\r\n      initialize: ->\r\n        # We want to keep track of the revertAttributes easily without digging back into the level every time.\r\n        # So per TaskModel we check to see if there is a revertAttribute associated with the task's name.\r\n        # If there is a reversion available, we use it, otherwise (e.g. new tasks without a reversion) we just use the Task's current name/completion status.\r\n        if e?.level?._revertAttributes?.tasks?\r\n          if _.find(e.level._revertAttributes.tasks, {name:arguments[0].name})\r\n            @set 'revert', _.find(e.level._revertAttributes.tasks, {name:arguments[0].name})\r\n          else\r\n            @set 'revert', arguments[0]\r\n        else\r\n          @set 'revert', arguments[0]\r\n    })\r\n    TaskList = Backbone.Collection.extend({\r\n      model: Task\r\n    })\r\n    @tasks = new TaskList(@level.get 'tasks')\r\n    @pushTasks()\r\n    @render()\r\n\r\n  pushTasks: ->\r\n    @level.set 'tasks', @taskMap()\r\n\r\n  onClickTaskRow: (e) ->\r\n    if not $(e.target).is('input') and not $(e.target).is('a') and not $(e.target).hasClass('start-edit') and @$('#cur-edit').length is 0\r\n      task = @tasks.get $(e.target).closest('tr').data('task-cid')\r\n      checkbox = $(e.currentTarget).find('.task-input')[0]\r\n      if task.get 'complete'\r\n        task.set 'complete', false\r\n      else\r\n        task.set 'complete', true\r\n      checkbox.checked = task.get 'complete'\r\n      @pushTasks()\r\n\r\n  onClickTaskInput: (e) ->\r\n    task = @tasks.get $(e.target).closest('tr').data('task-cid')\r\n    task.set 'complete', e.currentTarget.checked\r\n    @pushTasks()\r\n\r\n  onClickStartEdit: (e) ->\r\n    if @$('#cur-edit').length is 0\r\n      task = @tasks.get $(e.target).closest('tr').data('task-cid')\r\n      task.set 'curEdit', true\r\n      @render()\r\n      @focusEditInput()\r\n\r\n  onKeyDownCurEdit: (e) ->\r\n    if e.keyCode is 13\r\n      editInput = @$('#cur-edit')[0]\r\n      editInput.blur()\r\n\r\n  onBlurCurEdit: (e) ->\r\n    editInput = @$('#cur-edit')[0]\r\n    task = @tasks.get $(e.target).closest('tr').data('task-cid')\r\n    @applyTaskName(task, editInput)\r\n\r\n  onClickCreateTask: (e) ->\r\n    if @$('#cur-edit').length is 0\r\n      @tasks.add\r\n        name: ''\r\n        complete: false\r\n        curEdit: true\r\n        revert:\r\n          name: 'null'\r\n          complete: false\r\n      @render()\r\n      @focusEditInput()\r\n\r\n  getTaskURL: (_n) ->\r\n    if _.find(@defaultTasks, {name:_n})?\r\n      return _.string.slugify(_n)\r\n    return null\r\n\r\n\r\nnotWebDev = ['hero', 'course', 'hero-ladder', 'course-ladder', 'game-dev']\r\nheroBased = ['hero', 'course', 'hero-ladder', 'course-ladder']\r\nladder = ['hero-ladder', 'course-ladder']\r\n\r\ndefaultTasks = [\r\n  {name: 'Set level type.', complete: (level) -> level.get('type')}\r\n  {name: 'Name the level.'}\r\n  {name: 'Create a Referee stub, if needed.', types: notWebDev}\r\n  {name: 'Replace \"Hero Placeholder\" with mcp.', types: ['game-dev']}\r\n  {name: 'Do basic set decoration.', types: notWebDev}\r\n  {name: 'Publish.', complete: (level) -> level.isPublished()}\r\n  {name: 'Choose the Existence System lifespan and frame rate.', types: notWebDev}\r\n  {name: 'Choose the UI System paths and coordinate hover if needed.', types: notWebDev}\r\n  {name: 'Choose the AI System pathfinding and Vision System line of sight.', types: notWebDev}\r\n  {name: 'Build the level.'}\r\n  {name: 'Set up goals.'}\r\n  {name: 'Add the \"win-game\" goal.', types: ['game-dev']}\r\n  {name: 'Write the sample code.', complete: (level) -> if level.isType('web-dev') then level.getSampleCode().html else level.getSampleCode().javascript and level.getSampleCode().python}\r\n  {name: 'Write the solution.', complete: (level) -> if level.isType('web-dev') then _.find(level.getSolutions(), language: 'html') else _.find(level.getSolutions(), language: 'javascript') and _.find(level.getSolutions(), language: 'python')}\r\n  {name: 'Make both teams playable and non-defaulted.', types: ladder}\r\n  {name: 'Set up goals for both teams.', types: ladder}\r\n  {name: 'Fill out the sample code for both Hero Placeholders.', types: ladder}\r\n  {name: 'Fill out default AI for both Hero Placeholders.', types: ladder}\r\n  {name: 'Make sure the level ends promptly on success and failure.'}\r\n  {name: 'Adjust script camera bounds.', types: notWebDev}\r\n  {name: 'Choose music file in Introduction script.', types: notWebDev}\r\n  {name: 'Choose autoplay in Introduction script.', types: heroBased}\r\n  {name: 'Write the description.'}\r\n  {name: 'Write the guide.'}\r\n  {name: 'Write intro guide.'}\r\n  {name: 'Write a loading tip, if needed.', complete: (level) -> level.get('loadingTip')}\r\n  {name: 'Add programming concepts covered.'}\r\n  {name: 'Set level kind.', complete: (level) -> level.get('kind')}\r\n  {name: 'Mark whether it requires a subscription.', complete: (level) -> level.get('requiresSubscription')?}\r\n  {name: 'Choose leaderboard score types.', types: ['hero', 'course'], complete: (level) -> level.get('scoreTypes')?}\r\n  {name: 'Do thorough set decoration.', types: notWebDev}\r\n  {name: 'Playtest with a slow/tough hero.', types: ['hero', 'hero-ladder']}\r\n  {name: 'Playtest with a fast/weak hero.', types: ['hero', 'hero-ladder']}\r\n  {name: 'Playtest with a couple random seeds.', types: heroBased}\r\n  {name: 'Remove/simplify unnecessary doodad collision.', types: notWebDev}\r\n  {name: 'Add to a campaign.'}\r\n  {name: 'Choose level options like required/restricted gear.', types: ['hero', 'hero-ladder']}\r\n  {name: 'Create achievements, including unlocking next level.'}\r\n  {name: 'Configure the hero\\'s expected equipment.', types: ['hero', 'course', 'course-ladder']}\r\n  {name: 'Configure the API docs.', types: ['web-dev', 'game-dev']}\r\n  {name: 'Write victory text.', complete: (level) -> level.get('victory')?.body}\r\n  {name: 'Write level hints.'}\r\n  {name: 'Set up solutions for the Verifier.'}\r\n  {name: 'Click the Populate i18n button.'}\r\n  {name: 'Add slug to ladder levels that should be simulated, if needed.', types: ladder}\r\n  {name: 'Write the advanced AIs (shaman, brawler, chieftain, etc).', types: ladder}\r\n  {name: 'Add achievements for defeating the advanced AIs.', types: ['hero-ladder']}\r\n  {name: 'Release to adventurers.'}\r\n  {name: 'Release to everyone.'}\r\n  {name: 'Create two sample projects.', types: ['game-dev', 'web-dev']}\r\n  {name: 'Write Lua sample code.', types: notWebDev, optional: true, complete: (level) -> level.getSampleCode().lua}\r\n  {name: 'Write Java sample code.', types: notWebDev, optional: true, complete: (level) -> level.getSampleCode().java}\r\n  {name: 'Write CoffeeScript sample code.', types: notWebDev, optional: true, complete: (level) -> level.getSampleCode().coffeescript}\r\n  {name: 'Write Lua solution.', types: notWebDev, optional: true, complete: (level) -> _.find(level.getSolutions(), language: 'lua')}\r\n  {name: 'Write Java solution.', types: notWebDev, optional: true, complete: (level) -> _.find(level.getSolutions(), language: 'java')}\r\n  {name: 'Write CoffeeScript solution.', types: notWebDev, optional: true, complete: (level) -> _.find(level.getSolutions(), language: 'coffeescript')}\r\n]\r\n\r\ndeprecatedTaskNames = [\r\n  'Add Io/Clojure/Lua/CoffeeScript.'\r\n  'Add Lua/CoffeeScript/Java.'\r\n  'Translate the sample code comments.'\r\n  'Add i18n field for the sample code comments.'\r\n  'Check completion/engagement/problem analytics.'\r\n  'Add a walkthrough video.'\r\n  'Do any custom scripting, if needed.'\r\n  'Write a really awesome description.'\r\n]\r\n\r\nrenamedTaskNames = {\r\n  'Release to adventurers.': 'Release to adventurers via MailChimp.'\r\n  'Release to everyone.': 'Release to everyone via MailChimp.'\r\n}\r\n\r\ntasksForLevel = (level) ->\r\n  tasks = []\r\n  inappropriateTasks = {}\r\n  for task in defaultTasks\r\n    if task.name is 'Create two sample projects' and level.get('shareable') isnt 'project'\r\n      inappropriateTasks[task.name] = task\r\n    else if task.types and ((level.get('realType') or level.get('type', true)) not in task.types)\r\n      inappropriateTasks[task.name] = task\r\n    else\r\n      tasks.push task\r\n  oldTasks = (level.get('tasks') ? []).slice()\r\n  newTasks = []\r\n  for task in tasks\r\n    oldName = renamedTaskNames[task.name] or task.name\r\n    if oldTask = (_.find(oldTasks, name: oldName) or _.find(oldTasks, name: task.name))\r\n      complete = oldTask.complete or Boolean task.complete?(level)\r\n      _.remove oldTasks, name: oldTask.name\r\n    else\r\n      complete = Boolean task.complete?(level)\r\n      continue if not complete and task.optional\r\n    newTasks.push name: task.name, complete: complete\r\n  for oldTask in oldTasks\r\n    unless oldTask.name in deprecatedTaskNames or inappropriateTasks[oldTask.name]\r\n      newTasks.push oldTask\r\n  newTasks\r\n","CocoView = require 'views/core/CocoView'\r\nadd_thangs_template = require 'templates/editor/level/add-thangs-view'\r\nThangType = require 'models/ThangType'\r\nCocoCollection = require 'collections/CocoCollection'\r\n\r\nclass ThangTypeSearchCollection extends CocoCollection\r\n  url: '/db/thang.type?project=original,name,version,description,slug,kind,rasterIcon'\r\n  model: ThangType\r\n\r\n  addTerm: (term) ->\r\n    @url += \"&term=#{term}\" if term\r\n\r\nmodule.exports = class AddThangsView extends CocoView\r\n  id: 'add-thangs-view'\r\n  className: 'add-thangs-palette'\r\n  template: add_thangs_template\r\n\r\n  events:\r\n    'keyup input#thang-search': 'runSearch'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @world = options.world\r\n\r\n    # should load depended-on Components, too\r\n    @thangTypes = @supermodel.loadCollection(new ThangTypeSearchCollection(), 'thangs').model\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    if @searchModels\r\n      models = @searchModels\r\n    else\r\n      models = @supermodel.getModels(ThangType)\r\n\r\n    thangTypes = _.uniq models, false, (thangType) -> thangType.get('original')\r\n    thangTypes = _.reject thangTypes, (thangType) -> thangType.get('kind') in ['Mark', 'Item', undefined]\r\n    groupMap = {}\r\n    for thangType in thangTypes\r\n      kind = thangType.get('kind')\r\n      groupMap[kind] ?= []\r\n      groupMap[kind].push thangType\r\n\r\n    groups = []\r\n    for groupName in Object.keys(groupMap).sort()\r\n      someThangTypes = groupMap[groupName]\r\n      someThangTypes = _.sortBy someThangTypes, (thangType) -> thangType.get('name')\r\n      group =\r\n        name: groupName\r\n        thangs: someThangTypes\r\n      groups.push group\r\n\r\n    groups = _.sortBy groups, (group) ->\r\n      index = ['Wall', 'Floor', 'Unit', 'Doodad', 'Misc'].indexOf group.name\r\n      if index is -1 then 9001 else index\r\n\r\n    context.thangTypes = thangTypes\r\n    context.groups = groups\r\n    context\r\n\r\n  afterRender: ->\r\n    super()\r\n    @buildAddThangPopovers()\r\n\r\n  buildAddThangPopovers: ->\r\n    @$el.find('#thangs-list .add-thang-palette-icon').addClass('has-tooltip').tooltip(container: 'body', animation: false)\r\n\r\n  runSearch: (e) =>\r\n    if e?.which is 27\r\n      @onEscapePressed()\r\n    term = @$el.find('input#thang-search').val()\r\n    return unless term isnt @lastSearch\r\n\r\n    @searchModels = @thangTypes.filter (model) ->\r\n      return true unless term\r\n      regExp = new RegExp term, 'i'\r\n      return model.get('name').match regExp\r\n    @render()\r\n    @$el.find('input#thang-search').focus().val(term)\r\n    @lastSearch = term\r\n\r\n  onEscapePressed: ->\r\n    @$el.find('input#thang-search').val('')\r\n    @runSearch\r\n","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/level/thang/level-thang-edit-view'\r\nThangComponentsEditView = require 'views/editor/component/ThangComponentsEditView'\r\nThangType = require 'models/ThangType'\r\nace = require 'ace'\r\n\r\nmodule.exports = class LevelThangEditView extends CocoView\r\n  ###\r\n  In the level editor, is the bar at the top when editing a single thang.\r\n  Everything below is part of the ThangComponentsEditView, which is shared with the\r\n  ThangType editor view.\r\n  ###\r\n\r\n  id: 'level-thang-edit-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #all-thangs-link': 'navigateToAllThangs'\r\n    'click #thang-name-link span': 'toggleNameEdit'\r\n    'click #thang-type-link span': 'toggleTypeEdit'\r\n    'blur #thang-name-link input': 'toggleNameEdit'\r\n    'blur #thang-type-link input': 'toggleTypeEdit'\r\n    'keydown #thang-name-link input': 'toggleNameEditIfReturn'\r\n    'keydown #thang-type-link input': 'toggleTypeEditIfReturn'\r\n\r\n  constructor: (options) ->\r\n    options ?= {}\r\n    super options\r\n    @world = options.world\r\n    @thangData = $.extend true, {}, options.thangData ? {}\r\n    @level = options.level\r\n    @oldPath = options.oldPath\r\n    @reportChanges = _.debounce @reportChanges, 1000\r\n\r\n  onLoaded: -> @render()\r\n  afterRender: ->\r\n    super()\r\n    thangType = @supermodel.getModelByOriginal(ThangType, @thangData.thangType)\r\n    options =\r\n      components: @thangData.components\r\n      supermodel: @supermodel\r\n      level: @level\r\n      world: @world\r\n\r\n    if @level.isType('hero', 'hero-ladder', 'hero-coop', 'course', 'course-ladder', 'game-dev', 'web-dev') then options.thangType = thangType\r\n\r\n    @thangComponentEditView = new ThangComponentsEditView options\r\n    @listenTo @thangComponentEditView, 'components-changed', @onComponentsChanged\r\n    @insertSubView @thangComponentEditView\r\n    thangTypeNames = (m.get('name') for m in @supermodel.getModels ThangType)\r\n    input = @$el.find('#thang-type-link input').autocomplete(source: thangTypeNames, minLength: 0, delay: 0, autoFocus: true)\r\n    thangType = _.find @supermodel.getModels(ThangType), (m) => m.get('original') is @thangData.thangType\r\n    thangTypeName = thangType?.get('name') or 'None'\r\n    input.val(thangTypeName)\r\n    @$el.find('#thang-type-link span').text(thangTypeName)\r\n    @hideLoading()\r\n\r\n  navigateToAllThangs: ->\r\n    Backbone.Mediator.publish 'editor:level-thang-done-editing', {thangData: $.extend(true, {}, @thangData), oldPath: @oldPath}\r\n\r\n  toggleNameEdit: ->\r\n    link = @$el.find '#thang-name-link'\r\n    wasEditing = link.find('input:visible').length\r\n    span = link.find('span')\r\n    input = link.find('input')\r\n    if wasEditing then span.text(input.val()) else input.val(span.text())\r\n    link.find('span, input').toggle()\r\n    input.select() unless wasEditing\r\n    @thangData.id = span.text()\r\n\r\n  toggleTypeEdit: ->\r\n    link = @$el.find '#thang-type-link'\r\n    wasEditing = link.find('input:visible').length\r\n    span = link.find('span')\r\n    input = link.find('input')\r\n    span.text(input.val()) if wasEditing\r\n    link.find('span, input').toggle()\r\n    input.select() unless wasEditing\r\n    thangTypeName = input.val()\r\n    thangType = _.find @supermodel.getModels(ThangType), (m) -> m.get('name') is thangTypeName\r\n    if thangType and wasEditing\r\n      @thangData.thangType = thangType.get('original')\r\n\r\n  toggleNameEditIfReturn: (e) ->\r\n    @$el.find('#thang-name-link input').blur() if e.which is 13\r\n\r\n  toggleTypeEditIfReturn: (e) ->\r\n    @$el.find('#thang-type-link input').blur() if e.which is 13\r\n\r\n  onComponentsChanged: (components) =>\r\n    @thangData.components = components\r\n    @reportChanges()\r\n\r\n  reportChanges: =>\r\n    return if @destroyed\r\n    Backbone.Mediator.publish 'editor:level-thang-edited', {thangData: $.extend(true, {}, @thangData), oldPath: @oldPath}\r\n","CocoView = require 'views/core/CocoView'\r\nAddThangsView = require './AddThangsView'\r\nthangs_template = require 'templates/editor/level/thangs-tab-view'\r\nLevel = require 'models/Level'\r\nThangType = require 'models/ThangType'\r\nLevelComponent = require 'models/LevelComponent'\r\nCocoCollection = require 'collections/CocoCollection'\r\n{isObjectID} = require 'models/CocoModel'\r\nSurface = require 'lib/surface/Surface'\r\nThang = require 'lib/world/thang'\r\nLevelThangEditView = require './LevelThangEditView'\r\nLevelComponents = require 'collections/LevelComponents'\r\nrequire 'vendor/treema'\r\nGameUIState = require 'models/GameUIState'\r\n\r\n# Moving the screen while dragging thangs constants\r\nMOVE_MARGIN = 0.15\r\nMOVE_SPEED = 13\r\n\r\n# Let us place these on top of other Thangs\r\noverlappableThangTypeNames = ['Torch', 'Chains', 'Bird', 'Cloud 1', 'Cloud 2', 'Cloud 3', 'Waterfall', 'Obstacle', 'Electrowall', 'Spike Walls']\r\n\r\nclass ThangTypeSearchCollection extends CocoCollection\r\n  url: '/db/thang.type?project=original,name,version,slug,kind,components,prerenderedSpriteSheetData'\r\n  model: ThangType\r\n\r\nmodule.exports = class ThangsTabView extends CocoView\r\n  id: 'thangs-tab-view'\r\n  className: 'tab-pane active'\r\n  template: thangs_template\r\n\r\n  subscriptions:\r\n    'surface:mouse-moved': 'onSurfaceMouseMoved'\r\n    'surface:mouse-over': 'onSurfaceMouseOver'\r\n    'surface:mouse-out': 'onSurfaceMouseOut'\r\n    'editor:edit-level-thang': 'editThang'\r\n    'editor:level-thang-edited': 'onLevelThangEdited'\r\n    'editor:level-thang-done-editing': 'onLevelThangDoneEditing'\r\n    'editor:view-switched': 'onViewSwitched'\r\n    'sprite:dragged': 'onSpriteDragged'\r\n    'sprite:mouse-up': 'onSpriteMouseUp'\r\n    'sprite:double-clicked': 'onSpriteDoubleClicked'\r\n    'surface:stage-mouse-down': 'onStageMouseDown'\r\n    'surface:stage-mouse-up': 'onStageMouseUp'\r\n    'editor:random-terrain-generated': 'onRandomTerrainGenerated'\r\n\r\n  events:\r\n    'click #extant-thangs-filter button': 'onFilterExtantThangs'\r\n    'click #delete': 'onDeleteClicked'\r\n    'click #duplicate': 'onDuplicateClicked'\r\n    'click #thangs-container-toggle': 'toggleThangsContainer'\r\n    'click #thangs-palette-toggle': 'toggleThangsPalette'\r\n#    'click .add-thang-palette-icon': 'toggleThangsPalette'\r\n    'click #rotation-menu-item button': 'onClickRotationButton'\r\n\r\n  shortcuts:\r\n    'esc': 'selectAddThang'\r\n    'delete, del, backspace': 'deleteSelectedExtantThang'\r\n    'ctrl+z, +z': 'undo'\r\n    'ctrl+shift+z, +shift+z': 'redo'\r\n    'alt+c': 'toggleSelectedThangCollision'\r\n    'left': -> @moveSelectedThangBy -1, 0\r\n    'right': -> @moveSelectedThangBy 1, 0\r\n    'up': -> @moveSelectedThangBy 0, 1\r\n    'down': -> @moveSelectedThangBy 0, -1\r\n    'alt+left': -> @rotateSelectedThangTo Math.PI unless key.shift\r\n    'alt+right': -> @rotateSelectedThangTo 0 unless key.shift\r\n    'alt+up': -> @rotateSelectedThangTo -Math.PI / 2\r\n    'alt+down': -> @rotateSelectedThangTo Math.PI / 2\r\n    'alt+shift+left': -> @rotateSelectedThangBy Math.PI / 16\r\n    'alt+shift+right': -> @rotateSelectedThangBy -Math.PI / 16\r\n    'shift+left': -> @resizeSelectedThangBy -1, 0\r\n    'shift+right': -> @resizeSelectedThangBy 1, 0\r\n    'shift+up': -> @resizeSelectedThangBy 0, 1\r\n    'shift+down': -> @resizeSelectedThangBy 0, -1\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @world = options.world\r\n    @gameUIState = new GameUIState()\r\n    @listenTo(@gameUIState, 'sprite:mouse-down', @onSpriteMouseDown)\r\n    @listenTo(@gameUIState, 'surface:stage-mouse-move', @onStageMouseMove)\r\n    @listenTo(@gameUIState, 'change:selected', @onChangeSelected)\r\n\r\n    # should load depended-on Components, too\r\n    @thangTypes = @supermodel.loadCollection(new ThangTypeSearchCollection(), 'thangs').model\r\n    # just loading all Components for now: https://github.com/codecombat/codecombat/issues/405\r\n    @componentCollection = new LevelComponents([], {saveBackups: true})\r\n    @supermodel.trackRequest(@componentCollection.fetch())\r\n    @listenToOnce(@componentCollection, 'sync', ->\r\n      for component in @componentCollection.models\r\n        component.url = \"/db/level.component/#{component.get('original')}/version/#{component.get('version').major}\"\r\n        @supermodel.registerModel(component)\r\n    )\r\n    @level = options.level\r\n    @onThangsChanged = _.debounce(@onThangsChanged)\r\n\r\n    $(document).bind 'contextmenu', @preventDefaultContextMenu\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    return context unless @supermodel.finished()\r\n    for thangType in @thangTypes.models\r\n      thangType.notInLevel = true\r\n    thangTypes = (thangType.attributes for thangType in @supermodel.getModels(ThangType))\r\n    thangTypes = _.uniq thangTypes, false, 'original'\r\n    thangTypes = _.reject thangTypes, (tt) -> tt.kind in ['Mark', undefined]\r\n    groupMap = {}\r\n    for thangType in thangTypes\r\n      groupMap[thangType.kind] ?= []\r\n      groupMap[thangType.kind].push thangType\r\n\r\n    groups = []\r\n    for groupName in Object.keys(groupMap).sort()\r\n      someThangTypes = groupMap[groupName]\r\n      someThangTypes = _.sortBy someThangTypes, 'name'\r\n      group =\r\n        name: groupName\r\n        thangs: someThangTypes\r\n      groups.push group\r\n\r\n    context.thangTypes = thangTypes\r\n    context.groups = groups\r\n    context\r\n\r\n  undo: (e) ->\r\n    if not @editThangView then @thangsTreema.undo() else @editThangView.undo()\r\n\r\n  redo: (e) ->\r\n    if not @editThangView then @thangsTreema.redo() else @editThangView.redo()\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    $('.tab-content').mousedown @selectAddThang\r\n    $('#thangs-list').bind 'mousewheel', @preventBodyScrollingInThangList\r\n    @$el.find('#extant-thangs-filter button:first').button('toggle')\r\n    $(window).on 'resize', @onWindowResize\r\n    @addThangsView = @insertSubView new AddThangsView world: @world\r\n    @buildInterface() # refactor to not have this trigger when this view re-renders?\r\n    if _.keys(@thangsTreema.data).length\r\n      @$el.find('#canvas-overlay').css('display', 'none')\r\n\r\n  onFilterExtantThangs: (e) ->\r\n    @$el.find('#extant-thangs-filter button.active').button('toggle')\r\n    button = $(e.target).closest('button')\r\n    button.button('toggle')\r\n    val = button.val()\r\n    @thangsTreema.$el.removeClass(@lastHideClass) if @lastHideClass\r\n    @thangsTreema.$el.addClass(@lastHideClass = \"hide-except-#{val}\") if val\r\n\r\n  preventBodyScrollingInThangList: (e) ->\r\n    @scrollTop += (if e.deltaY < 0 then 1 else -1) * 30\r\n    e.preventDefault()\r\n\r\n  buildInterface: (e) ->\r\n    @level = e.level if e\r\n\r\n    data = $.extend(true, [], @level.attributes.thangs ? [])\r\n    thangsObject = @groupThangs(data)\r\n\r\n    schema = {\r\n      type: 'object'\r\n      format: 'thangs-folder'\r\n      additionalProperties: {\r\n        anyOf: [\r\n          {\r\n            type: 'object'\r\n            format: 'thang'\r\n            required: ['thangType', 'id']\r\n          }\r\n          { $ref: '#' }\r\n        ]\r\n      }\r\n    }\r\n\r\n    treemaOptions =\r\n      schema: schema\r\n      data: thangsObject\r\n      skipValidation: true\r\n      supermodel: @supermodel\r\n      callbacks:\r\n        change: @onThangsChanged\r\n        select: @onTreemaThangSelected\r\n        dblclick: @onTreemaThangDoubleClicked\r\n      readOnly: true\r\n      nodeClasses:\r\n        thang: ThangNode\r\n        'thangs-folder': ThangsFolderNode\r\n      world: @world\r\n\r\n    @thangsTreema = @$el.find('#thangs-treema').treema treemaOptions\r\n    @thangsTreema.build()\r\n    @thangsTreema.open()\r\n    @openSmallerFolders(@thangsTreema)\r\n\r\n    @onThangsChanged()  # Initialize the World with Thangs\r\n    @initSurface()\r\n    thangsHeaderHeight = $('#thangs-header').height()\r\n    oldHeight = $('#thangs-list').height()\r\n    $('#thangs-list').height(oldHeight - thangsHeaderHeight)\r\n    if data?.length\r\n      @$el.find('.generate-terrain-button').hide()\r\n\r\n  openSmallerFolders: (folderTreema) ->\r\n    children = _.values folderTreema.childrenTreemas\r\n    for child in children\r\n      continue if child.data.thangType\r\n      if _.keys(child.data).length < 5\r\n        child.open()\r\n        @openSmallerFolders(child)\r\n\r\n  initSurface: ->\r\n    webGLCanvas = $('canvas#webgl-surface', @$el)\r\n    normalCanvas = $('canvas#normal-surface', @$el)\r\n    @surface = new Surface(@world, normalCanvas, webGLCanvas, {\r\n      paths: false\r\n      coords: true\r\n      grid: true\r\n      navigateToSelection: false\r\n      thangTypes: @supermodel.getModels(ThangType)\r\n      showInvisible: true\r\n      frameRate: 15\r\n      levelType: @level.get 'type', true\r\n      @gameUIState\r\n      handleEvents: false\r\n    })\r\n    @surface.playing = false\r\n    @surface.setWorld @world\r\n    @surface.lankBoss.suppressSelectionSounds = true\r\n    @centerCamera()\r\n\r\n  centerCamera: ->\r\n    [width, height] = @world.size()\r\n    width = Math.max width, 80\r\n    height = Math.max height, 68\r\n    {left, top, right, bottom} = @world.getBounds()\r\n    center = x: left + width / 2, y: bottom + height / 2\r\n    sup = @surface.camera.worldToSurface center\r\n    zoom = 0.94 * 92.4 / width  # Zoom 1.0 lets us see 92.4 meters.\r\n    @surface.camera.zoomTo(sup, zoom, 0)\r\n\r\n  destroy: ->\r\n    @selectAddThangType null\r\n    @surface?.destroy()\r\n    $(window).off 'resize', @onWindowResize\r\n    $(document).unbind 'contextmenu', @preventDefaultContextMenu\r\n    @thangsTreema?.destroy()\r\n    super()\r\n\r\n  onViewSwitched: (e) ->\r\n    @selectAddThang null, true\r\n    @surface?.lankBoss?.selectLank null, null\r\n\r\n  onStageMouseDown: (e) ->\r\n    # initial values for a mouse click lifecycle\r\n    @dragged = 0\r\n    @willUnselectSprite = false\r\n    @gameUIState.set('canDragCamera', true)\r\n\r\n    if @addThangLank?.thangType.get('kind') is 'Wall'\r\n      @paintingWalls = true\r\n      @gameUIState.set('canDragCamera', false)\r\n\r\n    else if @addThangLank\r\n      # We clicked on the background when we had an add Thang selected, so add it\r\n      @addThang @addThangType, @addThangLank.thang.pos\r\n\r\n    else if e.onBackground\r\n      @gameUIState.set('selected', [])\r\n\r\n  onStageMouseMove: (e) ->\r\n    @dragged += 1\r\n\r\n  onStageMouseUp: (e) ->\r\n    @paintingWalls = false\r\n    $('#contextmenu').hide()\r\n\r\n  onSpriteMouseDown: (e) ->\r\n    nativeEvent = e.originalEvent.nativeEvent\r\n    # update selection\r\n    selected = []\r\n    if nativeEvent.metaKey or nativeEvent.ctrlKey\r\n      selected = _.clone(@gameUIState.get('selected'))\r\n    if e.thang?.isSelectable\r\n      alreadySelected = _.find(selected, (s) -> s.thang is e.thang)\r\n      if alreadySelected\r\n        # move to end (make it the last selected) and maybe unselect it\r\n        @willUnselectSprite = true\r\n        selected = _.without(selected, alreadySelected)\r\n      selected.push({ thang: e.thang, sprite: e.sprite, spellName: e.spellName })\r\n    if _.any(selected) and key.alt\r\n      # Clone selected thang instead of selecting it\r\n      lastSelected = _.last(selected)\r\n      @selectAddThangType lastSelected.thang.spriteName, lastSelected.thang\r\n      selected = []\r\n    @gameUIState.set('selected', selected)\r\n    if _.any(selected)\r\n      @gameUIState.set('canDragCamera', false)\r\n\r\n  onSpriteDragged: (e) ->\r\n    selected = @gameUIState.get('selected')\r\n    return unless _.any(selected) and @dragged > 10\r\n    @willUnselectSprite = false\r\n    {stageX, stageY} = e.originalEvent\r\n\r\n    # move the one under the mouse\r\n    lastSelected = _.last(selected)\r\n    cap = @surface.camera.screenToCanvas x: stageX, y: stageY\r\n    wop = @surface.camera.canvasToWorld cap\r\n    wop.z = lastSelected.thang.depth / 2\r\n    posBefore = _.clone(lastSelected.thang.pos)\r\n    @adjustThangPos lastSelected.sprite, lastSelected.thang, wop\r\n    posAfter = lastSelected.thang.pos\r\n\r\n    # move any others selected, proportionally to how the 'main' sprite moved\r\n    xDiff = posAfter.x - posBefore.x\r\n    yDiff = posAfter.y - posBefore.y\r\n    if xDiff or yDiff\r\n      for singleSelected in selected.slice(0, selected.length - 1)\r\n        newPos = {\r\n          x: singleSelected.thang.pos.x + xDiff\r\n          y: singleSelected.thang.pos.y + yDiff\r\n        }\r\n        @adjustThangPos singleSelected.sprite, singleSelected.thang, newPos\r\n\r\n    # move the camera if we're on the edge of the screen\r\n    [w, h] = [@surface.camera.canvasWidth, @surface.camera.canvasHeight]\r\n    sidebarWidths = ((if @$el.find(id).hasClass('hide') then 0 else (@$el.find(id).outerWidth() / @surface.camera.canvasScaleFactorX)) for id in ['#all-thangs', '#add-thangs-view'])\r\n    w -= sidebarWidth for sidebarWidth in sidebarWidths\r\n    cap.x -= sidebarWidths[0]\r\n    @calculateMovement(cap.x / w, cap.y / h, w / h)\r\n\r\n  onSpriteMouseUp: (e) ->\r\n    selected = @gameUIState.get('selected')\r\n    if e.originalEvent.nativeEvent.button == 2 and _.any(selected)\r\n      @onSpriteContextMenu e\r\n    clearInterval(@movementInterval) if @movementInterval?\r\n    @movementInterval = null\r\n\r\n    return unless _.any(selected)\r\n\r\n    for singleSelected in selected\r\n      pos = singleSelected.thang.pos\r\n\r\n      thang = _.find(@level.get('thangs') ? [], {id: singleSelected.thang.id})\r\n      path = \"#{@pathForThang(thang)}/components/original=#{LevelComponent.PhysicalID}\"\r\n      physical = @thangsTreema.get path\r\n      continue if not physical or (physical.config.pos.x is pos.x and physical.config.pos.y is pos.y)\r\n      @thangsTreema.set path + '/config/pos', x: pos.x, y: pos.y, z: pos.z\r\n\r\n    if @willUnselectSprite\r\n      clickedSprite = _.find(selected, {sprite: e.sprite})\r\n      @gameUIState.set('selected', _.without(selected, clickedSprite))\r\n\r\n  onSpriteDoubleClicked: (e) ->\r\n    return if @dragged > 10\r\n    return unless e.thang\r\n    @editThang thangID: e.thang.id\r\n\r\n  onRandomTerrainGenerated: (e) ->\r\n    @thangsBatch = []\r\n    @hush = true\r\n    nonRandomThangs = (thang for thang in @flattenThangs(@thangsTreema.data) when not /Random/.test thang.id)\r\n    @thangsTreema.set '', @groupThangs(nonRandomThangs)\r\n\r\n    listening = {}\r\n    for thang in e.thangs\r\n      @selectAddThangType thang.id\r\n\r\n      # kind of a hack to get the walls to show up correctly when they load.\r\n      # might also fix other thangs who need to show up looking a certain way based on thang type components\r\n      unless @addThangType.isFullyLoaded() or listening[@addThangType.cid]\r\n        listening[@addThangType.cid] = true\r\n        @listenToOnce @addThangType, 'build-complete', @onThangsChanged\r\n\r\n      @addThang @addThangType, thang.pos, true\r\n    @hush = false\r\n    @onThangsChanged()\r\n    @selectAddThangType null\r\n\r\n  onChangeSelected: (gameUIState, selected) ->\r\n    previousSprite = gameUIState.previousAttributes()?.selected?.sprite\r\n    sprite = selected?.sprite\r\n    thang = selected?.thang\r\n\r\n    previousSprite?.setNameLabel?(null) unless previousSprite is sprite\r\n\r\n    if thang and not (@addThangLank and @addThangType.get('name') in overlappableThangTypeNames)\r\n      # We clicked on a Thang (or its Treema), so select the Thang\r\n      @selectAddThang(null, true)\r\n      @selectedExtantThangClickTime = new Date()\r\n      # Show the label above selected thang, notice that we may get here from thang-edit-view, so it will be selected but no label\r\n      sprite.setNameLabel(sprite.thangType.get('name') + ': ' + thang.id)\r\n      sprite.updateLabels()\r\n      sprite.updateMarks()\r\n\r\n  justAdded: -> @lastAddTime and (new Date() - @lastAddTime) < 150\r\n\r\n  selectAddThang: (e, forceDeselect=false) =>\r\n    return if e? and $(e.target).closest('#thang-search').length # Ignore if you're trying to search thangs\r\n    return unless (e? and $(e.target).closest('#thangs-tab-view').length) or key.isPressed('esc') or forceDeselect\r\n    if e then target = $(e.target) else target = @$el.find('.add-thangs-palette')  # pretend to click on background if no event\r\n    return true if target.attr('id') is 'webgl-surface'\r\n    target = target.closest('.add-thang-palette-icon')\r\n    wasSelected = target.hasClass 'selected'\r\n    @$el.find('.add-thangs-palette .add-thang-palette-icon.selected').removeClass('selected')\r\n    @selectAddThangType(if wasSelected then null else target.attr 'data-thang-type') unless key.alt or key.meta\r\n    @addThangLank?.playSound? 'selected'\r\n    target.addClass('selected') if @addThangType\r\n\r\n  moveAddThangSelection: (direction) ->\r\n    return unless @addThangType\r\n    icons = $('.add-thangs-palette .add-thang-palette-icon')\r\n    selectedIcon = icons.filter('.selected')\r\n    selectedIndex = icons.index selectedIcon\r\n    nextSelectedIndex = (selectedIndex + direction + icons.length) % icons.length\r\n    @selectAddThang {target: icons[nextSelectedIndex]}\r\n\r\n  selectAddThangType: (type, @cloneSourceThang) ->\r\n    if _.isString type\r\n      type = _.find @supermodel.getModels(ThangType), (m) -> m.get('name') is type\r\n    pos = @addThangLank?.thang.pos  # Maintain old sprite's pos if we have it\r\n    @surface.lankBoss.removeLank @addThangLank if @addThangLank\r\n    @addThangType = type\r\n    if @addThangType\r\n      @surface.lankBoss.reallyStopMoving = true\r\n      thang = @createAddThang()\r\n      @addThangLank = @surface.lankBoss.addThangToLanks thang, @surface.lankBoss.layerAdapters['Floating']\r\n      @addThangLank.notOfThisWorld = true\r\n      @addThangLank.sprite.alpha = 0.75\r\n      pos ?= x: Math.round(@world.width / 2), y: Math.round(@world.height / 2)\r\n      @adjustThangPos @addThangLank, thang, pos\r\n    else\r\n      @addThangLank = null\r\n      @surface?.lankBoss.reallyStopMoving = false\r\n\r\n  createEssentialComponents: (defaultComponents) ->\r\n    physicalConfig = {pos: {x: 10, y: 10, z: 1}}\r\n    if physicalOriginal = _.find(defaultComponents ? [], original: LevelComponent.PhysicalID)\r\n      physicalConfig.pos.z = physicalOriginal.config?.pos?.z ? 1  # Get the z right\r\n    [\r\n      {original: LevelComponent.ExistsID, majorVersion: 0, config: {}}\r\n      {original: LevelComponent.PhysicalID, majorVersion: 0, config: physicalConfig}\r\n    ]\r\n\r\n  createAddThang: ->\r\n    allComponents = (lc.attributes for lc in @supermodel.getModels LevelComponent)\r\n    rawComponents = @addThangType.get('components') ? []\r\n    rawComponents = @createEssentialComponents() unless rawComponents.length\r\n    mockThang = {components: rawComponents}\r\n    @level.sortThangComponents [mockThang], allComponents\r\n    components = []\r\n    for raw in mockThang.components\r\n      comp = _.find allComponents, {original: raw.original}\r\n      continue if comp.name in ['Selectable', 'Attackable']  # Don't draw health bars or intercept clicks\r\n      componentClass = @world.loadClassFromCode comp.js, comp.name, 'component'\r\n      components.push [componentClass, raw.config]\r\n    thang = new Thang @world, @addThangType.get('name'), 'Add Thang Phantom'\r\n    thang.addComponents components...\r\n    thang\r\n\r\n  adjustThangPos: (sprite, thang, pos) ->\r\n    if key.shift\r\n      # Meter resolution when holding shift, not caring about thang size.\r\n      pos.x = Math.round pos.x\r\n      pos.y = Math.round pos.y\r\n    else\r\n      snap = sprite?.data?.snap or sprite?.thangType?.get('snap') or x: 0.01, y: 0.01  # Centimeter resolution by default\r\n      pos.x = Math.round((pos.x - (thang.width ? 1) / 2) / snap.x) * snap.x + (thang.width ? 1) / 2\r\n      pos.y = Math.round((pos.y - (thang.height ? 1) / 2) / snap.y) * snap.y + (thang.height ? 1) / 2\r\n    pos.z = thang.depth / 2\r\n    thang.pos = pos\r\n    thang.stateChanged = true\r\n    @surface.lankBoss.update true  # Make sure Obstacle layer resets cache\r\n\r\n  onSurfaceMouseMoved: (e) ->\r\n    return unless @addThangLank\r\n    wop = @surface.camera.screenToWorld x: e.x, y: e.y\r\n    wop.z = 0.5\r\n    @adjustThangPos @addThangLank, @addThangLank.thang, wop\r\n    if @paintingWalls\r\n      unless _.find @surface.lankBoss.lankArray, ((lank) =>\r\n        lank.thangType.get('kind') is 'Wall' and\r\n        Math.abs(lank.thang.pos.x - @addThangLank.thang.pos.x) < 2 and\r\n        Math.abs(lank.thang.pos.y - @addThangLank.thang.pos.y) < 2 and\r\n        lank isnt @addThangLank\r\n      )\r\n        @addThang @addThangType, @addThangLank.thang.pos\r\n        @lastAddTime = new Date()\r\n        @paintedWalls = true\r\n    null\r\n\r\n  onSurfaceMouseOver: (e) ->\r\n    return unless @addThangLank\r\n    @addThangLank.sprite.visible = true\r\n\r\n  onSurfaceMouseOut: (e) ->\r\n    return unless @addThangLank\r\n    @addThangLank.sprite.visible = false\r\n\r\n  calculateMovement: (pctX, pctY, widthHeightRatio) ->\r\n    MOVE_TOP_MARGIN = 1.0 - MOVE_MARGIN\r\n    if MOVE_TOP_MARGIN > pctX > MOVE_MARGIN and MOVE_TOP_MARGIN > pctY > MOVE_MARGIN\r\n      clearInterval(@movementInterval) if @movementInterval?\r\n      @movementInterval = null\r\n      return @moveLatitude = @moveLongitude = @speed = 0\r\n\r\n    # calculating speed to be 0.0 to 1.0 within the movement buffer on the outer edge\r\n    diff = (MOVE_MARGIN * 2) # comments are assuming MOVE_MARGIN is 0.1\r\n    @speed = Math.max(Math.abs(pctX-0.5), Math.abs(pctY-0.5)) * 2 # pct is now 0.8 - 1.0\r\n    @speed -= 1.0 - diff # 0.0 - 0.2\r\n    @speed *= (1.0 / diff) # 0.0 - 1.0\r\n    @speed *= MOVE_SPEED\r\n\r\n    @moveLatitude = pctX * 2 - 1\r\n    @moveLongitude = pctY * 2 - 1\r\n    @moveLongitude /= widthHeightRatio if widthHeightRatio > 1.0\r\n    @moveLatitude *= widthHeightRatio if widthHeightRatio < 1.0\r\n    @movementInterval = setInterval(@moveSide, 16) unless @movementInterval?\r\n\r\n  moveSide: =>\r\n    return unless @speed\r\n    c = @surface.camera\r\n    p = {x: c.target.x + @moveLatitude * @speed / c.zoom, y: c.target.y + @moveLongitude * @speed / c.zoom}\r\n    c.zoomTo(p, c.zoom, 0)\r\n\r\n  deleteSelectedExtantThang: (e) =>\r\n    return if $(e.target).hasClass 'treema-node'\r\n    selected = @gameUIState.get('selected')\r\n    return unless _.any(selected)\r\n\r\n    for singleSelected in selected\r\n      thang = @getThangByID(singleSelected.thang.id)\r\n      @thangsTreema.delete(@pathForThang(thang))\r\n      @deleteEmptyTreema(thang)\r\n      Thang.resetThangIDs()  # TODO: find some way to do this when we delete from treema, too\r\n    @gameUIState.set('selected', [])\r\n\r\n  deleteEmptyTreema: (thang)->\r\n    thangType = @supermodel.getModelByOriginal ThangType, thang.thangType\r\n    children = @thangsTreema.childrenTreemas\r\n    thangKind = children[thangType.get('kind', true)].data\r\n    thangName = thangKind[thangType.get('name', true)]\r\n    if Object.keys(thangName).length == 0\r\n      folderPath = [thangType.get('kind', true), thangType.get('name', true)].join('/')\r\n      @thangsTreema.delete(folderPath)\r\n      if Object.keys(thangKind).length == 0\r\n        folderPath = [thangType.get('kind', true)].join('/')\r\n        @thangsTreema.delete(folderPath)\r\n\r\n  groupThangs: (thangs) ->\r\n    # array of thangs -> foldered thangs\r\n    grouped = {}\r\n    for thang, index in thangs\r\n      path = @folderForThang(thang)\r\n      obj = grouped\r\n      for key in path\r\n        obj[key] ?= {}\r\n        obj = obj[key]\r\n      obj[thang.id] = thang\r\n      thang.index = index\r\n    grouped\r\n\r\n  folderForThang: (thang) ->\r\n    thangType = @supermodel.getModelByOriginal ThangType, thang.thangType\r\n    console.error 'uhh, we had kind', thangType.get('kind', true), 'for', thangType unless thangType.get('kind', true)\r\n    [thangType.get('kind', true), thangType.get('name', true)]\r\n\r\n  pathForThang: (thang) ->\r\n    folder = @folderForThang(thang)\r\n    folder.push thang.id\r\n    folder.join('/')\r\n\r\n  flattenThangs: (thangs) ->\r\n    # foldered thangs -> array of thangs\r\n    flattened = []\r\n    for key, value of thangs\r\n      if value.id? and value.thangType\r\n        flattened.push value\r\n      else\r\n        flattened = flattened.concat @flattenThangs(value)\r\n    flattened\r\n\r\n  populateFoldersForThang: (thang) ->\r\n    thangFolder = @folderForThang(thang)\r\n    prefix = ''\r\n    for segment in thangFolder\r\n      if prefix then prefix += '/'\r\n      prefix += segment\r\n      if not @thangsTreema.get(prefix) then @thangsTreema.set(prefix, {})\r\n\r\n  onThangsChanged: (skipSerialization) =>\r\n    return if @hush\r\n\r\n    # keep the thangs in the same order as before, roughly\r\n    thangs = @flattenThangs(@thangsTreema.data)\r\n    thangs = $.extend true, [], thangs\r\n    thangs = _.sortBy thangs, 'index'\r\n    delete thang.index for thang in thangs\r\n\r\n    @level.set 'thangs', thangs\r\n    return if @editThangView\r\n    return if skipSerialization\r\n    serializedLevel = @level.serialize {@supermodel, session: null, otherSession: null, headless: false, sessionless: true, cached: true}\r\n    try\r\n      @world.loadFromLevel serializedLevel, false\r\n    catch error\r\n      console.error 'Catastrophic error loading the level:', error\r\n    thang.isSelectable = not thang.isLand for thang in @world.thangs  # let us select walls and such\r\n    @surface?.setWorld @world\r\n    @surface?.lankBoss.cachedObstacles = false\r\n    @selectAddThangType @addThangType, @cloneSourceThang if @addThangType  # make another addThang sprite, since the World just refreshed\r\n\r\n    # update selection, since the thangs have been remade\r\n    selected = @gameUIState.get('selected')\r\n    if _.any(selected)\r\n      for singleSelected in selected\r\n        sprite = @surface.lankBoss.lanks[singleSelected.thang.id]\r\n        if sprite\r\n          sprite.updateMarks()\r\n          singleSelected.sprite = sprite\r\n          singleSelected.thang = sprite.thang\r\n    Backbone.Mediator.publish 'editor:thangs-edited', thangs: @world.thangs\r\n\r\n  onTreemaThangSelected: (e, selectedTreemas) =>\r\n    selectedThangTreemas = _.filter(selectedTreemas, (t) -> t instanceof ThangNode)\r\n    thangIDs = (node.data.id for node in selectedThangTreemas)\r\n    lanks = (@surface.lankBoss.lanks[thangID] for thangID in thangIDs when thangID)\r\n    selected = ({ thang: lank.thang, sprite: lank } for lank in lanks when lank)\r\n    @gameUIState.set('selected', selected)\r\n\r\n  onTreemaThangDoubleClicked: (e, treema) =>\r\n    nativeEvent = e.originalEvent.nativeEvent\r\n    return if nativeEvent and (nativeEvent.ctrlKey or nativeEvent.metaKey)\r\n    id = treema?.data?.id\r\n    @editThang thangID: id if id\r\n\r\n  getThangByID: (id) -> _.find(@level.get('thangs') ? [], {id: id})\r\n\r\n  addThang: (thangType, pos, batchInsert=false) ->\r\n    @$el.find('.generate-terrain-button').hide()\r\n    if batchInsert\r\n      if thangType.get('name') is 'Hero Placeholder'\r\n        thangID = 'Hero Placeholder'\r\n        return if not @level.isType('hero', 'hero-ladder', 'hero-coop', 'course', 'course-ladder', 'game-dev', 'web-dev') or @getThangByID(thangID)\r\n      else\r\n        thangID = \"Random #{thangType.get('name')} #{@thangsBatch.length}\"\r\n    else\r\n      thangID = Thang.nextID(thangType.get('name'), @world) until thangID and not @getThangByID(thangID)\r\n    if @cloneSourceThang\r\n      components = _.cloneDeep @getThangByID(@cloneSourceThang.id).components\r\n    else if @level.isType('hero', 'hero-ladder', 'hero-coop', 'course', 'course-ladder', 'game-dev', 'web-dev')\r\n      components = []  # Load them all from default ThangType Components\r\n    else\r\n      components = _.cloneDeep thangType.get('components') ? []\r\n    components = @createEssentialComponents(thangType.get('components')) unless components.length\r\n    physical = _.find components, (c) -> c.config?.pos?\r\n    physical.config.pos = x: pos.x, y: pos.y, z: physical.config.pos.z if physical\r\n    thang = thangType: thangType.get('original'), id: thangID, components: components\r\n    if batchInsert\r\n      @thangsBatch.push thang\r\n    @populateFoldersForThang(thang)\r\n    @thangsTreema.set(@pathForThang(thang), thang)\r\n\r\n  editThang: (e) ->\r\n    if e.target  # click event\r\n      thangData = $(e.target).data 'thang-data'\r\n    else  # Mediator event\r\n      thangData = @getThangByID(e.thangID)\r\n    return unless thangData\r\n    @editThangView = new LevelThangEditView thangData: thangData, level: @level, world: @world, supermodel: @supermodel, oldPath: @pathForThang(thangData)  # supermodel needed for checkForMissingSystems\r\n    @insertSubView @editThangView\r\n    @$el.find('>').hide()\r\n    @editThangView.$el.show()\r\n    Backbone.Mediator.publish 'editor:view-switched', {}\r\n\r\n  onLevelThangDoneEditing: (e) ->\r\n    @removeSubView @editThangView\r\n    @editThangView = null\r\n    @updateEditedThang e.thangData, e.oldPath\r\n    @$el.find('>').show()\r\n\r\n  onLevelThangEdited: (e) ->\r\n    @updateEditedThang e.thangData, e.oldPath\r\n\r\n  updateEditedThang: (newThang, oldPath) ->\r\n    @hush = true\r\n    @thangsTreema.delete oldPath\r\n    @populateFoldersForThang(newThang)\r\n    @thangsTreema.set(@pathForThang(newThang), newThang)\r\n    @hush = false\r\n    @onThangsChanged()\r\n\r\n  preventDefaultContextMenu: (e) ->\r\n    return unless $(e.target).closest('#canvas-wrapper').length\r\n    e.preventDefault()\r\n\r\n  onSpriteContextMenu: (e) ->\r\n    {clientX, clientY} = e.originalEvent.nativeEvent\r\n    if @addThangType\r\n      $('#duplicate a').html $.i18n.t 'editor.stop_duplicate'\r\n    else\r\n      $('#duplicate a').html $.i18n.t 'editor.duplicate'\r\n    $('#contextmenu').css { position: 'fixed', left: clientX, top: clientY }\r\n    $('#contextmenu').show()\r\n\r\n  #- Context menu callbacks\r\n\r\n  onDeleteClicked: (e) ->\r\n    $('#contextmenu').hide()\r\n    @deleteSelectedExtantThang e\r\n\r\n  onDuplicateClicked: (e) ->\r\n    $('#contextmenu').hide()\r\n    selected = _.last(@gameUIState.get('selected'))\r\n    @selectAddThangType(selected.thang.spriteName, selected.thang)\r\n\r\n  onClickRotationButton: (e) ->\r\n    $('#contextmenu').hide()\r\n    rotation = parseFloat($(e.target).closest('button').data('rotation'))\r\n    @rotateSelectedThangTo rotation * Math.PI\r\n\r\n  modifySelectedThangComponentConfig: (thang, componentOriginal, modificationFunction) ->\r\n    return unless thang\r\n    @hush = true\r\n    thangData = @getThangByID thang.id\r\n    thangData = $.extend true, {}, thangData\r\n    component = _.find thangData.components, {original: componentOriginal}\r\n    unless component\r\n      component = original: componentOriginal, config: {}, majorVersion: 0\r\n      thangData.components.push component\r\n    modificationFunction component\r\n    @thangsTreema.set @pathForThang(thangData), thangData\r\n    @hush = false\r\n    @onThangsChanged true\r\n    thang.stateChanged = true\r\n    lank = @surface.lankBoss.lanks[thang.id]\r\n    lank.update true\r\n    lank.marks.debug?.destroy()\r\n    delete lank.marks.debug\r\n    lank.setDebug true\r\n\r\n  rotateSelectedThangTo: (radians) ->\r\n    for singleSelected in @gameUIState.get('selected')\r\n      selectedThang = singleSelected.thang\r\n      @modifySelectedThangComponentConfig selectedThang, LevelComponent.PhysicalID, (component) =>\r\n        component.config.rotation = radians\r\n        selectedThang.rotation = component.config.rotation\r\n\r\n  rotateSelectedThangBy: (radians) ->\r\n    for singleSelected in @gameUIState.get('selected')\r\n      selectedThang = singleSelected.thang\r\n      @modifySelectedThangComponentConfig selectedThang, LevelComponent.PhysicalID, (component) =>\r\n        component.config.rotation = ((component.config.rotation ? 0) + radians) % (2 * Math.PI)\r\n        selectedThang.rotation = component.config.rotation\r\n\r\n  moveSelectedThangBy: (xDir, yDir) ->\r\n    for singleSelected in @gameUIState.get('selected')\r\n      selectedThang = singleSelected.thang\r\n      @modifySelectedThangComponentConfig selectedThang, LevelComponent.PhysicalID, (component) =>\r\n        component.config.pos.x += 0.5 * xDir\r\n        component.config.pos.y += 0.5 * yDir\r\n        selectedThang.pos.x = component.config.pos.x\r\n        selectedThang.pos.y = component.config.pos.y\r\n\r\n  resizeSelectedThangBy: (xDir, yDir) ->\r\n    for singleSelected in @gameUIState.get('selected')\r\n      selectedThang = singleSelected.thang\r\n      @modifySelectedThangComponentConfig selectedThang, LevelComponent.PhysicalID, (component) =>\r\n        component.config.width = (component.config.width ? 4) + 0.5 * xDir\r\n        component.config.height = (component.config.height ? 4) + 0.5 * yDir\r\n        selectedThang.width = component.config.width\r\n        selectedThang.height = component.config.height\r\n\r\n  toggleSelectedThangCollision: ->\r\n    for singleSelected in @gameUIState.get('selected')\r\n      selectedThang = singleSelected.thang\r\n      @modifySelectedThangComponentConfig selectedThang, LevelComponent.CollidesID, (component) =>\r\n        component.config ?= {}\r\n        component.config.collisionCategory = if component.config.collisionCategory is 'none' then 'ground' else 'none'\r\n        selectedThang.collisionCategory = component.config.collisionCategory\r\n\r\n  toggleThangsContainer: (e) ->\r\n    $('#all-thangs').toggleClass('hide')\r\n\r\n  toggleThangsPalette: (e) ->\r\n    $('#add-thangs-view').toggleClass('hide')\r\n\r\nclass ThangsFolderNode extends TreemaNode.nodeMap.object\r\n  valueClass: 'treema-thangs-folder'\r\n  nodeDescription: 'Thang'\r\n  @nameToThangTypeMap: null\r\n\r\n  getTrackedActionDescription: (trackedAction) ->\r\n    trackedActionDescription = super(trackedAction)\r\n    if trackedActionDescription is 'Edit ' + @nodeDescription\r\n      path = trackedAction.path.split '/'\r\n      if path[path.length-1] is 'pos'\r\n        trackedActionDescription = 'Move Thang'\r\n    trackedActionDescription\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    el = $(\"<span><strong>#{@keyForParent}</strong> <span class='text-muted'>(#{@countThangs(data)})</span></span>\")\r\n\r\n    # Kind of like having the portraits on the individual thang rows, rather than the parent folder row\r\n    # but keeping this logic here in case we want to have it the other way.\r\n#    if thangType = @nameToThangType(@keyForParent)\r\n#      el.prepend($(\"<img class='img-circle' src='#{thangType.getPortraitURL()}' />\"))\r\n    valEl.append(el)\r\n\r\n  countThangs: (data) ->\r\n    return 0 if data.thangType and data.id?\r\n    num = 0\r\n    for key, value of data\r\n      if value.thangType and value.id?\r\n        num += 1\r\n      else\r\n        num += @countThangs(value)\r\n    num\r\n\r\n  nameToThangType: (name) ->\r\n    if not ThangsFolderNode.nameToThangTypeMap\r\n      thangTypes = @settings.supermodel.getModels(ThangType)\r\n      map = {}\r\n      map[thangType.get('name')] = thangType for thangType in thangTypes\r\n      ThangsFolderNode.nameToThangTypeMap = map\r\n    ThangsFolderNode.nameToThangTypeMap[name]\r\n\r\nclass ThangNode extends TreemaObjectNode\r\n  valueClass: 'treema-thang'\r\n  collection: false\r\n  @thangNameMap: {}\r\n  @thangKindMap: {}\r\n  buildValueForDisplay: (valEl, data) ->\r\n    pos = _.find(data.components, (c) -> c.config?.pos?)?.config.pos  # TODO: hack\r\n    s = data.id\r\n    if pos\r\n      s += \" (#{Math.round(pos.x)}, #{Math.round(pos.y)})\"\r\n    else\r\n      s += ' (non-physical)'\r\n    @buildValueForDisplaySimply valEl, s\r\n\r\n    thangType = @settings.supermodel.getModelByOriginal(ThangType, data.thangType)\r\n    if thangType\r\n      valEl.prepend($(\"<img class='img-circle' src='#{thangType.getPortraitURL()}' />\"))\r\n\r\n  onEnterPressed: ->\r\n    Backbone.Mediator.publish 'editor:edit-level-thang', thangID: @getData().id\r\n","WorldSelectModal = require './modals/WorldSelectModal'\r\nThangType = require '/models/ThangType'\r\nLevelComponent = require 'models/LevelComponent'\r\nCocoCollection = require 'collections/CocoCollection'\r\nrequire 'vendor/treema'\r\n\r\nmakeButton = -> $('<a class=\"btn btn-primary btn-xs treema-map-button\"><span class=\"glyphicon glyphicon-screenshot\"></span></a>')\r\nshorten = (f) -> parseFloat(f.toFixed(1))\r\nWIDTH = 924\r\n\r\nmodule.exports.WorldPointNode = class WorldPointNode extends TreemaNode.nodeMap.point2d\r\n  constructor: (args...) ->\r\n    super(args...)\r\n    console.error 'Point Treema node needs a World included in the settings.' unless @settings.world?\r\n    console.error 'Point Treema node needs a RootView included in the settings.' unless @settings.view?\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  onClick: (e) ->\r\n    btn = $(e.target).closest('.treema-map-button')\r\n    if btn.length then @openMap() else super(arguments...)\r\n\r\n  openMap: ->\r\n    modal = new WorldSelectModal(world: @settings.world, dataType: 'point', default: @getData(), supermodel: @settings.supermodel)\r\n    modal.callback = @callback\r\n    @settings.view.openModalView modal\r\n\r\n  callback: (e) =>\r\n    return unless e?.point?\r\n    @data.x = shorten(e.point.x)\r\n    @data.y = shorten(e.point.y)\r\n    @refreshDisplay()\r\n\r\nclass WorldRegionNode extends TreemaNode.nodeMap.object\r\n  # this class is not yet used, later will be used to configure the Physical component\r\n\r\n  constructor: (args...) ->\r\n    super(args...)\r\n    console.error 'Region Treema node needs a World included in the settings.' unless @settings.world?\r\n    console.error 'Region Treema node needs a RootView included in the settings.' unless @settings.view?\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  onClick: (e) ->\r\n    btn = $(e.target).closest('.treema-map-button')\r\n    if btn.length then @openMap() else super(arguments...)\r\n\r\n  openMap: ->\r\n    modal = new WorldSelectModal(world: @settings.world, dataType: 'region', default: @createWorldBounds(), supermodel: @settings.supermodel)\r\n    modal.callback = @callback\r\n    @settings.view.openModalView modal\r\n\r\n  callback: (e) =>\r\n    x = Math.min e.points[0].x, e.points[1].x\r\n    y = Math.min e.points[0].y, e.points[1].y\r\n    @data.pos = {x: x, y: y, z: 0}\r\n    @data.width = Math.abs e.points[0].x - e.points[1].x\r\n    @data.height = Math.min e.points[0].y - e.points[1].y\r\n    @refreshDisplay()\r\n\r\n  createWorldBounds: ->\r\n    # not yet written\r\n\r\nmodule.exports.WorldViewportNode = class WorldViewportNode extends TreemaNode.nodeMap.object\r\n  # selecting ratio'd dimensions in the world, ie the camera in level scripts\r\n  constructor: (args...) ->\r\n    super(args...)\r\n    console.error 'Viewport Treema node needs a World included in the settings.' unless @settings.world?\r\n    console.error 'Viewport Treema node needs a RootView included in the settings.' unless @settings.view?\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  onClick: (e) ->\r\n    btn = $(e.target).closest('.treema-map-button')\r\n    if btn.length then @openMap() else super(arguments...)\r\n\r\n  openMap: ->\r\n    # can't really get the bounds from this data, so will have to hack this solution\r\n    options = world: @settings.world, dataType: 'ratio-region'\r\n    data = @getData()\r\n    options.defaultFromZoom = data if data?.target?.x?\r\n    options.supermodel = @settings.supermodel\r\n    modal = new WorldSelectModal(options)\r\n    modal.callback = @callback\r\n    @settings.view.openModalView modal\r\n\r\n  callback: (e) =>\r\n    return unless e\r\n    target = {\r\n      x: shorten((e.points[0].x + e.points[1].x) / 2)\r\n      y: shorten((e.points[0].y + e.points[1].y) / 2)\r\n    }\r\n    @set('target', target)\r\n    bounds = e.camera.normalizeBounds(e.points)\r\n    @set('zoom', shorten(WIDTH / bounds.width))\r\n    @refreshDisplay()\r\n\r\nmodule.exports.WorldBoundsNode = class WorldBoundsNode extends TreemaNode.nodeMap.array\r\n  # selecting camera boundaries for a world\r\n  dataType: 'region'\r\n\r\n  constructor: (args...) ->\r\n    super(args...)\r\n    console.error 'Bounds Treema node needs a World included in the settings.' unless @settings.world?\r\n    console.error 'Bounds Treema node needs a RootView included in the settings.' unless @settings.view?\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('.treema-shortened').prepend(makeButton())\r\n\r\n  onClick: (e) ->\r\n    btn = $(e.target).closest('.treema-map-button')\r\n    if btn.length then @openMap() else super(arguments...)\r\n\r\n  openMap: ->\r\n    bounds = @getData() or [{x: 0, y: 0}, {x: 100, y: 80}]\r\n    modal = new WorldSelectModal(world: @settings.world, dataType: 'region', default: bounds, supermodel: @settings.supermodel)\r\n    modal.callback = @callback\r\n    @settings.view.openModalView modal\r\n\r\n  callback: (e) =>\r\n    return unless e\r\n    @set '/0', {x: shorten(e.points[0].x), y: shorten(e.points[0].y)}\r\n    @set '/1', {x: shorten(e.points[1].x), y: shorten(e.points[1].y)}\r\n\r\nmodule.exports.ThangNode = class ThangNode extends TreemaNode.nodeMap.string\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('input').autocomplete(source: @settings.thangIDs, minLength: 0, delay: 0, autoFocus: true)\r\n    valEl\r\n\r\nmodule.exports.TeamNode = class TeamNode extends TreemaNode.nodeMap.string\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('input').autocomplete(source: @settings.teams, minLength: 0, delay: 0, autoFocus: true)\r\n    valEl\r\n\r\nmodule.exports.SuperteamNode = class SuperteamNode extends TreemaNode.nodeMap.string\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.find('input').autocomplete(source: @settings.superteams, minLength: 0, delay: 0, autoFocus: true)\r\n    valEl\r\n\r\nmodule.exports.RadiansNode = class RadiansNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    deg = data / Math.PI * 180\r\n    valEl.text valEl.text() + \"rad (#{deg.toFixed(0)})\"\r\n\r\nmodule.exports.MetersNode = class MetersNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 'm'\r\n\r\nmodule.exports.KilogramsNode = class KilogramsNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 'kg'\r\n\r\nmodule.exports.SecondsNode = class SecondsNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 's'\r\n\r\nmodule.exports.MillisecondsNode = class MillisecondsNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 'ms'\r\n\r\nmodule.exports.SpeedNode = class SpeedNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 'm/s'\r\n\r\nmodule.exports.AccelerationNode = class AccelerationNode extends TreemaNode.nodeMap.number\r\n  buildValueForDisplay: (valEl, data) ->\r\n    super(valEl, data)\r\n    valEl.text valEl.text() + 'm/s^2'\r\n\r\nmodule.exports.ThangTypeNode = class ThangTypeNode extends TreemaNode.nodeMap.string\r\n  valueClass: 'treema-thang-type'\r\n  @thangTypes: null\r\n  @thangTypesCollection: null\r\n\r\n  constructor: (args...) ->\r\n    super args...\r\n    data = @getData()\r\n    @thangType = _.find @settings.supermodel.getModels(ThangType), (m) => m.get('original') is data if data\r\n\r\n  buildValueForDisplay: (valEl) ->\r\n    @buildValueForDisplaySimply(valEl, @thangType?.get('name') or 'None')\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    thangTypeNames = (m.get('name') for m in @settings.supermodel.getModels ThangType)\r\n    input = valEl.find('input').autocomplete(source: thangTypeNames, minLength: 0, delay: 0, autoFocus: true)\r\n    input.val(@thangType?.get('name') or 'None')\r\n    valEl\r\n\r\n  saveChanges: ->\r\n    thangTypeName = @$el.find('input').val()\r\n    @thangType = _.find @settings.supermodel.getModels(ThangType), (m) -> m.get('name') is thangTypeName\r\n    if @thangType\r\n      @data = @thangType.get('original')\r\n    else\r\n      @data = null\r\n\r\nmodule.exports.ThangTypeNode = ThangTypeNode = class ThangTypeNode extends TreemaNode.nodeMap.string\r\n  valueClass: 'treema-thang-type'\r\n  @thangTypesCollection: null  # Lives in ThangTypeNode parent class\r\n  @thangTypes: null  # Lives in ThangTypeNode or subclasses\r\n\r\n  constructor: ->\r\n    super(arguments...)\r\n    @getThangTypes()\r\n    unless ThangTypeNode.thangTypesCollection.loaded\r\n      f = -> \r\n        @refreshDisplay() unless @isEditing()\r\n        @getThangTypes()\r\n      ThangTypeNode.thangTypesCollection.once('sync', f, @)\r\n\r\n  buildValueForDisplay: (valEl, data) ->\r\n    @buildValueForDisplaySimply(valEl, @getCurrentThangType() or '')\r\n    valEl\r\n\r\n  buildValueForEditing: (valEl, data) ->\r\n    super(valEl, data)\r\n    input = valEl.find 'input'\r\n    source = (req, res) =>\r\n      { term } = req\r\n      term = term.toLowerCase()\r\n      return res([]) unless @constructor.thangTypes\r\n      return res(thangType.name for thangType in @constructor.thangTypes when _.string.contains(thangType.name.toLowerCase(), term))\r\n    input.autocomplete(source: source, minLength: 0, delay: 0, autoFocus: true)\r\n    input.val(@getCurrentThangType() or '')\r\n    valEl\r\n\r\n  filterThangType: (thangType) -> true\r\n\r\n  getCurrentThangType: ->\r\n    return null unless @constructor.thangTypes\r\n    return null unless original = @getData()\r\n    thangType = _.find @constructor.thangTypes, { original: original }\r\n    thangType?.name or '...'\r\n\r\n  getThangTypes: ->\r\n    if ThangTypeNode.thangTypesCollection\r\n      if not @constructor.thangTypes\r\n        @processThangTypes(ThangTypeNode.thangTypesCollection)\r\n      return\r\n    ThangTypeNode.thangTypesCollection = new CocoCollection([], {\r\n      url: '/db/thang.type'\r\n      project:['name', 'components', 'original']\r\n      model: ThangType\r\n    })\r\n    res = ThangTypeNode.thangTypesCollection.fetch()\r\n    ThangTypeNode.thangTypesCollection.once 'sync', => @processThangTypes(ThangTypeNode.thangTypesCollection)\r\n\r\n  processThangTypes: (thangTypeCollection) ->\r\n    @constructor.thangTypes = []\r\n    @processThangType thangType for thangType in thangTypeCollection.models\r\n\r\n  processThangType: (thangType) ->\r\n    @constructor.thangTypes.push name: thangType.get('name'), original: thangType.get('original')\r\n\r\n  saveChanges: ->\r\n    thangTypeName = @$el.find('input').val()\r\n    thangType = _.find(@constructor.thangTypes, {name: thangTypeName})\r\n    return @remove() unless thangType\r\n    @data = thangType.original\r\n\r\nmodule.exports.ItemThangTypeNode = ItemThangTypeNode = class ItemThangTypeNode extends ThangTypeNode\r\n  valueClass: 'treema-item-thang-type'\r\n\r\n  filterThangType: (thangType) ->\r\n    @keyForParent in thangType.slots\r\n\r\n  processThangType: (thangType) ->\r\n    return unless itemComponent = _.find thangType.get('components'), {original: LevelComponent.ItemID}\r\n    @constructor.thangTypes.push name: thangType.get('name'), original: thangType.get('original'), slots: itemComponent.config?.slots ? ['right-hand']\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/modal/new-model-modal'\r\nforms = require 'core/forms'\r\n\r\nmodule.exports = class NewModelModal extends ModalView\r\n  id: 'new-model-modal'\r\n  template: template\r\n  plain: false\r\n\r\n  events:\r\n    'click button.new-model-submit': 'onModelSubmitted'\r\n    'submit form': 'onModelSubmitted'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @modelClass = options.model\r\n    @modelLabel = options.modelLabel\r\n    @newModelTitle = \"editor.new_#{_.string.slugify @modelLabel}_title\"\r\n    @properties = options.properties\r\n\r\n  makeNewModel: ->\r\n    model = new @modelClass\r\n    name = @$el.find('#name').val()\r\n    model.set('name', name)\r\n    if @modelClass.name is 'Level'\r\n      model.set('tasks', @modelClass.schema.default.tasks)\r\n    if model.schema().properties.permissions\r\n      model.set 'permissions', [{access: 'owner', target: me.id}]\r\n    model.set(key, prop) for key, prop of @properties if @properties?\r\n    model\r\n\r\n  onModelSubmitted: (e) ->\r\n    e.preventDefault()\r\n    model = @makeNewModel()\r\n    res = model.save(null, {type: 'POST'})  # Override PUT so we can trigger postFirstVersion logic if needed\r\n    return unless res\r\n\r\n    forms.clearFormAlerts @$el\r\n    @showLoading(@$el.find('.modal-body'))\r\n    res.error =>\r\n      @hideLoading()\r\n      forms.applyErrorsToForm(@$el, JSON.parse(res.responseText))\r\n      #Backbone.Mediator.publish 'model-save-fail', model\r\n    res.success =>\r\n      @$el.modal('hide')\r\n      @trigger 'model-created', model\r\n      #Backbone.Mediator.publish 'model-save-success', model\r\n\r\n  afterInsert: ->\r\n    super()\r\n    _.delay (=> @$el?.find('#name').focus()), 500\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/modal/save-version-modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\nPatch = require 'models/Patch'\r\nforms = require 'core/forms'\r\n\r\nmodule.exports = class SaveVersionModal extends ModalView\r\n  id: 'save-version-modal'\r\n  template: template\r\n  plain: true\r\n  modalWidthPercent: 60\r\n\r\n  events:\r\n    'click #save-version-button': 'saveChanges'\r\n    'click #cla-link': 'onClickCLALink'\r\n    'click #agreement-button': 'onAgreedToCLA'\r\n    'click #submit-patch-button': 'submitPatch'\r\n    'submit form': 'onSubmitForm'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @model = options.model or options.level\r\n    @isPatch = not @model.hasWriteAccess()\r\n    @hasChanges = @model.hasLocalChanges()\r\n\r\n  afterRender: (insertDeltaView=true) ->\r\n    super()\r\n    @$el.find(if me.get('signedCLA') then '#accept-cla-wrapper' else '#save-version-button').hide()\r\n    changeEl = @$el.find('.changes-stub')\r\n    if insertDeltaView\r\n      try\r\n        deltaView = new DeltaView({model: @model})\r\n        @insertSubView(deltaView, changeEl)\r\n      catch e\r\n        console.error 'Couldn\\'t create delta view:', e, e.stack\r\n    @$el.find('.commit-message input').attr('placeholder', $.i18n.t('general.commit_msg'))\r\n\r\n  onSubmitForm: (e) ->\r\n    e.preventDefault()\r\n    if @isPatch then @submitPatch() else @saveChanges()\r\n\r\n  saveChanges: ->\r\n    @trigger 'save-new-version', {\r\n      major: @$el.find('#major-version').prop('checked')\r\n      commitMessage: @$el.find('#commit-message').val()\r\n    }\r\n\r\n  submitPatch: ->\r\n    @savingPatchError = false\r\n    forms.clearFormAlerts @$el\r\n    patch = new Patch()\r\n    patch.set 'delta', @model.getDelta()\r\n    patch.set 'commitMessage', @$el.find('#commit-message').val()\r\n    patch.set 'target', {\r\n      'collection': _.string.underscored @model.constructor.className\r\n      'id': @model.id\r\n    }\r\n    errors = patch.validate()\r\n    forms.applyErrorsToForm(@$el, errors) if errors\r\n    res = patch.save()\r\n    return unless res\r\n    @enableModalInProgress(@$el)\r\n\r\n    res.error (jqxhr) =>\r\n      @disableModalInProgress(@$el)\r\n      @savingPatchError = jqxhr.responseJSON?.message or 'Unknown error.'\r\n      @renderSelectors '.save-error-area'\r\n\r\n    res.success =>\r\n      @hide()\r\n\r\n  onClickCLALink: ->\r\n    window.open('/cla', 'cla', 'height=800,width=900')\r\n\r\n  onAgreedToCLA: ->\r\n    @$el.find('#agreement-button').text('Saving').prop('disabled', true)\r\n    $.ajax({\r\n      url: '/db/user/me/agreeToCLA'\r\n      method: 'POST'\r\n      success: @onAgreeSucceeded\r\n      error: @onAgreeFailed\r\n    })\r\n\r\n  onAgreeSucceeded: =>\r\n    @$el.find('#agreement-button').text('Thanks!')\r\n    @$el.find('#save-version-button').show()\r\n\r\n  onAgreeFailed: =>\r\n    @$el.find('#agreement-button').text('Failed').prop('disabled', false)\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/modal/versions-modal'\r\nDeltaView = require 'views/editor/DeltaView'\r\nPatchModal = require 'views/editor/PatchModal'\r\nnameLoader = require 'core/NameLoader'\r\nCocoCollection = require 'collections/CocoCollection'\r\ndeltasLib = require 'core/deltas'\r\n\r\nclass VersionsViewCollection extends CocoCollection\r\n  url: ''\r\n  model: null\r\n\r\n  initialize: (@url, @levelID, @model) ->\r\n    super()\r\n    @url = @url + @levelID + '/versions'\r\n\r\nmodule.exports = class VersionsModal extends ModalView\r\n  template: template\r\n  plain: true\r\n  modalWidthPercent: 80\r\n\r\n  # needs to be overwritten by child\r\n  id: ''\r\n  url: ''\r\n  page: ''\r\n\r\n  events:\r\n    'change input.select': 'onSelectionChanged'\r\n\r\n  constructor: (options, @ID, @model) ->\r\n    super options\r\n    @original = new @model(_id: @ID)\r\n    @original = @supermodel.loadModel(@original).model\r\n    @listenToOnce(@original, 'sync', @onViewSync)\r\n\r\n  onViewSync: ->\r\n    @versions = new VersionsViewCollection(@url, @original.attributes.original, @model)\r\n    @versions = @supermodel.loadCollection(@versions, 'versions').model\r\n    @listenTo(@versions, 'sync', @onVersionsFetched)\r\n\r\n  onVersionsFetched: ->\r\n    ids = (p.get('creator') for p in @versions.models)\r\n    jqxhrOptions = nameLoader.loadNames ids\r\n    @supermodel.addRequestResource('user_names', jqxhrOptions).load() if jqxhrOptions\r\n\r\n  onSelectionChanged: ->\r\n    rows = @$el.find 'input.select:checked'\r\n    deltaEl = @$el.find '.delta-view'\r\n    @removeSubView(@deltaView) if @deltaView\r\n    @deltaView = null\r\n    if rows.length isnt 2 then return\r\n\r\n    laterVersion = new @model(_id: $(rows[0]).val())\r\n    earlierVersion = new @model(_id: $(rows[1]).val())\r\n    @deltaView = new DeltaView({\r\n      model: earlierVersion\r\n      comparisonModel: laterVersion\r\n      skipPaths: deltasLib.DOC_SKIP_PATHS\r\n      loadModels: true\r\n    })\r\n    @insertSubView(@deltaView, deltaEl)\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.page = @page\r\n    if @versions\r\n      context.dataList = (m.attributes for m in @versions.models)\r\n      for version in context.dataList\r\n        version.creator = nameLoader.getName(version.creator)\r\n    context\r\n","RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/poll/poll-edit-view'\r\nPoll = require 'models/Poll'\r\nUserPollsRecord = require 'models/UserPollsRecord'\r\nPollModal = require 'views/play/modal/PollModal'\r\nConfirmModal = require 'views/core/ConfirmModal'\r\nPatchesView = require 'views/editor/PatchesView'\r\nerrors = require 'core/errors'\r\napp = require 'core/application'\r\n\r\nrequire 'game-libraries'\r\n\r\nmodule.exports = class PollEditView extends RootView\r\n  id: 'editor-poll-edit-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #save-button': 'savePoll'\r\n    'click #delete-button': 'confirmDeletion'\r\n\r\n  constructor: (options, @pollID) ->\r\n    super options\r\n    @loadPoll()\r\n    @loadUserPollsRecord()\r\n    @pushChangesToPreview = _.throttle(@pushChangesToPreview, 500)\r\n\r\n  loadPoll: ->\r\n    @poll = new Poll _id: @pollID\r\n    @poll.saveBackups = true\r\n    @supermodel.loadModel @poll\r\n\r\n  loadUserPollsRecord: ->\r\n    url = \"/db/user.polls.record/-/user/#{me.id}\"\r\n    @userPollsRecord = new UserPollsRecord().setURL url\r\n    onRecordSync = ->\r\n      return if @destroyed\r\n      @userPollsRecord.url = -> '/db/user.polls.record/' + @id\r\n    @listenToOnce @userPollsRecord, 'sync', onRecordSync\r\n    @userPollsRecord = @supermodel.loadModel(@userPollsRecord).model\r\n    onRecordSync.call @ if @userPollsRecord.loaded\r\n\r\n  onLoaded: ->\r\n    super()\r\n    @buildTreema()\r\n    @listenTo @poll, 'change', =>\r\n      @poll.updateI18NCoverage()\r\n      @treema.set('/', @poll.attributes)\r\n\r\n  buildTreema: ->\r\n    return if @treema? or (not @poll.loaded) or (not me.isAdmin())\r\n    data = $.extend(true, {}, @poll.attributes)\r\n    options =\r\n      data: data\r\n      filePath: \"db/poll/#{@poll.get('_id')}\"\r\n      schema: Poll.schema\r\n      readOnly: me.get('anonymous')\r\n      callbacks:\r\n        change: => @pushChangesToPreview() unless @hush\r\n    @treema = @$el.find('#poll-treema').treema(options)\r\n    @treema.build()\r\n    @treema.childrenTreemas.answers?.open 1\r\n    @pushChangesToPreview()\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @pushChangesToPreview()\r\n    @patchesView = @insertSubView(new PatchesView(@poll), @$el.find('.patches-view'))\r\n    @patchesView.load()\r\n\r\n  pushChangesToPreview: =>\r\n    return unless @treema\r\n    @$el.find('#poll-view').empty()\r\n    for key, value of @treema.data\r\n      @poll.set key, value\r\n    @pollModal?.destroy()\r\n    @pollModal = new PollModal supermodel: @supermodel, poll: @poll, userPollsRecord: @userPollsRecord\r\n    @pollModal.render()\r\n    $('#poll-view').empty().append @pollModal.el\r\n    #pollModal.afterInsert()  # This blurs the active input; don't do it\r\n    @pollModal.$el.removeClass('modal fade').show()\r\n    @pollModal.on 'vote-updated', =>\r\n      @hush = true\r\n      @treema.set '/answers', @pollModal.poll.get('answers')\r\n      @hush = false\r\n\r\n  savePoll: (e) ->\r\n    @treema.endExistingEdits()\r\n    for key, value of @treema.data\r\n      @poll.set(key, value)\r\n\r\n    res = @poll.save()\r\n\r\n    res.error (collection, response, options) =>\r\n      console.error response\r\n\r\n    res.success =>\r\n      url = \"/editor/poll/#{@poll.get('slug') or @poll.id}\"\r\n      document.location.href = url\r\n\r\n  confirmDeletion: ->\r\n    renderData =\r\n      title: 'Are you really sure?'\r\n      body: 'This will completely delete the poll, potentially breaking a lot of stuff you don\\'t want breaking. Are you entirely sure?'\r\n      decline: 'Not really'\r\n      confirm: 'Definitely'\r\n\r\n    confirmModal = new ConfirmModal renderData\r\n    confirmModal.on 'confirm', @deletePoll\r\n    @openModalView confirmModal\r\n\r\n  deletePoll: =>\r\n    console.debug 'deleting'\r\n    $.ajax\r\n      type: 'DELETE'\r\n      success: ->\r\n        noty\r\n          timeout: 5000\r\n          text: 'Aaaand it\\'s gone.'\r\n          type: 'success'\r\n          layout: 'topCenter'\r\n        _.delay ->\r\n          app.router.navigate '/editor/poll', trigger: true\r\n        , 500\r\n      error: (jqXHR, status, error) ->\r\n        console.error jqXHR\r\n        timeout: 5000\r\n        text: \"Deleting poll failed with error code #{jqXHR.status}\"\r\n        type: 'error'\r\n        layout: 'topCenter'\r\n      url: \"/db/poll/#{@poll.id}\"\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class PollSearchView extends SearchView\r\n  id: 'editor-poll-home-view'\r\n  modelLabel: 'Poll'\r\n  model: require 'models/Poll'\r\n  modelURL: '/db/poll'\r\n  tableTemplate: require 'templates/editor/poll/poll-search-table'\r\n  projection: ['name', 'description', 'slug', 'priority', 'created']\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.poll_title'\r\n    context.currentNew = 'editor.new_poll_title'\r\n    context.currentNewSignup = 'editor.new_poll_title_login'\r\n    context.currentSearch = 'editor.poll_search_title'\r\n    context.newModelsAdminOnly = true\r\n    context.unauthorized = true unless me.isAdmin()\r\n    context\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/thang/export-thang-type-modal'\r\nSpriteExporter = require 'lib/sprites/SpriteExporter'\r\n\r\nmodule.exports = class ExportThangTypeModal extends ModalView\r\n  id: \"export-thang-type-modal\"\r\n  template: template\r\n  plain: true\r\n\r\n  events:\r\n    'click #save-btn': 'onClickSaveButton'\r\n\r\n  initialize: (options, @thangType) ->\r\n    @builder = null\r\n    @getFilename = _.once(@getFilename)\r\n\r\n  colorMap: {\r\n    red: { hue: 0, saturation: 0.75, lightness: 0.5 }\r\n    blue: { hue: 0.66, saturation: 0.75, lightness: 0.5 }\r\n    green: { hue: 0.33, saturation: 0.75, lightness: 0.5 }\r\n  }\r\n  getColorLabel: -> @$('#color-config-select').val()\r\n  getColorConfig: ->\r\n    color = @colorMap[@getColorLabel()]\r\n    return { team: color } if color\r\n    return null\r\n  getActionNames: -> _.map @$('input[name=\"action\"]:checked'), (el) -> $(el).val()\r\n  getResolutionFactor: -> parseInt(@$('#resolution-input').val()) or SPRITE_RESOLUTION_FACTOR\r\n  getFilename: -> 'spritesheet-'+_.string.slugify(moment().format())+'.png'\r\n  getSpriteType: -> @$('input[name=\"sprite-type\"]:checked').val()\r\n\r\n  onClickSaveButton: ->\r\n    @$('.modal-footer button').addClass('hide')\r\n    @$('.modal-footer .progress').removeClass('hide')\r\n    @$('input, select').attr('disabled', true)\r\n    options = {\r\n      resolutionFactor: @getResolutionFactor()\r\n      actionNames: @getActionNames()\r\n      colorConfig: @getColorConfig()\r\n      spriteType: @getSpriteType()\r\n    }\r\n    @exporter = new SpriteExporter(@thangType, options)\r\n    @exporter.build()\r\n    @listenToOnce @exporter, 'build', @onExporterBuild\r\n\r\n  onExporterBuild: (e) ->\r\n    @spriteSheet = e.spriteSheet\r\n    src = @spriteSheet._images[0].toDataURL()\r\n    src = src.replace('data:image/png;base64,', '').replace(/\\ /g, '+')\r\n    body =\r\n      filename: @getFilename()\r\n      mimetype: 'image/png'\r\n      path: \"db/thang.type/#{@thangType.get('original')}\"\r\n      b64png: src\r\n    $.ajax('/file', {type: 'POST', data: body, success: @onSpriteSheetUploaded})\r\n\r\n  onSpriteSheetUploaded: =>\r\n    spriteSheetData = {\r\n      actionNames: @getActionNames()\r\n      animations: @spriteSheet._data\r\n      frames: ([\r\n        f.rect.x\r\n        f.rect.y\r\n        f.rect.width\r\n        f.rect.height\r\n        0\r\n        f.regX\r\n        f.regY\r\n      ] for f in @spriteSheet._frames)\r\n      image: \"db/thang.type/#{@thangType.get('original')}/\"+@getFilename()\r\n      resolutionFactor: @getResolutionFactor()\r\n      spriteType: @getSpriteType()\r\n    }\r\n    if config = @getColorConfig()\r\n      spriteSheetData.colorConfig = config\r\n    if label = @getColorLabel()\r\n      spriteSheetData.colorLabel = label\r\n    spriteSheets = _.clone(@thangType.get('prerenderedSpriteSheetData') or [])\r\n    spriteSheets.push(spriteSheetData)\r\n    @thangType.set('prerenderedSpriteSheetData', spriteSheets)\r\n    @thangType.save()\r\n    @listenToOnce @thangType, 'sync', @hide\r\n\r\nwindow.SomeModal = module.exports","CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/editor/thang/colors_tab'\r\nSpriteBuilder = require 'lib/sprites/SpriteBuilder'\r\n{hexToHSL} = require 'core/utils'\r\nrequire 'vendor/treema'\r\n\r\nmodule.exports = class ThangTypeColorsTabView extends CocoView\r\n  id: 'editor-thang-colors-tab-view'\r\n  template: template\r\n  className: 'tab-pane'\r\n\r\n  offset: 0\r\n\r\n  constructor: (@thangType, options) ->\r\n    super options\r\n    @supermodel.loadModel @thangType\r\n    @colorConfig = {hue: 0, saturation: 0.5, lightness: 0.5}\r\n    @spriteBuilder = new SpriteBuilder(@thangType) if @thangType.get('raw')\r\n    f = =>\r\n      @offset++\r\n      @updateMovieClip()\r\n    @interval = setInterval f, 1000\r\n\r\n  destroy: ->\r\n    @colorGroups?.destroy()\r\n    clearInterval @interval\r\n    super()\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @createShapeButtons()\r\n    @initStage()\r\n    @initSliders()\r\n    @tryToBuild()\r\n\r\n  # sliders\r\n\r\n  initSliders: ->\r\n    @hueSlider = @initSlider $('#hue-slider', @$el), 0, @makeSliderCallback 'hue'\r\n    @saturationSlider = @initSlider $('#saturation-slider', @$el), 50, @makeSliderCallback 'saturation'\r\n    @lightnessSlider = @initSlider $('#lightness-slider', @$el), 50, @makeSliderCallback 'lightness'\r\n\r\n  makeSliderCallback: (property) ->\r\n    (e, result) =>\r\n      @colorConfig[property] = result.value / 100\r\n      @updateMovieClip()\r\n\r\n  # movie clip\r\n\r\n  initStage: ->\r\n    canvas = @$el.find('#tinting-display')\r\n    @stage = new createjs.Stage(canvas[0])\r\n    createjs.Ticker.setFPS 20\r\n    createjs.Ticker.addEventListener('tick', @stage)\r\n    @updateMovieClip()\r\n\r\n  updateMovieClip: ->\r\n    return unless @currentColorGroupTreema and @thangType.get('raw')\r\n    actionDict = @thangType.getActions()\r\n    animations = (a.animation for key, a of actionDict when a.animation)\r\n    index = @offset % animations.length\r\n    animation = animations[index]\r\n    return @updateContainer() unless animation\r\n    @stage.removeChild(@movieClip) if @movieClip\r\n    options = {colorConfig: {}}\r\n    options.colorConfig[@currentColorGroupTreema.keyForParent] = @colorConfig\r\n    @spriteBuilder.setOptions options\r\n    @spriteBuilder.buildColorMaps()\r\n    @movieClip = @spriteBuilder.buildMovieClip animation\r\n    bounds = @movieClip.frameBounds?[0] ? @movieClip.nominalBounds\r\n    larger = Math.min(400 / bounds.width, 400 / bounds.height)\r\n    @movieClip.scaleX = larger\r\n    @movieClip.scaleY = larger\r\n    @movieClip.regX = bounds.x\r\n    @movieClip.regY = bounds.y\r\n    @stage.addChild @movieClip\r\n\r\n  updateContainer: ->\r\n    return unless @thangType.get('raw')\r\n    actionDict = @thangType.getActions()\r\n    idle = actionDict.idle\r\n    @stage.removeChild(@container) if @container\r\n    return unless idle?.container\r\n    options = {colorConfig: {}}\r\n    options.colorConfig[@currentColorGroupTreema.keyForParent] = @colorConfig\r\n    @spriteBuilder.setOptions options\r\n    @spriteBuilder.buildColorMaps()\r\n    @container = @spriteBuilder.buildContainerFromStore idle.container\r\n    larger = Math.min(400 / @container.bounds.width, 400 / @container.bounds.height)\r\n    @container.scaleX = larger\r\n    @container.scaleY = larger\r\n    @container.regX = @container.bounds.x\r\n    @container.regY = @container.bounds.y\r\n    @stage.addChild @container\r\n\r\n  createShapeButtons: ->\r\n    buttons = $('<div></div>').prop('id', 'shape-buttons')\r\n    shapes = (shape for key, shape of @thangType.get('raw')?.shapes or {})\r\n    colors = (s.fc for s in shapes when s.fc?)\r\n    colors = _.uniq(colors)\r\n    colors.sort (a, b) ->\r\n      aHSL = hexToHSL(a)\r\n      bHSL = hexToHSL(b)\r\n      if aHSL[0] > bHSL[0] then -1 else 1\r\n\r\n    for color in colors\r\n      button = $('<button></button>').addClass('btn')\r\n      button.css('background', color)\r\n      button.val color\r\n      buttons.append(button)\r\n    buttons.click (e) =>\r\n      $(e.target).toggleClass('selected')\r\n      @updateColorGroup()\r\n    @$el.find('#shape-buttons').replaceWith(buttons)\r\n    @buttons = buttons\r\n\r\n  tryToBuild: ->\r\n    return unless @thangType.loaded\r\n    data = @thangType.get('colorGroups')\r\n    data ?= {}\r\n    schema = @thangType.schema().properties?.colorGroups\r\n    treemaOptions =\r\n      data: data\r\n      schema: schema\r\n      readOnly: true unless me.isAdmin() or @thangType.hasWriteAccess(me)\r\n      callbacks:\r\n        change: @onColorGroupsChanged\r\n        select: @onColorGroupSelected\r\n      nodeClasses:\r\n        'thang-color-group': ColorGroupNode\r\n    @colorGroups = @$el.find('#color-groups-treema').treema treemaOptions\r\n    @colorGroups.build()\r\n    @colorGroups.open()\r\n    keys = Object.keys @colorGroups.childrenTreemas\r\n    @colorGroups.childrenTreemas[keys[0]]?.$el.click() if keys[0]\r\n\r\n  onColorGroupsChanged: =>\r\n    @thangType.set('colorGroups', @colorGroups.data)\r\n    Backbone.Mediator.publish 'editor:thang-type-color-groups-changed', colorGroups: @colorGroups.data\r\n\r\n  onColorGroupSelected: (e, selected) =>\r\n    @$el.find('#color-group-settings').toggle selected.length > 0\r\n    treema = @colorGroups.getLastSelectedTreema()\r\n    return unless treema\r\n    @currentColorGroupTreema = treema\r\n\r\n    shapes = {}\r\n    shapes[shape] = true for shape in treema.data\r\n\r\n    colors = {}\r\n    for key, shape of @thangType.get('raw')?.shapes or {}\r\n      continue unless shape.fc?\r\n      colors[shape.fc] = true if shapes[key]\r\n\r\n    @buttons.find('button').removeClass('selected')\r\n    @buttons.find('button').each (i, button) ->\r\n      $(button).addClass('selected') if colors[$(button).val()]\r\n\r\n    @updateMovieClip()\r\n\r\n  updateColorGroup: ->\r\n    colors = {}\r\n    @buttons.find('button').each (i, button) ->\r\n      return unless $(button).hasClass('selected')\r\n      colors[$(button).val()] = true\r\n\r\n    shapes = []\r\n    for key, shape of @thangType.get('raw')?.shapes or {}\r\n      continue unless shape.fc?\r\n      shapes.push(key) if colors[shape.fc]\r\n\r\n    @currentColorGroupTreema.set('/', shapes)\r\n    @updateMovieClip()\r\n\r\nclass ColorGroupNode extends TreemaNode.nodeMap.array\r\n  collection: false\r\n  canAddChild: -> false\r\n","ThangType = require 'models/ThangType'\r\nSpriteParser = require 'lib/sprites/SpriteParser'\r\nSpriteBuilder = require 'lib/sprites/SpriteBuilder'\r\nLank = require 'lib/surface/Lank'\r\nLayerAdapter = require 'lib/surface/LayerAdapter'\r\nCamera = require 'lib/surface/Camera'\r\nDocumentFiles = require 'collections/DocumentFiles'\r\nrequire 'vendor/treema'\r\n\r\n# in the template, but need to require to load them\r\nrequire 'views/modal/RevertModal'\r\n\r\nRootView = require 'views/core/RootView'\r\nThangComponentsEditView = require 'views/editor/component/ThangComponentsEditView'\r\nThangTypeVersionsModal = require './ThangTypeVersionsModal'\r\nThangTypeColorsTabView = require './ThangTypeColorsTabView'\r\nPatchesView = require 'views/editor/PatchesView'\r\nForkModal = require 'views/editor/ForkModal'\r\nVectorIconSetupModal = require 'views/editor/thang/VectorIconSetupModal'\r\nSaveVersionModal = require 'views/editor/modal/SaveVersionModal'\r\ntemplate = require 'templates/editor/thang/thang-type-edit-view'\r\nstorage = require 'core/storage'\r\nExportThangTypeModal = require './ExportThangTypeModal'\r\n\r\nrequire 'game-libraries'\r\n\r\nCENTER = {x: 200, y: 400}\r\n\r\ncommonTasks = [\r\n  'Upload the art.'\r\n  'Set up the vector icon.'\r\n]\r\n\r\ndisplayedThangTypeTasks = [\r\n  'Configure the idle action.'\r\n  'Configure the positions (registration point, etc.).'\r\n  'Set shadow diameter to 0 if needed.'\r\n  'Set scale to 0.3, 0.5, or whatever is appropriate.'\r\n  'Set rotation to isometric if needed.'\r\n  'Set accurate Physical size, shape, and default z.'\r\n  'Set accurate Collides collision information if needed.'\r\n  'Double-check that fixedRotation is accurate, if it collides.'\r\n]\r\n\r\nanimatedThangTypeTasks = displayedThangTypeTasks.concat [\r\n  'Configure the non-idle actions.'\r\n  'Configure any per-action registration points needed.'\r\n  'Add flipX per action if needed to face to the right.'\r\n  'Make sure any death and attack actions do not loop.'\r\n  'Add defaultSimlish if needed.'\r\n  'Add selection sounds if needed.'\r\n  'Add per-action sound triggers.'\r\n  'Add team color groups.'\r\n]\r\n\r\ncontainerTasks = displayedThangTypeTasks.concat [\r\n  'Select viable terrains if not universal.'\r\n  'Set Exists stateless: true if needed.'\r\n]\r\n\r\npurchasableTasks = [\r\n  'Add a tier, or 10 + desired tier if not ready yet.'\r\n  'Add a gem cost.'\r\n  'Write a description.'\r\n  'Click the Populate i18n button.'\r\n]\r\n\r\ndefaultTasks =\r\n  Unit: commonTasks.concat animatedThangTypeTasks.concat [\r\n    'Start a new name category in names.coffee if needed.'\r\n    'Set to Allied to correct team (ogres, humans, or neutral).'\r\n    'Add AutoTargetsNearest or FightsBack if needed.'\r\n    'Add other Components like Shoots or Casts if needed.'\r\n    'Configure other Components, like Moves, Attackable, Attacks, etc.'\r\n    'Override the HasAPI type if it will not be correctly inferred.'\r\n    'Add to Existence System power table.'\r\n  ]\r\n  Hero: commonTasks.concat animatedThangTypeTasks.concat purchasableTasks.concat [\r\n    'Set the hero class.'\r\n    'Add Extended Hero Name.'\r\n    'Upload Hero Doll Images.'\r\n    'Upload Pose Image.'\r\n    'Start a new name category in names.coffee.'\r\n    'Set up hero stats in Equips, Attackable, Moves.'\r\n    'Set Collects collectRange to 2, Sees visualRange to 60.'\r\n    'Add any custom hero abilities.'\r\n    'Add to ThangType model hard-coded hero ids/classes list.'\r\n    'Add to LevelHUDView hard-coded hero short names list.'\r\n    'Add to InventoryView hard-coded hero gender list.'\r\n    'Add to PlayHeroesModal hard-coded hero positioning logic.'\r\n    'Add as unlock to a level and add unlockLevelName here.'\r\n  ]\r\n  Floor: commonTasks.concat containerTasks.concat [\r\n    'Add 10 x 8.5 snapping.'\r\n    'Set fixed rotation.'\r\n    'Make sure everything is scaled to tile perfectly.'\r\n    'Adjust SingularSprite floor scale list if necessary.'\r\n  ]\r\n  Wall: commonTasks.concat containerTasks.concat [\r\n    'Add 4x4 snapping.'\r\n    'Set fixed rotation.'\r\n    'Set up and tune complicated wall-face actions.'\r\n    'Make sure everything is scaled to tile perfectly.'\r\n  ]\r\n  Doodad: commonTasks.concat containerTasks.concat [\r\n    'Add to GenerateTerrainModal logic if needed.'\r\n  ]\r\n  Misc: commonTasks.concat [\r\n    'Add any misc tasks for this misc ThangType.'\r\n  ]\r\n  Mark: commonTasks.concat [\r\n    'Check the animation framerate.'\r\n    'Double-check that bottom of mark is just touching registration point.'\r\n  ]\r\n  Item: commonTasks.concat purchasableTasks.concat [\r\n    'Set the hero class if class-specific.'\r\n    'Upload Paper Doll Images.'\r\n    'Configure item stats and abilities.'\r\n  ]\r\n  Missile: commonTasks.concat animatedThangTypeTasks.concat [\r\n    'Make sure there is a launch sound trigger.'\r\n    'Make sure there is a hit sound trigger.'\r\n    'Make sure there is a die animation.'\r\n    'Add Arrow, Shell, Beam, or other missile Component.'\r\n    'Choose Missile.leadsShots and Missile.shootsAtGround.'\r\n    'Choose Moves.maxSpeed and other config.'\r\n    'Choose Expires.lifespan config if needed.'\r\n    'Set spriteType: singular if needed for proper rendering.'\r\n    'Add HasAPI if the missile should show up in findEnemyMissiles.'\r\n  ]\r\n\r\nmodule.exports = class ThangTypeEditView extends RootView\r\n  id: 'thang-type-edit-view'\r\n  className: 'editor'\r\n  template: template\r\n  resolution: 4\r\n  scale: 3\r\n  mockThang:\r\n    health: 10.0\r\n    maxHealth: 10.0\r\n    hudProperties: ['health']\r\n    acts: true\r\n\r\n  events:\r\n    'click #clear-button': 'clearRawData'\r\n    'click #upload-button': -> @$el.find('input#real-upload-button').click()\r\n    'click #set-vector-icon': 'onClickSetVectorIcon'\r\n    'change #real-upload-button': 'animationFileChosen'\r\n    'change #animations-select': 'showAnimation'\r\n    'click #marker-button': 'toggleDots'\r\n    'click #stop-button': 'stopAnimation'\r\n    'click #play-button': 'playAnimation'\r\n    'click #history-button': 'showVersionHistory'\r\n    'click li:not(.disabled) > #fork-start-button': 'startForking'\r\n    'click #save-button': 'openSaveModal'\r\n    'click #patches-tab': -> @patchesView.load()\r\n    'click .play-with-level-button': 'onPlayLevel'\r\n    'click .play-with-level-parent': 'onPlayLevelSelect'\r\n    'keyup .play-with-level-input': 'onPlayLevelKeyUp'\r\n    'click li:not(.disabled) > #pop-level-i18n-button': 'onPopulateLevelI18N'\r\n    'mousedown #canvas': 'onCanvasMouseDown'\r\n    'mouseup #canvas': 'onCanvasMouseUp'\r\n    'mousemove #canvas': 'onCanvasMouseMove'\r\n    'click #export-sprite-sheet-btn': 'onClickExportSpriteSheetButton'\r\n\r\n  onClickSetVectorIcon: ->\r\n    modal = new VectorIconSetupModal({}, @thangType)\r\n    @openModalView modal\r\n    modal.once 'done', => @treema.set('/', @getThangData())\r\n\r\n  subscriptions:\r\n    'editor:thang-type-color-groups-changed': 'onColorGroupsChanged'\r\n\r\n  # init / render\r\n\r\n  constructor: (options, @thangTypeID) ->\r\n    super options\r\n    @mockThang = $.extend(true, {}, @mockThang)\r\n    @thangType = new ThangType(_id: @thangTypeID)\r\n    @thangType = @supermodel.loadModel(@thangType).model\r\n    @thangType.saveBackups = true\r\n    @listenToOnce @thangType, 'sync', ->\r\n      @files = @supermodel.loadCollection(new DocumentFiles(@thangType), 'files').model\r\n      @updateFileSize()\r\n#    @refreshAnimation = _.debounce @refreshAnimation, 500\r\n\r\n  showLoading: ($el) ->\r\n    $el ?= @$el.find('.outer-content')\r\n    super($el)\r\n\r\n  getRenderData: (context={}) ->\r\n    context = super(context)\r\n    context.thangType = @thangType\r\n    context.animations = @getAnimationNames()\r\n    context.authorized = not me.get('anonymous')\r\n    context.recentlyPlayedLevels = storage.load('recently-played-levels') ? ['items']\r\n    context.fileSizeString = @fileSizeString\r\n    context\r\n\r\n  getAnimationNames: ->\r\n    _.sortBy _.keys(@thangType.get('actions') or {}), (a) ->\r\n      {move: 1, cast: 2, attack: 3, idle: 4, portrait: 6}[a] or 5\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    @initStage()\r\n    @buildTreema()\r\n    @initSliders()\r\n    @initComponents()\r\n    @insertSubView(new ThangTypeColorsTabView(@thangType))\r\n    @patchesView = @insertSubView(new PatchesView(@thangType), @$el.find('.patches-view'))\r\n    @showReadOnly() if me.get('anonymous')\r\n    @updatePortrait()\r\n\r\n  initComponents: =>\r\n    options =\r\n      components: @thangType.get('components') ? []\r\n      supermodel: @supermodel\r\n\r\n    @thangComponentEditView = new ThangComponentsEditView options\r\n    @listenTo @thangComponentEditView, 'components-changed', @onComponentsChanged\r\n    @insertSubView @thangComponentEditView\r\n\r\n  onComponentsChanged: (components) =>\r\n    @thangType.set 'components', components\r\n\r\n  onColorGroupsChanged: (e) ->\r\n    @temporarilyIgnoringChanges = true\r\n    @treema.set 'colorGroups', e.colorGroups\r\n    @temporarilyIgnoringChanges = false\r\n\r\n  makeDot: (color) ->\r\n    circle = new createjs.Shape()\r\n    circle.graphics.beginFill(color).beginStroke('black').drawCircle(0, 0, 5)\r\n    circle.scaleY = 0.2\r\n    circle.scaleX = 0.5\r\n    circle\r\n\r\n  initStage: ->\r\n    canvas = @$el.find('#canvas')\r\n    @stage = new createjs.Stage(canvas[0])\r\n    @layerAdapter = new LayerAdapter({name:'Default', webGL: true})\r\n    @topLayer = new createjs.Container()\r\n\r\n    @layerAdapter.container.x = @topLayer.x = CENTER.x\r\n    @layerAdapter.container.y = @topLayer.y = CENTER.y\r\n    @stage.addChild(@layerAdapter.container, @topLayer)\r\n    @listenTo @layerAdapter, 'new-spritesheet', @onNewSpriteSheet\r\n    @camera?.destroy()\r\n    @camera = new Camera canvas\r\n\r\n    @torsoDot = @makeDot('blue')\r\n    @mouthDot = @makeDot('yellow')\r\n    @aboveHeadDot = @makeDot('green')\r\n    @groundDot = @makeDot('red')\r\n    @topLayer.addChild(@groundDot, @torsoDot, @mouthDot, @aboveHeadDot)\r\n    @updateGrid()\r\n    _.defer @refreshAnimation\r\n    @toggleDots(false)\r\n\r\n    createjs.Ticker.setFPS(30)\r\n    createjs.Ticker.addEventListener('tick', @stage)\r\n\r\n  toggleDots: (newShowDots) ->\r\n    @showDots = if typeof(newShowDots) is 'boolean' then newShowDots else not @showDots\r\n    @updateDots()\r\n\r\n  updateDots: ->\r\n    @topLayer.removeChild(@torsoDot, @mouthDot, @aboveHeadDot, @groundDot)\r\n    return unless @currentLank\r\n    return unless @showDots\r\n    torso = @currentLank.getOffset 'torso'\r\n    mouth = @currentLank.getOffset 'mouth'\r\n    aboveHead = @currentLank.getOffset 'aboveHead'\r\n    @torsoDot.x = torso.x\r\n    @torsoDot.y = torso.y\r\n    @mouthDot.x = mouth.x\r\n    @mouthDot.y = mouth.y\r\n    @aboveHeadDot.x = aboveHead.x\r\n    @aboveHeadDot.y = aboveHead.y\r\n    @topLayer.addChild(@groundDot, @torsoDot, @mouthDot, @aboveHeadDot)\r\n\r\n  stopAnimation: ->\r\n    @currentLank?.queueAction('idle')\r\n\r\n  playAnimation: ->\r\n    @currentLank?.queueAction(@$el.find('#animations-select').val())\r\n\r\n  updateGrid: ->\r\n    grid = new createjs.Container()\r\n    line = new createjs.Shape()\r\n    width = 1000\r\n    line.graphics.beginFill('#666666').drawRect(-width/2, -0.5, width, 0.5)\r\n\r\n    line.x = CENTER.x\r\n    line.y = CENTER.y\r\n    y = line.y\r\n    step = 10 * @scale\r\n    y -= step while y > 0\r\n    while y < 500\r\n      y += step\r\n      newLine = line.clone()\r\n      newLine.y = y\r\n      grid.addChild(newLine)\r\n\r\n    x = line.x\r\n    x -= step while x > 0\r\n    while x < 400\r\n      x += step\r\n      newLine = line.clone()\r\n      newLine.x = x\r\n      newLine.rotation = 90\r\n      grid.addChild(newLine)\r\n\r\n    @stage.removeChild(@grid) if @grid\r\n    @stage.addChildAt(grid, 0)\r\n    @grid = grid\r\n\r\n  updateSelectBox: ->\r\n    names = @getAnimationNames()\r\n    select = @$el.find('#animations-select')\r\n    return if select.find('option').length is names.length\r\n    select.empty()\r\n    select.append($('<option></option>').text(name)) for name in names\r\n\r\n  # upload\r\n\r\n  animationFileChosen: (e) ->\r\n    @file = e.target.files[0]\r\n    return unless @file\r\n    return unless _.string.endsWith @file.type, 'javascript'\r\n#    @$el.find('#upload-button').prop('disabled', true)\r\n    @reader = new FileReader()\r\n    @reader.onload = @onFileLoad\r\n    @reader.readAsText(@file)\r\n\r\n  onFileLoad: (e) =>\r\n    result = @reader.result\r\n    parser = new SpriteParser(@thangType)\r\n    parser.parse(result)\r\n    @treema.set('raw', @thangType.get('raw'))\r\n    @updateSelectBox()\r\n    @refreshAnimation()\r\n    @updateFileSize()\r\n\r\n  updateFileSize: ->\r\n    file = JSON.stringify(@thangType.attributes)\r\n    compressed = LZString.compress(file)\r\n    size = (file.length / 1024).toFixed(1) + \"KB\"\r\n    compressedSize = (compressed.length / 1024).toFixed(1) + \"KB\"\r\n    gzipCompressedSize = compressedSize * 1.65  # just based on comparing ogre barracks\r\n    @fileSizeString = \"Size: #{size} (~#{compressedSize} gzipped)\"\r\n    @$el.find('#thang-type-file-size').text @fileSizeString\r\n\r\n  # animation select\r\n\r\n  refreshAnimation: =>\r\n    @thangType.resetSpriteSheetCache()\r\n    return @showRasterImage() if @thangType.get('raster')\r\n    options = @getLankOptions()\r\n    console.log 'refresh animation....'\r\n    @showAnimation()\r\n    @updatePortrait()\r\n\r\n  showRasterImage: ->\r\n    lank = new Lank(@thangType, @getLankOptions())\r\n    @showLank(lank)\r\n    @updateScale()\r\n\r\n  onNewSpriteSheet: ->\r\n    $('#spritesheets').empty()\r\n    for image in @layerAdapter.spriteSheet._images\r\n      $('#spritesheets').append(image)\r\n    @layerAdapter.container.x = CENTER.x\r\n    @layerAdapter.container.y = CENTER.y\r\n    @updateScale()\r\n\r\n  showAnimation: (animationName) ->\r\n    animationName = @$el.find('#animations-select').val() unless _.isString animationName\r\n    return unless animationName\r\n    @mockThang.action = animationName\r\n    @showAction(animationName)\r\n    @updateRotation()\r\n    @updateScale() # must happen after update rotation, because updateRotation calls the sprite update() method.\r\n\r\n  showMovieClip: (animationName) ->\r\n    vectorParser = new SpriteBuilder(@thangType)\r\n    movieClip = vectorParser.buildMovieClip(animationName)\r\n    return unless movieClip\r\n    reg = @thangType.get('positions')?.registration\r\n    if reg\r\n      movieClip.regX = -reg.x\r\n      movieClip.regY = -reg.y\r\n    scale = @thangType.get('scale')\r\n    if scale\r\n      movieClip.scaleX = movieClip.scaleY = scale\r\n    @showSprite(movieClip)\r\n\r\n  getLankOptions: -> {resolutionFactor: @resolution, thang: @mockThang, preloadSounds: false}\r\n\r\n  showAction: (actionName) ->\r\n    options = @getLankOptions()\r\n    lank = new Lank(@thangType, options)\r\n    @showLank(lank)\r\n    lank.queueAction(actionName)\r\n\r\n  updatePortrait: ->\r\n    options = @getLankOptions()\r\n    portrait = @thangType.getPortraitImage(options)\r\n    return unless portrait\r\n    portrait?.attr('id', 'portrait').addClass('img-thumbnail')\r\n    portrait.addClass 'img-thumbnail'\r\n    $('#portrait').replaceWith(portrait)\r\n\r\n  showLank: (lank) ->\r\n    @clearDisplayObject()\r\n    @clearLank()\r\n    @layerAdapter.resetSpriteSheet()\r\n    @layerAdapter.addLank(lank)\r\n    @currentLank = lank\r\n    @currentLankOffset = null\r\n\r\n  showSprite: (sprite) ->\r\n    @clearDisplayObject()\r\n    @clearLank()\r\n    @topLayer.addChild(sprite)\r\n    @currentObject = sprite\r\n    @updateDots()\r\n\r\n  clearDisplayObject: ->\r\n    @topLayer.removeChild(@currentObject) if @currentObject?\r\n\r\n  clearLank: ->\r\n    @layerAdapter.removeLank(@currentLank) if @currentLank\r\n    @currentLank?.destroy()\r\n\r\n  # sliders\r\n\r\n  initSliders: ->\r\n    @rotationSlider = @initSlider $('#rotation-slider', @$el), 50, @updateRotation\r\n    @scaleSlider = @initSlider $('#scale-slider', @$el), 29, @updateScale\r\n    @resolutionSlider = @initSlider $('#resolution-slider', @$el), 39, @updateResolution\r\n    @healthSlider = @initSlider $('#health-slider', @$el), 100, @updateHealth\r\n\r\n  updateRotation: =>\r\n    value = parseInt(180 * (@rotationSlider.slider('value') - 50) / 50)\r\n    @$el.find('.rotation-label').text \" #{value} \"\r\n    if @currentLank\r\n      @currentLank.rotation = value\r\n      @currentLank.update(true)\r\n\r\n  updateScale: =>\r\n    scaleValue = (@scaleSlider.slider('value') + 1) / 10\r\n    @layerAdapter.container.scaleX = @layerAdapter.container.scaleY = @topLayer.scaleX = @topLayer.scaleY = scaleValue\r\n    fixed = scaleValue.toFixed(1)\r\n    @scale = scaleValue\r\n    @$el.find('.scale-label').text \" #{fixed}x \"\r\n    @updateGrid()\r\n\r\n  updateResolution: =>\r\n    value = (@resolutionSlider.slider('value') + 1) / 10\r\n    fixed = value.toFixed(1)\r\n    @$el.find('.resolution-label').text \" #{fixed}x \"\r\n    @resolution = value\r\n    @refreshAnimation()\r\n\r\n  updateHealth: =>\r\n    value = parseInt((@healthSlider.slider('value')) / 10)\r\n    @$el.find('.health-label').text \" #{value}hp \"\r\n    @mockThang.health = value\r\n    @currentLank?.update()\r\n\r\n  # save\r\n\r\n  saveNewThangType: (e) ->\r\n    newThangType = if e.major then @thangType.cloneNewMajorVersion() else @thangType.cloneNewMinorVersion()\r\n    newThangType.set('commitMessage', e.commitMessage)\r\n    newThangType.updateI18NCoverage() if newThangType.get('i18nCoverage')\r\n\r\n    res = newThangType.save(null, {type: 'POST'})  # Override PUT so we can trigger postNewVersion logic\r\n    return unless res\r\n    modal = $('#save-version-modal')\r\n    @enableModalInProgress(modal)\r\n\r\n    res.error =>\r\n      @disableModalInProgress(modal)\r\n\r\n    res.success =>\r\n      url = \"/editor/thang/#{newThangType.get('slug') or newThangType.id}\"\r\n      portraitSource = null\r\n      if @thangType.get('raster')\r\n        #image = @currentLank.sprite.image  # Doesn't work?\r\n        image = @currentLank.sprite.spriteSheet._images[0]\r\n        portraitSource = imageToPortrait image\r\n        # bit of a hacky way to get that portrait\r\n      success = =>\r\n        @thangType.clearBackup()\r\n        document.location.href = url\r\n      newThangType.uploadGenericPortrait success, portraitSource\r\n\r\n  clearRawData: ->\r\n    @thangType.resetRawData()\r\n    @thangType.set 'actions', undefined\r\n    @clearDisplayObject()\r\n    @treema.set('/', @getThangData())\r\n\r\n  getThangData: ->\r\n    data = $.extend(true, {}, @thangType.attributes)\r\n    data = _.pick data, (value, key) => not (key in ['components'])\r\n\r\n  buildTreema: ->\r\n    data = @getThangData()\r\n    schema = _.cloneDeep ThangType.schema\r\n    schema.properties = _.pick schema.properties, (value, key) => not (key in ['components'])\r\n    options =\r\n      data: data\r\n      schema: schema\r\n      files: @files\r\n      filePath: \"db/thang.type/#{@thangType.get('original')}\"\r\n      readOnly: me.get('anonymous')\r\n      callbacks:\r\n        change: @pushChangesToPreview\r\n        select: @onSelectNode\r\n    el = @$el.find('#thang-type-treema')\r\n    @treema = @$el.find('#thang-type-treema').treema(options)\r\n    @treema.build()\r\n    @lastKind = data.kind\r\n\r\n  pushChangesToPreview: =>\r\n    return if @temporarilyIgnoringChanges\r\n    keysProcessed = {}\r\n    for key of @thangType.attributes\r\n      keysProcessed[key] = true\r\n      continue if key is 'components'\r\n      @thangType.set(key, @treema.data[key])\r\n    for key, value of @treema.data when not keysProcessed[key]\r\n      @thangType.set(key, value)\r\n\r\n    @updateSelectBox()\r\n    @refreshAnimation()\r\n    @updateDots()\r\n    @updatePortrait()\r\n    if (kind = @treema.data.kind) isnt @lastKind\r\n      @lastKind = kind\r\n      Backbone.Mediator.publish 'editor:thang-type-kind-changed', kind: kind\r\n      if kind in ['Doodad', 'Floor', 'Wall'] and not @treema.data.terrains\r\n        @treema.set '/terrains', ['Grass', 'Dungeon', 'Indoor', 'Desert', 'Mountain', 'Glacier', 'Volcano']  # So editors know to set them.\r\n      if not @treema.data.tasks\r\n        @treema.set '/tasks', (name: t for t in defaultTasks[kind])\r\n\r\n  onSelectNode: (e, selected) =>\r\n    selected = selected[0]\r\n    @topLayer.removeChild(@boundsBox) if @boundsBox\r\n    return @stopShowingSelectedNode() if not selected\r\n    path = selected.getPath()\r\n    parts = path.split('/')\r\n    return @stopShowingSelectedNode() unless parts.length >= 4 and _.string.startsWith path, '/raw/'\r\n    key = parts[3]\r\n    type = parts[2]\r\n    vectorParser = new SpriteBuilder(@thangType)\r\n    obj = vectorParser.buildMovieClip(key) if type is 'animations'\r\n    obj = vectorParser.buildContainerFromStore(key) if type is 'containers'\r\n    obj = vectorParser.buildShapeFromStore(key) if type is 'shapes'\r\n\r\n    bounds = obj?.bounds or obj?.nominalBounds\r\n    if bounds\r\n      @boundsBox = new createjs.Shape()\r\n      @boundsBox.graphics.beginFill('#aaaaaa').beginStroke('black').drawRect(bounds.x, bounds.y, bounds.width, bounds.height)\r\n      @topLayer.addChild(@boundsBox)\r\n      obj.regX = @boundsBox.regX = bounds.x + bounds.width / 2\r\n      obj.regY = @boundsBox.regY = bounds.y + bounds.height / 2\r\n\r\n    @showSprite(obj) if obj\r\n    @showingSelectedNode = true\r\n    @currentLank?.destroy()\r\n    @currentLank = null\r\n    @updateScale()\r\n    @grid.alpha = 0.0\r\n\r\n  stopShowingSelectedNode: ->\r\n    return unless @showingSelectedNode\r\n    @grid.alpha = 1.0\r\n    @showAnimation()\r\n    @showingSelectedNode = false\r\n\r\n  showVersionHistory: (e) ->\r\n    @openModalView new ThangTypeVersionsModal thangType: @thangType, @thangTypeID\r\n\r\n  onPopulateLevelI18N: ->\r\n    @thangType.populateI18N()\r\n    _.delay((-> document.location.reload()), 500)\r\n\r\n  openSaveModal: ->\r\n    modal = new SaveVersionModal model: @thangType\r\n    @openModalView modal\r\n    @listenToOnce modal, 'save-new-version', @saveNewThangType\r\n    @listenToOnce modal, 'hidden', -> @stopListening(modal)\r\n\r\n  startForking: (e) ->\r\n    @openModalView new ForkModal model: @thangType, editorPath: 'thang'\r\n\r\n  onPlayLevelSelect: (e) ->\r\n    if @childWindow and not @childWindow.closed\r\n      # We already have a child window open, so we don't need to ask for a level; we'll use its existing level.\r\n      e.stopImmediatePropagation()\r\n      @onPlayLevel e\r\n    _.defer -> $('.play-with-level-input').focus()\r\n\r\n  onPlayLevelKeyUp: (e) ->\r\n    return unless e.keyCode is 13  # return\r\n    input = @$el.find('.play-with-level-input')\r\n    input.parents('.dropdown').find('.play-with-level-parent').dropdown('toggle')\r\n    level = _.string.slugify input.val()\r\n    return unless level\r\n    @onPlayLevel null, level\r\n    recentlyPlayedLevels = storage.load('recently-played-levels') ? []\r\n    recentlyPlayedLevels.push level\r\n    storage.save 'recently-played-levels', recentlyPlayedLevels\r\n\r\n  onPlayLevel: (e, level=null) ->\r\n    level ?= $(e.target).data('level')\r\n    level = _.string.slugify level\r\n    if @childWindow and not @childWindow.closed\r\n      # Reset the LevelView's world, but leave the rest of the state alone\r\n      @childWindow.Backbone.Mediator.publish 'level:reload-thang-type', thangType: @thangType\r\n    else\r\n      # Create a new Window with a blank LevelView\r\n      scratchLevelID = level + '?dev=true'\r\n      if me.get('name') is 'Nick'\r\n        @childWindow = window.open(\"/play/level/#{scratchLevelID}\", 'child_window', 'width=2560,height=1080,left=0,top=-1600,location=1,menubar=1,scrollbars=1,status=0,titlebar=1,toolbar=1', true)\r\n      else\r\n        @childWindow = window.open(\"/play/level/#{scratchLevelID}\", 'child_window', 'width=1024,height=560,left=10,top=10,location=0,menubar=0,scrollbars=0,status=0,titlebar=0,toolbar=0', true)\r\n    @childWindow.focus()\r\n\r\n  # Canvas mouse drag handlers\r\n\r\n  onCanvasMouseMove: (e) ->\r\n    return unless p1 = @canvasDragStart\r\n    p2 = x: e.offsetX, y: e.offsetY\r\n    offset = x: p2.x - p1.x, y: p2.y - p1.y\r\n    @currentLank.sprite.x = @currentLankOffset.x + offset.x / @scale\r\n    @currentLank.sprite.y = @currentLankOffset.y + offset.y / @scale\r\n    @canvasDragOffset = offset\r\n\r\n  onCanvasMouseDown: (e) ->\r\n    return unless @currentLank\r\n    @canvasDragStart = x: e.offsetX, y: e.offsetY\r\n    @currentLankOffset ?= x: @currentLank.sprite.x, y: @currentLank.sprite.y\r\n\r\n  onCanvasMouseUp: (e) ->\r\n    @canvasDragStart = null\r\n    return unless @canvasDragOffset\r\n    return unless node = @treema.getLastSelectedTreema()\r\n    offset = node.get '/'\r\n    offset.x += Math.round @canvasDragOffset.x\r\n    offset.y += Math.round @canvasDragOffset.y\r\n    @canvasDragOffset = null\r\n    node.set '/', offset\r\n\r\n  onClickExportSpriteSheetButton: ->\r\n    modal = new ExportThangTypeModal({}, @thangType)\r\n    @openModalView(modal)\r\n\r\n  destroy: ->\r\n    @camera?.destroy()\r\n    super()\r\n\r\nimageToPortrait = (img) ->\r\n  canvas = document.createElement('canvas')\r\n  canvas.width = 100\r\n  canvas.height = 100\r\n  ctx = canvas.getContext('2d')\r\n  scaleX = 100 / img.width\r\n  scaleY = 100 / img.height\r\n  ctx.scale scaleX, scaleY\r\n  ctx.drawImage img, 0, 0\r\n  canvas.toDataURL('image/png')\r\n","SearchView = require 'views/common/SearchView'\r\n\r\nmodule.exports = class ThangTypeSearchView extends SearchView\r\n  id: 'thang-type-home-view'\r\n  modelLabel: 'Thang Type'\r\n  model: require 'models/ThangType'\r\n  modelURL: '/db/thang.type'\r\n  tableTemplate: require 'templates/editor/thang/table'\r\n  projection: ['original', 'name', 'version', 'description', 'slug', 'kind', 'rasterIcon', 'tasks']\r\n  page: 'thang'\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.currentEditor = 'editor.thang_title'\r\n    context.currentNew = 'editor.new_thang_title'\r\n    context.currentNewSignup = 'editor.new_thang_title_login'\r\n    context.currentSearch = 'editor.thang_search_title'\r\n    context.newModelsAdminOnly = true\r\n    @$el.i18n()\r\n    context\r\n\r\n  onSearchChange: =>\r\n    super()\r\n    @$el.find('img').error(-> $(this).hide())\r\n\r\n  # TODO: do the new thing on click, not just enter\r\n","VersionsModal = require 'views/editor/modal/VersionsModal'\r\n\r\nmodule.exports = class ThangTypeVersionsModal extends VersionsModal\r\n  id: 'editor-thang-versions-view'\r\n  url: '/db/thang.type/'\r\n  page: 'thang'\r\n\r\n  constructor: (options, @ID) ->\r\n    super options, @ID, require 'models/ThangType'\r\n","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/thang/vector-icon-setup-modal'\r\n\r\nmodule.exports = class VectorIconSetupModal extends ModalView\r\n  id: \"vector-icon-setup-modal\"\r\n  template: template\r\n  demoSize: 400\r\n  plain: true\r\n\r\n  events:\r\n    'change #container-select': 'onChangeContainer'\r\n    'click #center': 'onClickCenter'\r\n    'click #zero-bounds': 'onClickZeroBounds'\r\n    'click #done-button': 'onClickDone'\r\n\r\n  shortcuts:\r\n    'shift+-': -> @incrScale(-0.02)\r\n    'shift+=': -> @incrScale(0.02)\r\n    'up': -> @incrRegY(1)\r\n    'down': -> @incrRegY(-1)\r\n    'left': -> @incrRegX(1)\r\n    'right': -> @incrRegX(-1)\r\n\r\n  constructor: (options, @thangType) ->\r\n    portrait = @thangType.get('actions')?.portrait\r\n    @containers = _.keys(@thangType.get('raw')?.containers or {})\r\n    @container = portrait?.container or _.last @containers\r\n    @scale = portrait?.scale or 1\r\n    @regX = portrait?.positions?.registration?.x or 0\r\n    @regY = portrait?.positions?.registration?.y or 0\r\n    @saveChanges()\r\n    super(options)\r\n\r\n  saveChanges: ->\r\n    actions = _.cloneDeep (@thangType.get('actions') ? {})\r\n    actions.portrait ?= {}\r\n    actions.portrait.scale = @scale\r\n    actions.portrait.positions ?= {}\r\n    actions.portrait.positions.registration = { x: @regX, y: @regY }\r\n    actions.portrait.container = @container\r\n    @thangType.set('actions', actions)\r\n    @thangType.buildActions()\r\n\r\n  afterRender: ->\r\n    @initStage()\r\n    super()\r\n\r\n  initStage: ->\r\n    return unless @containers and @container\r\n    @stage = @thangType.getVectorPortraitStage(@demoSize)\r\n    @sprite = @stage.children[0]\r\n    canvas = $(@stage.canvas)\r\n    canvas.attr('id', 'resulting-icon')\r\n    @$el.find('#resulting-icon').replaceWith(canvas)\r\n    @updateSpriteProperties()\r\n\r\n  onChangeContainer: (e) ->\r\n    @container = $(e.target).val()\r\n    @saveChanges()\r\n    @initStage()\r\n\r\n  refreshSprite: ->\r\n    return unless @stage\r\n    stage = @thangType.getVectorPortraitStage(@demoSize)\r\n    @stage.removeAllChildren()\r\n    @stage.addChild(@sprite = stage.children[0])\r\n    @updateSpriteProperties()\r\n    @stage.update()\r\n\r\n  updateSpriteProperties: ->\r\n    @sprite.scaleX = @sprite.scaleY = @scale * @demoSize / 100\r\n    @sprite.regX = @regX / @scale\r\n    @sprite.regY = @regY / @scale\r\n    console.log 'set to', @scale, @regX, @regY\r\n\r\n  onClickCenter: ->\r\n    containerInfo = @thangType.get('raw').containers[@container]\r\n    b = containerInfo.b\r\n    @regX = b[0]\r\n    @regY = b[1]\r\n    maxDimension = Math.max(b[2], b[3])\r\n    @scale = 100 / maxDimension\r\n    if b[2] > b[3]\r\n      @regY += (b[3] - b[2]) / 2\r\n    else\r\n      @regX += (b[2] - b[3]) / 2\r\n    @regX *= @scale\r\n    @regY *= @scale\r\n    @updateSpriteProperties()\r\n    @stage.update()\r\n\r\n  incrScale: (amount) ->\r\n    @scale += amount\r\n    @updateSpriteProperties()\r\n    @stage.update()\r\n\r\n  incrRegX: (amount) ->\r\n    @regX += amount\r\n    @updateSpriteProperties()\r\n    @stage.update()\r\n\r\n  incrRegY: (amount) ->\r\n    @regY += amount\r\n    @updateSpriteProperties()\r\n    @stage.update()\r\n\r\n  onClickDone: ->\r\n    @saveChanges()\r\n    @trigger 'done'\r\n    @hide()","CocoClass = require 'core/CocoClass'\r\nSuperModel = require 'models/SuperModel'\r\n{createAetherOptions} = require 'lib/aether_utils'\r\nGod = require 'lib/God'\r\nGoalManager = require 'lib/world/GoalManager'\r\nLevelLoader = require 'lib/LevelLoader'\r\nutils = require 'core/utils'\r\n\r\nmodule.exports = class VerifierTest extends CocoClass\r\n  constructor: (@levelID, @updateCallback, @supermodel, @language, @options) ->\r\n    super()\r\n    # TODO: turn this into a Subview\r\n    # TODO: listen to the progress report from Angel to show a simulation progress bar (maybe even out of the number of frames we actually know it'll take)\r\n    @supermodel ?= new SuperModel()\r\n\r\n    if utils.getQueryVariable('dev') or @options.devMode\r\n      @supermodel.shouldSaveBackups = (model) ->  # Make sure to load possibly changed things from localStorage.\r\n        model.constructor.className in ['Level', 'LevelComponent', 'LevelSystem', 'ThangType']\r\n\r\n    @language ?= 'python'\r\n    @userCodeProblems = []\r\n    @load()\r\n\r\n  load: ->\r\n    @loadStartTime = new Date()\r\n    @god = new God maxAngels: 1, headless: true\r\n    @levelLoader = new LevelLoader supermodel: @supermodel, levelID: @levelID, headless: true, fakeSessionConfig: {codeLanguage: @language, callback: @configureSession}\r\n    @listenToOnce @levelLoader, 'world-necessities-loaded', -> _.defer @onWorldNecessitiesLoaded\r\n\r\n  onWorldNecessitiesLoaded: =>\r\n    # Called when we have enough to build the world, but not everything is loaded\r\n    @grabLevelLoaderData()\r\n\r\n    unless @solution\r\n      @error = 'No solution present...'\r\n      @state = 'no-solution'\r\n      @updateCallback? test: @, state: 'no-solution'\r\n      return\r\n    me.team = @team = 'humans'\r\n    @setupGod()\r\n    @initGoalManager()\r\n    @register()\r\n\r\n  configureSession: (session, level) =>\r\n    try\r\n      session.solution = _.find level.getSolutions(), language: session.get('codeLanguage')\r\n      session.set 'heroConfig', session.solution.heroConfig\r\n      session.set 'code', {'hero-placeholder': plan: session.solution.source}\r\n      state = session.get 'state'\r\n      state.flagHistory = session.solution.flagHistory\r\n      state.realTimeInputEvents = session.solution.realTimeInputEvents\r\n      state.difficulty = session.solution.difficulty or 0\r\n      session.solution.seed = undefined unless _.isNumber session.solution.seed  # TODO: migrate away from submissionCount/sessionID seed objects\r\n    catch e\r\n      @state = 'error'\r\n      @error = \"Could not load the session solution for #{level.get('name')}: \" + e.toString() + \"\\n\" + e.stack\r\n\r\n  grabLevelLoaderData: ->\r\n    @world = @levelLoader.world\r\n    @level = @levelLoader.level\r\n    @session = @levelLoader.session\r\n    @solution = @levelLoader.session.solution\r\n\r\n  setupGod: ->\r\n    @god.setLevel @level.serialize {@supermodel, @session, otherSession: null, headless: true, sessionless: false}\r\n    @god.setLevelSessionIDs [@session.id]\r\n    @god.setWorldClassMap @world.classMap\r\n    @god.lastFlagHistory = @session.get('state').flagHistory\r\n    @god.lastDifficulty = @session.get('state').difficulty\r\n    @god.lastFixedSeed = @session.solution.seed\r\n    @god.lastSubmissionCount = 0\r\n\r\n  initGoalManager: ->\r\n    @goalManager = new GoalManager(@world, @level.get('goals'), @team)\r\n    @god.setGoalManager @goalManager\r\n\r\n  register: ->\r\n    @listenToOnce @god, 'infinite-loop', @fail\r\n    @listenToOnce @god, 'user-code-problem', @onUserCodeProblem\r\n    @listenToOnce @god, 'goals-calculated', @processSingleGameResults\r\n    @god.createWorld @session.generateSpellsObject()\r\n    @state = 'running'\r\n    @reportResults()\r\n\r\n  extractTestLogs: ->\r\n    @testLogs = []\r\n    for log in @god?.angelsShare?.busyAngels?[0]?.allLogs ? []\r\n      continue if log.indexOf('[TEST]') is -1\r\n      @testLogs.push log.replace /\\|.*?\\| \\[TEST\\] /, ''\r\n    @testLogs\r\n\r\n  reportResults: ->\r\n    @updateCallback? test: @, state: @state, testLogs: @extractTestLogs()\r\n\r\n  processSingleGameResults: (e) ->\r\n    @goals = e.goalStates\r\n    @frames = e.totalFrames\r\n    @lastFrameHash = e.lastFrameHash\r\n    @simulationFrameRate = e.simulationFrameRate\r\n    @state = 'complete'\r\n    @reportResults()\r\n    @scheduleCleanup()\r\n\r\n  isSuccessful: (careAboutFrames=true) ->\r\n    return false unless @solution?\r\n    return false unless @frames == @solution.frameCount or not careAboutFrames\r\n    return false if @simulationFrameRate < 30\r\n    if @goals and @solution.goals\r\n      for k of @goals\r\n        continue if not @solution.goals[k]\r\n        return false if @solution.goals[k] != @goals[k].status\r\n    return true\r\n\r\n  onUserCodeProblem: (e) ->\r\n    console.warn \"Found user code problem:\", e\r\n    @userCodeProblems.push e.problem\r\n    @reportResults()\r\n\r\n  onNonUserCodeProblem: (e) ->\r\n    console.error \"Found non-user-code problem:\", e\r\n    @error = \"Failed due to non-user-code problem: #{JSON.stringify(e)}\"\r\n    @state = 'error'\r\n    @reportResults()\r\n    @scheduleCleanup()\r\n\r\n  fail: (e) ->\r\n    @error = 'Failed due to infinite loop.'\r\n    @state = 'error'\r\n    @reportResults()\r\n    @scheduleCleanup()\r\n\r\n  scheduleCleanup: ->\r\n    setTimeout @cleanup, 100\r\n\r\n  cleanup: =>\r\n    if @levelLoader\r\n      @stopListening @levelLoader\r\n      @levelLoader.destroy()\r\n    if @god\r\n      @stopListening @god\r\n      @god.destroy()\r\n    @world = null\r\n","utils = require 'core/utils'\r\n\r\nRootView = require 'views/core/RootView'\r\ntemplate = require 'templates/editor/verifier/verifier-view'\r\nVerifierTest = require './VerifierTest'\r\nSuperModel = require 'models/SuperModel'\r\nCampaigns = require 'collections/Campaigns'\r\nLevel = require 'models/Level'\r\n\r\nmodule.exports = class VerifierView extends RootView\r\n  className: 'style-flat'\r\n  template: template\r\n  id: 'verifier-view'\r\n\r\n  events:\r\n    'click #go-button': 'onClickGoButton'\r\n\r\n  constructor: (options, @levelID) ->\r\n    super options\r\n    # TODO: sort tests by unexpected result first\r\n    @passed = 0\r\n    @failed = 0\r\n    @problem = 0\r\n    @testCount = 0\r\n\r\n    if utils.getQueryVariable('dev')\r\n      @supermodel.shouldSaveBackups = (model) ->  # Make sure to load possibly changed things from localStorage.\r\n        model.constructor.className in ['Level', 'LevelComponent', 'LevelSystem', 'ThangType']\r\n\r\n    defaultCores = 2\r\n    @cores = Math.max(window.navigator.hardwareConcurrency, defaultCores)\r\n    @careAboutFrames = true\r\n\r\n    if @levelID\r\n      @levelIDs = [@levelID]\r\n      @testLanguages = ['python', 'javascript', 'java', 'lua', 'coffeescript']\r\n      @cores = 1\r\n      @startTestingLevels()\r\n    else\r\n      @campaigns = new Campaigns()\r\n      @supermodel.trackRequest @campaigns.fetch(data: {project: 'slug,type,levels'})\r\n      @campaigns.comparator = (m) ->\r\n        ['intro', 'course-2', 'course-3', 'course-4', 'course-5', 'course-6', 'course-8',\r\n         'dungeon', 'forest', 'desert', 'mountain', 'glacier', 'volcano'].indexOf(m.get('slug'))\r\n\r\n  onLoaded: ->\r\n    super()\r\n    return if @levelID\r\n    @filterCampaigns()\r\n    @filterCodeLanguages()\r\n    @render()\r\n\r\n  filterCampaigns: ->\r\n    @levelsByCampaign = {}\r\n    for campaign in @campaigns.models when campaign.get('type') in ['course', 'hero'] and campaign.get('slug') isnt 'picoctf'\r\n      @levelsByCampaign[campaign.get('slug')] ?= {levels: [], checked: campaign.get('slug') in ['intro']}\r\n      campaignInfo = @levelsByCampaign[campaign.get('slug')]\r\n      for levelID, level of campaign.get('levels') when level.type not in ['hero-ladder', 'course-ladder', 'game-dev', 'web-dev']  # Would use isType, but it's not a Level model\r\n        campaignInfo.levels.push level.slug\r\n\r\n  filterCodeLanguages: ->\r\n    defaultLanguages = utils.getQueryVariable('languages', 'python,javascript').split(/, ?/)\r\n    @codeLanguages ?= ({id: c, checked: c in defaultLanguages} for c in ['python', 'javascript', 'java', 'lua', 'coffeescript'])\r\n\r\n  onClickGoButton: (e) ->\r\n    @filterCampaigns()\r\n    @levelIDs = []\r\n    @careAboutFrames = @$(\"#careAboutFrames\").is(':checked')\r\n    @cores = @$(\"#cores\").val()|0\r\n    for campaign, campaignInfo of @levelsByCampaign\r\n      if @$(\"#campaign-#{campaign}-checkbox\").is(':checked')\r\n        for level in campaignInfo.levels\r\n          @levelIDs.push level unless level in @levelIDs\r\n      else\r\n        campaignInfo.checked = false\r\n    @testLanguages = []\r\n    for codeLanguage in @codeLanguages\r\n      if @$(\"#code-language-#{codeLanguage.id}-checkbox\").is(':checked')\r\n        codeLanguage.checked = true\r\n        @testLanguages.push codeLanguage.id\r\n      else\r\n        codeLanguage.checked = false\r\n    @startTestingLevels()\r\n\r\n  startTestingLevels: ->\r\n    @levelsToLoad = @initialLevelsToLoad = @levelIDs.length\r\n    for levelID in @levelIDs\r\n      level = @supermodel.getModel(Level, levelID) or new Level _id: levelID\r\n      if level.loaded\r\n        @onLevelLoaded()\r\n      else\r\n        @listenToOnce @supermodel.loadModel(level).model, 'sync', @onLevelLoaded\r\n\r\n  onLevelLoaded: (level) ->\r\n    if --@levelsToLoad is 0\r\n      @onTestLevelsLoaded()\r\n    else\r\n      @render()\r\n\r\n  onTestLevelsLoaded: ->\r\n\r\n    @linksQueryString = window.location.search\r\n    #supermodel = if @levelID then @supermodel else undefined\r\n    @tests = []\r\n    @tasksList = []\r\n    for levelID in @levelIDs\r\n      level = @supermodel.getModel(Level, levelID)\r\n      solutions = level?.getSolutions()\r\n      for codeLanguage in @testLanguages\r\n        if not solutions or _.find(solutions, language: codeLanguage)\r\n          @tasksList.push level: levelID, language: codeLanguage\r\n\r\n    @testCount = @tasksList.length\r\n    console.log(\"Starting in\", @cores, \"cores...\")\r\n    chunks = _.groupBy @tasksList, (v,i) => i%@cores\r\n    supermodels = [@supermodel]\r\n\r\n    _.forEach chunks, (chunk, i) =>\r\n      _.delay =>\r\n        parentSuperModel = supermodels[supermodels.length-1]\r\n        chunkSupermodel = new SuperModel()\r\n        chunkSupermodel.models = _.clone parentSuperModel.models\r\n        chunkSupermodel.collections = _.clone parentSuperModel.collections\r\n        supermodels.push chunkSupermodel\r\n\r\n        async.eachSeries chunk, (task, next) =>\r\n          test = new VerifierTest task.level, (e) =>\r\n            @update(e)\r\n            if e.state in ['complete', 'error', 'no-solution']\r\n              if e.state is 'complete'\r\n                if test.isSuccessful(@careAboutFrames)\r\n                  ++@passed\r\n                else\r\n                  ++@failed\r\n              else if e.state is 'no-solution'\r\n                --@testCount\r\n              else\r\n                ++@problem\r\n\r\n              next()\r\n          , chunkSupermodel, task.language, {}\r\n          @tests.unshift test\r\n          @render()\r\n        , => @render()\r\n      , if i > 0 then 5000 + i * 1000 else 0\r\n\r\n  update: (event) =>\r\n    @render()\r\n"]}